import{r as c,j as e}from"./vendor-react-CvxLrFbY.js";import{y as O}from"./index-BRUjA2Tl.js";import{u as x}from"./vendor-react-i18next-CV9wn5jO.js";import{w as y,R as C}from"./vendor-lucide-react-CYRm5Z9O.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-react-dom-ovwEKgq_.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-i18next-http-backend-BlWUewvL.js";import"./vendor-react-rnd-CJIym3is.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-core-C4pUYSBz.js";import"./vendor-dnd-kit-utilities-CZrAEsTl.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-dnd-kit-sortable-BobZZm17.js";import"./vendor-fflate-PjZAcS34.js";import"./vendor-framer-motion-FfyGqyL8.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";import"./vendor-i18next-Bvlggjj8.js";import"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";const H=()=>{const{t:m}=x(),[t,n]=c.useState([]),[d,p]=c.useState([]),[g,h]=c.useState(0),f=s=>{const r=[];Array.from(s).forEach(a=>{a.type.startsWith("image/")&&r.push(new Promise(l=>{const i=new FileReader;i.onload=o=>l(o.target?.result),i.readAsDataURL(a)}))}),Promise.all(r).then(a=>{const l=[];a.forEach((i,o)=>{l.push({id:o*2,pairId:o,content:i,isFlipped:!1,isMatched:!1}),l.push({id:o*2+1,pairId:o,content:i,isFlipped:!1,isMatched:!1})}),n(l.sort(()=>Math.random()-.5)),h(0),p([])})},u=s=>{s.target.files&&s.target.files.length>1?f(s.target.files):alert(m("widgets.memory_game.min_images_alert"))},j=s=>{if(t[s].isFlipped||d.length===2)return;const r=[...d,s];p(r);const a=[...t];a[s].isFlipped=!0,n(a)};c.useEffect(()=>{if(d.length===2){h(g+1);const[s,r]=d,a=t[s],l=t[r];if(a.pairId===l.pairId){const i=t.map(o=>o.pairId===a.pairId?{...o,isMatched:!0}:o);n(i),p([])}else setTimeout(()=>{const i=[...t];i[s].isFlipped=!1,i[r].isFlipped=!1,n(i),p([])},1e3)}},[d]);const w=t.length>0&&t.every(s=>s.isMatched);return t.length===0?e.jsxs("div",{className:"memory-placeholder",children:[e.jsx(y,{size:48}),e.jsx("p",{children:m("widgets.memory_game.upload_prompt")}),e.jsx("small",{children:m("widgets.memory_game.upload_rule")}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:u})]}):e.jsxs("div",{className:"memory-game-widget",children:[e.jsx("div",{className:"game-board",style:{gridTemplateColumns:`repeat(${Math.ceil(Math.sqrt(t.length))}, 1fr)`},children:t.map((s,r)=>e.jsx("div",{className:`card ${s.isFlipped||s.isMatched?"flipped":""}`,onClick:()=>j(r),children:e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"card-front",children:"?"}),e.jsx("div",{className:"card-back",children:e.jsx("img",{src:s.content,alt:`par ${s.pairId}`})})]})},r))}),e.jsxs("div",{className:"game-footer",children:[e.jsx("span",{children:m("widgets.memory_game.moves",{count:g})}),e.jsxs("button",{onClick:()=>n([]),children:[e.jsx(C,{size:16})," ",m("widgets.memory_game.start_over")]})]}),w&&e.jsxs("div",{className:"game-won-overlay",children:[e.jsx("h2",{children:m("widgets.memory_game.win_title")}),e.jsx("p",{children:m("widgets.memory_game.win_message",{moves:g})}),e.jsx("button",{onClick:()=>n([]),children:m("widgets.memory_game.play_again")})]})]})};export{H as MemoryGameWidget,O as widgetConfig};
