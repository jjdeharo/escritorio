import{r as d,j as e}from"./vendor-react-CvxLrFbY.js";import{u as C}from"./index-BRUjA2Tl.js";import{S as lt}from"./index-BRUjA2Tl.js";import{P as j}from"./vendor-papaparse-D7EnbpYv.js";import{u as T}from"./vendor-react-i18next-CV9wn5jO.js";import{w as E,D as S,aA as L,X as D}from"./vendor-lucide-react-CYRm5Z9O.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-react-dom-ovwEKgq_.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-i18next-http-backend-BlWUewvL.js";import"./vendor-react-rnd-CJIym3is.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-core-C4pUYSBz.js";import"./vendor-dnd-kit-utilities-CZrAEsTl.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-dnd-kit-sortable-BobZZm17.js";import"./vendor-fflate-PjZAcS34.js";import"./vendor-framer-motion-FfyGqyL8.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";import"./vendor-i18next-Bvlggjj8.js";import"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";const st=()=>{const{t:r,ready:x}=T(),[l,a]=C("work-list-tasks",[]),[m,k]=d.useState(""),[n,p]=d.useState(null),[u,w]=d.useState(""),g=d.useRef(null),b=t=>{t.key==="Enter"&&m.trim()!==""&&(a([...l,{id:Date.now(),text:m.trim(),completed:!1}]),k(""))},_=t=>{a(l.map(i=>i.id===t?{...i,completed:!i.completed}:i))},h=t=>{a(l.filter(i=>i.id!==t))},f=t=>{p(t.id),w(t.text)},v=t=>{t.key==="Enter"&&n!==null&&(u.trim()===""?h(n):a(l.map(i=>i.id===n?{...i,text:u.trim()}:i)),p(null),w(""))},y=()=>{const t=j.unparse(l.map(s=>({id:s.id,text:s.text,completed:s.completed}))),i=new Blob([t],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),c=URL.createObjectURL(i);o.setAttribute("href",c),o.setAttribute("download","lista_de_trabajo.csv"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},N=t=>{const i=t.target.files?.[0];i&&j.parse(i,{header:!0,skipEmptyLines:!0,complete:o=>{const c=o.data.map(s=>({id:Number(s.id)||Date.now()+Math.random(),text:String(s.text||""),completed:String(s.completed).toLowerCase()==="true"})).filter(s=>s.text);window.confirm(r("widgets.work_list.replace_list_confirm"))?a(c):a(s=>[...s,...c])},error:o=>{console.error("Error al parsear el CSV:",o),alert(r("widgets.work_list.csv_error"))}}),t.target&&(t.target.value="")};return console.log("WorkList translations:",{ready:x,placeholder:r("widgets.work_list.add_task_placeholder"),title:r("widgets.work_list.title")}),x?e.jsxs("div",{className:"work-list-widget",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",className:"work-list-input",placeholder:r("widgets.work_list.add_task_placeholder"),value:m,onChange:t=>k(t.target.value),onKeyPress:b}),e.jsx("button",{onClick:()=>g.current?.click(),className:"work-list-icon-button",title:r("widgets.work_list.load_csv"),children:e.jsx(E,{size:20})}),e.jsx("button",{onClick:y,className:"work-list-icon-button",title:r("widgets.work_list.download_csv"),children:e.jsx(S,{size:20})})]}),e.jsx("ul",{className:"work-list-items",children:l.map(t=>e.jsxs("li",{className:`work-list-item ${t.completed?"opacity-50":""}`,children:[e.jsx("input",{type:"checkbox",className:"work-list-checkbox",checked:t.completed,onChange:()=>_(t.id)}),n===t.id?e.jsx("input",{type:"text",value:u,onChange:i=>w(i.target.value),onKeyPress:v,onBlur:()=>p(null),className:"work-list-edit-input",autoFocus:!0}):e.jsx("span",{className:`flex-grow cursor-pointer ${t.completed?"line-through":""}`,onDoubleClick:()=>f(t),children:t.text}),e.jsx("button",{onClick:()=>f(t),className:"work-list-action",children:e.jsx(L,{size:16})}),e.jsx("button",{onClick:()=>h(t.id),className:"work-list-action delete",children:e.jsx(D,{size:16})})]},t.id))}),e.jsx("p",{className:"work-list-hint",children:r("widgets.work_list.double_click_edit")}),e.jsx("input",{type:"file",ref:g,onChange:N,accept:".csv",className:"hidden"})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:r("loading")})};export{st as WorkListWidget,lt as widgetConfig};
