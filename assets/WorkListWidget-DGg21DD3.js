import{c as C,u as T,a as E,r as d,j as t,b as S,D as L,a1 as z}from"./index-BK-Cnbmr.js";import{ab as W}from"./index-BK-Cnbmr.js";import{P as b}from"./papaparse.min-DrrIwxXW.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],P=C("square-pen",D),I=()=>{const{t:o,ready:w}=T(),[a,n]=E("work-list-tasks",[]),[u,h]=d.useState(""),[r,p]=d.useState(null),[m,x]=d.useState(""),k=d.useRef(null),j=e=>{e.key==="Enter"&&u.trim()!==""&&(n([...a,{id:Date.now(),text:u.trim(),completed:!1}]),h(""))},_=e=>{n(a.map(s=>s.id===e?{...s,completed:!s.completed}:s))},g=e=>{n(a.filter(s=>s.id!==e))},f=e=>{p(e.id),x(e.text)},v=e=>{e.key==="Enter"&&r!==null&&(m.trim()===""?g(r):n(a.map(s=>s.id===r?{...s,text:m.trim()}:s)),p(null),x(""))},y=()=>{const e=b.unparse(a.map(i=>({id:i.id,text:i.text,completed:i.completed}))),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),c=URL.createObjectURL(s);l.setAttribute("href",c),l.setAttribute("download","lista_de_trabajo.csv"),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},N=e=>{const s=e.target.files?.[0];s&&b.parse(s,{header:!0,skipEmptyLines:!0,complete:l=>{const c=l.data.map(i=>({id:Number(i.id)||Date.now()+Math.random(),text:String(i.text||""),completed:String(i.completed).toLowerCase()==="true"})).filter(i=>i.text);window.confirm(o("widgets.work_list.replace_list_confirm"))?n(c):n(i=>[...i,...c])},error:l=>{console.error("Error al parsear el CSV:",l),alert(o("widgets.work_list.csv_error"))}}),e.target&&(e.target.value="")};return console.log("WorkList translations:",{ready:w,placeholder:o("widgets.work_list.add_task_placeholder"),title:o("widgets.work_list.title")}),w?t.jsxs("div",{className:"work-list-widget",children:[t.jsxs("div",{className:"flex gap-2 mb-2",children:[t.jsx("input",{type:"text",className:"work-list-input",placeholder:o("widgets.work_list.add_task_placeholder"),value:u,onChange:e=>h(e.target.value),onKeyPress:j}),t.jsx("button",{onClick:()=>k.current?.click(),className:"work-list-icon-button",title:o("widgets.work_list.load_csv"),children:t.jsx(S,{size:20})}),t.jsx("button",{onClick:y,className:"work-list-icon-button",title:o("widgets.work_list.download_csv"),children:t.jsx(L,{size:20})})]}),t.jsx("ul",{className:"work-list-items",children:a.map(e=>t.jsxs("li",{className:`work-list-item ${e.completed?"opacity-50":""}`,children:[t.jsx("input",{type:"checkbox",className:"work-list-checkbox",checked:e.completed,onChange:()=>_(e.id)}),r===e.id?t.jsx("input",{type:"text",value:m,onChange:s=>x(s.target.value),onKeyPress:v,onBlur:()=>p(null),className:"work-list-edit-input",autoFocus:!0}):t.jsx("span",{className:`flex-grow cursor-pointer ${e.completed?"line-through":""}`,onDoubleClick:()=>f(e),children:e.text}),t.jsx("button",{onClick:()=>f(e),className:"work-list-action",children:t.jsx(P,{size:16})}),t.jsx("button",{onClick:()=>g(e.id),className:"work-list-action delete",children:t.jsx(z,{size:16})})]},e.id))}),t.jsx("p",{className:"work-list-hint",children:o("widgets.work_list.double_click_edit")}),t.jsx("input",{type:"file",ref:k,onChange:N,accept:".csv",className:"hidden"})]}):t.jsx("div",{className:"flex items-center justify-center h-full",children:o("loading")})};export{I as WorkListWidget,W as widgetConfig};
