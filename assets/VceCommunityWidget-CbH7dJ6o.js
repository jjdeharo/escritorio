import{r as n,j as t}from"./vendor-react-CvxLrFbY.js";import{P as ee}from"./vendor-papaparse-D7EnbpYv.js";import{P as Te}from"./index-BRUjA2Tl.js";import{u as te}from"./vendor-react-i18next-CV9wn5jO.js";import{e as A,u as se,ax as ie}from"./vendor-lucide-react-CYRm5Z9O.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-react-dom-ovwEKgq_.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-i18next-http-backend-BlWUewvL.js";import"./vendor-react-rnd-CJIym3is.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-core-C4pUYSBz.js";import"./vendor-dnd-kit-utilities-CZrAEsTl.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-dnd-kit-sortable-BobZZm17.js";import"./vendor-fflate-PjZAcS34.js";import"./vendor-framer-motion-FfyGqyL8.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";import"./vendor-i18next-Bvlggjj8.js";import"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";const oe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSj_hltRI4Q0QolINWJVcKxCMMjfpdiCkKzSdgp9d8RlGTdUU1UIKvaj-TBSkq0JQGneDhfUkSQuFzy/pub?output=csv",re="https://vibe-coding-educativo.github.io/",V="active-profile-name",D="active-profile-change",z="profiles-updated",ne="Escritorio Principal",ae=new Set(["google.com","www.google.com","g.co","goo.gl","goo.gle","forms.gle","docs.google.com","drive.google.com","sites.google.com","gemini.google.com","app.goo.gl","ai.studio","www.ai.studio","aistudio.google.com","eaciweb.net","www.eaciweb.net","ja.cat","www.ja.cat","edumind.es","www.edumind.es","claude.ai","www.claude.ai","withgoogle.com","googleusercontent.com","googleapis.com"]),_=()=>{const i=window.localStorage.getItem(V);if(!i)return ne;try{const c=JSON.parse(i);return typeof c=="string"&&c.trim()?c:i}catch{return i}},F=i=>{const c=window.localStorage.getItem("desktop-profiles");if(!c)return[];try{return JSON.parse(c)?.[i]?.vceFavorites??[]}catch{return[]}},Ie=()=>{const{t:i}=te(),[c,I]=n.useState([]),[E,G]=n.useState(""),[p,K]=n.useState(""),[w,q]=n.useState(""),[a,P]=n.useState(null),[B,R]=n.useState(new Set),[u,T]=n.useState(!0),[f,U]=n.useState(!1),[Q,x]=n.useState(!1),y=n.useRef(null),[m,M]=n.useState(()=>_()),[h,j]=n.useState(()=>F(_()));n.useEffect(()=>{let e=!0;return(async()=>{T(!0),U(!1);try{const s=await fetch(oe,{cache:"no-store"});if(!s.ok)throw new Error("CSV fetch failed");const l=await s.text(),r=ee.parse(l,{header:!0,skipEmptyLines:!0}),g="¿QUIERES ELIMINAR UN REGISTRO?\\nMarca la casilla y escribe más abajo la URL que tiene tu aplicación. En el resto de campos, escribe cualquier cosa y envía el formulario.\\nIMPORTANTE: Si solo quieres rectificar un registro, no marques esta casilla, haz lo que se  indica a continuación",N=d=>(d||"").split(",").map(L=>L.trim()).filter(Boolean),Z=(r.data||[]).map(d=>({title:(d["Título de la aplicación"]||"").trim(),author:(d["Tu nombre (Autor/a de la aplicación)"]||"").trim(),url:(d["Enlace (URL) a la aplicación"]||"").trim(),levels:N(d["Nivel o niveles educativos"]),areas:N(d["Área o áreas de conocimiento"]),description:(d["Descripción breve"]||"").trim(),deleteFlag:(d[g]||"").trim()})).filter(d=>d.title&&d.url&&!d.deleteFlag).map(({deleteFlag:d,...L})=>L);e&&I(Z)}catch{e&&U(!0)}finally{e&&T(!1)}})(),()=>{e=!1}},[]),n.useEffect(()=>{const e=l=>{const r=l.detail;M(r?.name||_())},o=l=>{l.key===V&&M(_())},s=()=>{j(F(m))};return window.addEventListener(D,e),window.addEventListener("storage",o),window.addEventListener(z,s),()=>{window.removeEventListener(D,e),window.removeEventListener("storage",o),window.removeEventListener(z,s)}},[m]),n.useEffect(()=>{j(F(m))},[m]);const J=n.useMemo(()=>{const e=new Set;return c.forEach(o=>o.levels.forEach(s=>e.add(s))),Array.from(e).sort((o,s)=>o.localeCompare(s))},[c]),$=n.useMemo(()=>{const e=new Set;return c.forEach(o=>o.areas.forEach(s=>e.add(s))),Array.from(e).sort((o,s)=>o.localeCompare(s))},[c]),S=n.useMemo(()=>{const e=E.trim().toLowerCase();return[...c].reverse().filter(s=>p&&!s.levels.includes(p)||w&&!s.areas.includes(w)?!1:e?s.title.toLowerCase().includes(e)||s.author.toLowerCase().includes(e)||s.description.toLowerCase().includes(e):!0)},[c,E,p,w]),H=e=>{try{const{hostname:o}=new URL(e),s=o.toLowerCase();return ae.has(s)||s.endsWith(".google.com")||s.endsWith(".googleusercontent.com")||s.endsWith(".googleapis.com")||s.endsWith(".withgoogle.com")||s.endsWith(".ai.studio")||s.endsWith(".eaciweb.net")||s.endsWith(".ja.cat")||s.endsWith(".edumind.es")||s.endsWith(".claude.ai")}catch{return!1}},v=n.useMemo(()=>new Set(h),[h]),C=n.useMemo(()=>{const e=new Map(c.map(o=>[o.url,o]));return h.map(o=>e.get(o)).filter(o=>!!o)},[c,h]),Y=n.useMemo(()=>S.filter(e=>!v.has(e.url)),[S,v]);n.useEffect(()=>{a&&!c.some(e=>e.url===a.url)&&P(null)},[a,c]),n.useEffect(()=>{x(!1)},[a?.url]);const k=e=>{j(o=>{const s=o.includes(e)?o.filter(l=>l!==e):[...o,e];return window.dispatchEvent(new CustomEvent("vce-favorites-update",{detail:{profileName:m,favorites:s}})),s})},O=(e,o)=>{j(s=>{const l=s.indexOf(e);if(l===-1)return s;const r=o==="up"?l-1:l+1;if(r<0||r>=s.length)return s;const g=[...s],[N]=g.splice(l,1);return g.splice(r,0,N),window.dispatchEvent(new CustomEvent("vce-favorites-update",{detail:{profileName:m,favorites:g}})),g})},W=e=>{R(o=>{const s=new Set(o);return s.has(e)?s.delete(e):s.add(e),s})},b=e=>{P(e),R(new Set)},X=()=>{if(x(!1),!!y.current)try{const e=y.current.contentWindow?.location.href;(!e||e==="about:blank")&&x(!0)}catch{}};return t.jsxs("div",{className:"vce-widget",children:[t.jsxs("div",{className:"vce-header",children:[t.jsxs("div",{children:[t.jsx("div",{className:"vce-title",children:i("widgets.vce.title")}),t.jsx("div",{className:"vce-subtitle",children:i("widgets.vce.subtitle")})]}),t.jsxs("div",{className:"vce-actions",children:[t.jsx("button",{type:"button",className:"vce-open",onClick:()=>window.open(re,"_blank","noopener,noreferrer"),children:i("widgets.vce.community_link")}),t.jsx("button",{type:"button",className:"vce-open",onClick:()=>{a&&window.open(a.url,"_blank","noopener,noreferrer")},disabled:!a,children:i("widgets.vce.open_new_tab")}),a&&t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:()=>k(a.url),title:v.has(a.url)?i("widgets.vce.remove_favorite"):i("widgets.vce.add_favorite"),"aria-label":v.has(a.url)?i("widgets.vce.remove_favorite"):i("widgets.vce.add_favorite"),children:t.jsx(A,{size:16,fill:v.has(a.url)?"currentColor":"none"})})]})]}),t.jsxs("div",{className:"vce-filters",children:[t.jsx("input",{type:"text",className:"vce-search",value:E,onChange:e=>G(e.target.value),placeholder:i("widgets.vce.search_placeholder")}),t.jsxs("select",{className:"vce-select",value:p,onChange:e=>K(e.target.value),children:[t.jsx("option",{value:"",children:i("widgets.vce.filter_level_all")}),J.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{className:"vce-select",value:w,onChange:e=>q(e.target.value),children:[t.jsx("option",{value:"",children:i("widgets.vce.filter_area_all")}),$.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsxs("div",{className:"vce-body",children:[t.jsxs("div",{className:"vce-list",children:[u&&t.jsx("div",{className:"vce-empty",children:i("widgets.vce.loading")}),f&&t.jsx("div",{className:"vce-empty",children:i("widgets.vce.load_error")}),!u&&!f&&S.length===0&&C.length===0&&t.jsx("div",{className:"vce-empty",children:i("widgets.vce.no_results")}),!u&&!f&&C.length>0&&t.jsx("div",{className:"vce-section",children:t.jsx("div",{className:"vce-section-title",children:i("widgets.vce.favorites_title")})}),!u&&!f&&C.map(e=>{const o=h.indexOf(e.url),s=o<=0,l=o===h.length-1;return t.jsx("div",{className:`vce-item vce-item-favorite${a?.url===e.url?" vce-item-active":""}`,onClick:()=>b(e),role:"button",tabIndex:0,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),b(e))},children:t.jsxs("div",{className:"vce-item-header",children:[t.jsx("div",{className:"vce-item-title",children:e.title}),t.jsxs("div",{className:"vce-fav-actions",children:[t.jsx("button",{type:"button",className:"vce-fav-reorder",disabled:s,onClick:r=>{r.stopPropagation(),O(e.url,"up")},title:i("widgets.vce.move_up"),"aria-label":i("widgets.vce.move_up"),children:t.jsx(se,{size:14})}),t.jsx("button",{type:"button",className:"vce-fav-reorder",disabled:l,onClick:r=>{r.stopPropagation(),O(e.url,"down")},title:i("widgets.vce.move_down"),"aria-label":i("widgets.vce.move_down"),children:t.jsx(ie,{size:14})}),t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:r=>{r.stopPropagation(),k(e.url)},title:v.has(e.url)?i("widgets.vce.remove_favorite"):i("widgets.vce.add_favorite"),"aria-label":v.has(e.url)?i("widgets.vce.remove_favorite"):i("widgets.vce.add_favorite"),children:t.jsx(A,{size:16,fill:v.has(e.url)?"currentColor":"none"})})]})]})},e.url)}),!u&&!f&&Y.map(e=>{const o=B.has(e.url),s=!!e.description,l=s&&e.description.length>100&&!o;return t.jsxs("div",{className:`vce-item${a?.url===e.url?" vce-item-active":""}`,onClick:()=>b(e),role:"button",tabIndex:0,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),b(e))},children:[t.jsxs("div",{className:"vce-item-header",children:[t.jsx("div",{className:"vce-item-title",children:e.title}),t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:r=>{r.stopPropagation(),k(e.url)},title:v.has(e.url)?i("widgets.vce.remove_favorite"):i("widgets.vce.add_favorite"),"aria-label":v.has(e.url)?i("widgets.vce.remove_favorite"):i("widgets.vce.add_favorite"),children:t.jsx(A,{size:16,fill:"none"})})]}),t.jsx("div",{className:"vce-item-author",children:e.author}),t.jsxs("div",{className:"vce-item-desc",children:[!s&&i("widgets.vce.no_description"),s&&l&&t.jsxs(t.Fragment,{children:[`${e.description.slice(0,100)} `,t.jsx("button",{type:"button",className:"vce-item-more",onClick:r=>{r.stopPropagation(),W(e.url)},children:i("widgets.vce.more")})]}),s&&!l&&t.jsxs(t.Fragment,{children:[e.description," ",e.description.length>100&&t.jsx("button",{type:"button",className:"vce-item-more",onClick:r=>{r.stopPropagation(),W(e.url)},children:i("widgets.vce.less")})]})]})]},e.url)})]}),t.jsx("div",{className:"vce-preview",children:a?Q||H(a.url)?t.jsxs("div",{className:"vce-empty",children:[t.jsx("div",{children:i("widgets.vce.iframe_blocked")}),t.jsx("button",{type:"button",className:"vce-open vce-open-inline",onClick:()=>window.open(a.url,"_blank","noopener,noreferrer"),children:i("widgets.vce.open_new_tab")})]}):t.jsx("iframe",{ref:y,title:a.title,src:a.url,className:"vce-iframe",loading:"lazy",onLoad:X,onError:()=>{x(!0)}},a.url):t.jsx("div",{className:"vce-empty",children:u?i("widgets.vce.loading"):t.jsxs("div",{className:"vce-intro",children:[t.jsx("div",{className:"vce-intro-title",children:i("widgets.vce.intro_title")}),t.jsxs("div",{className:"vce-intro-links",children:[t.jsx("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",children:i("widgets.vce.intro_group_link")}),t.jsx("a",{href:"https://vibe-coding-educativo.github.io/",target:"_blank",rel:"noopener noreferrer",children:i("widgets.vce.intro_info_link")})]}),t.jsx("div",{className:"vce-intro-title",children:i("widgets.vce.intro_how_title")}),t.jsxs("ol",{className:"vce-intro-list",children:[t.jsx("li",{children:i("widgets.vce.intro_step1")}),t.jsx("li",{children:i("widgets.vce.intro_step2")}),t.jsx("li",{children:i("widgets.vce.intro_step3")}),t.jsx("li",{children:i("widgets.vce.intro_step4")}),t.jsx("li",{children:i("widgets.vce.intro_step5")})]})]})})})]})]})};export{Ie as VceCommunityWidget,Te as widgetConfig};
