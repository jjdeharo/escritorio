import{r as h,j as o}from"./vendor-react-CvxLrFbY.js";import{u as w,E as b}from"./vendor-tiptap-react-D3a-0-ED.js";import{i as x}from"./vendor-tiptap-starter-kit-Cz4HOVMm.js";import{H as v}from"./vendor-tiptap-extension-heading-CeYeXkHY.js";import{d as j}from"./vendor-marked-IrHqQMcX.js";import{T as k}from"./vendor-turndown-BfpucfJx.js";import{u as C}from"./index-BRUjA2Tl.js";import{A as Gt}from"./index-BRUjA2Tl.js";import{u}from"./vendor-react-i18next-CV9wn5jO.js";import{ag as I,ah as L,ai as H,aj as y,ak as N,al as B,am as T,an as E,ao as R,w as U,D as S}from"./vendor-lucide-react-CYRm5Z9O.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-react-dom-ovwEKgq_.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-use-sync-external-store-C97i1TfO.js";import"./vendor-tiptap-core-CKFakkLY.js";import"./vendor-prosemirror-state-NYKsNaF9.js";import"./vendor-prosemirror-model-Cw4923ok.js";import"./vendor-orderedmap-C4TimWWB.js";import"./vendor-prosemirror-transform-cuuh7Eb1.js";import"./vendor-prosemirror-view-BAC1zYEb.js";import"./vendor-prosemirror-keymap-nVVzLNZ8.js";import"./vendor-w3c-keyname-DEtA-KhA.js";import"./vendor-prosemirror-commands-viQ1mFGl.js";import"./vendor-prosemirror-schema-list-CaxV89W7.js";import"./vendor-fast-deep-equal-BSqTf1VG.js";import"./vendor-tiptap-extension-blockquote-CWGVbdF9.js";import"./vendor-tiptap-extension-bold-T3TaQ4ox.js";import"./vendor-tiptap-extension-code-Rhc3bKmR.js";import"./vendor-tiptap-extension-code-block-Z-UswLJ6.js";import"./vendor-tiptap-extension-document-DmBpm_Dh.js";import"./vendor-tiptap-extension-hard-break-CgmATOq2.js";import"./vendor-tiptap-extension-horizontal-rule-DSYvxAi1.js";import"./vendor-tiptap-extension-italic-9rLXdwYo.js";import"./vendor-tiptap-extension-link-ChB58ZKs.js";import"./vendor-linkifyjs-DVrXeg1a.js";import"./vendor-tiptap-extension-list-DOkXVaJV.js";import"./vendor-tiptap-extension-paragraph-B6o0SWd_.js";import"./vendor-tiptap-extension-strike-B-4DIOoO.js";import"./vendor-tiptap-extension-text-BVHjtOnu.js";import"./vendor-tiptap-extension-underline-9N49xdTX.js";import"./vendor-tiptap-extensions-DIEPum1A.js";import"./vendor-prosemirror-dropcursor-C0L_H6JX.js";import"./vendor-prosemirror-gapcursor-BdM-MfDS.js";import"./vendor-prosemirror-history-DQINzrbf.js";import"./vendor-rope-sequence-Cxv9J64N.js";import"./vendor-i18next-http-backend-BlWUewvL.js";import"./vendor-react-rnd-CJIym3is.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-core-C4pUYSBz.js";import"./vendor-dnd-kit-utilities-CZrAEsTl.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-dnd-kit-sortable-BobZZm17.js";import"./vendor-fflate-PjZAcS34.js";import"./vendor-framer-motion-FfyGqyL8.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";import"./vendor-i18next-Bvlggjj8.js";import"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";const _=({editor:t,onUpload:l,onDownload:d})=>{const{t:e}=u();if(!t)return null;const c=[{Icon:I,action:()=>t.chain().focus().toggleBold().run(),name:"bold",title:e("widgets.notepad.menubar.bold")},{Icon:L,action:()=>t.chain().focus().toggleItalic().run(),name:"italic",title:e("widgets.notepad.menubar.italic")},{Icon:H,action:()=>t.chain().focus().toggleStrike().run(),name:"strike",title:e("widgets.notepad.menubar.strike")},{Icon:y,action:()=>t.chain().focus().toggleBulletList().run(),name:"bulletList",title:e("widgets.notepad.menubar.bullet_list")},{Icon:N,action:()=>t.chain().focus().toggleOrderedList().run(),name:"orderedList",title:e("widgets.notepad.menubar.ordered_list")},{Icon:B,action:()=>t.chain().focus().setParagraph().run(),name:"paragraph",title:e("widgets.notepad.menubar.paragraph")},{Icon:T,action:()=>t.chain().focus().toggleHeading({level:1}).run(),name:"heading",level:1,title:e("widgets.notepad.menubar.h1")},{Icon:E,action:()=>t.chain().focus().toggleHeading({level:2}).run(),name:"heading",level:2,title:e("widgets.notepad.menubar.h2")},{Icon:R,action:()=>t.chain().focus().toggleHeading({level:3}).run(),name:"heading",level:3,title:e("widgets.notepad.menubar.h3")}];return o.jsxs("div",{className:"menubar flex items-center gap-1 p-2 bg-gray-100 border-b border-accent",children:[c.map(({Icon:i,action:p,name:s,title:n,level:a})=>o.jsx("button",{onClick:p,className:`p-2 rounded hover:bg-gray-200 ${t.isActive(s,a?{level:a}:void 0)?"is-active":""}`,title:n,children:o.jsx(i,{size:16})},s+(a||""))),o.jsx("div",{className:"flex-grow"}),o.jsx("button",{onClick:l,className:"p-2 rounded hover:bg-gray-200",title:e("widgets.notepad.menubar.upload"),children:o.jsx(U,{size:16})}),o.jsx("button",{onClick:d,className:"p-2 rounded hover:bg-gray-200",title:e("widgets.notepad.menubar.download"),children:o.jsx(S,{size:16})})]})},Wt=()=>{const{t}=u(),[l,d]=C("notepad-content-html",t("widgets.notepad.initial_content")),e=h.useRef(null),c=new k,i=w({extensions:[x.configure({heading:!1,codeBlock:!1}),v.configure({levels:[1,2,3]})],content:l,onUpdate:({editor:n})=>{d(n.getHTML())},editorProps:{attributes:{class:"prose dark:prose-invert max-w-none"}}}),p=()=>{if(!i)return;const n=i.getHTML(),a=c.turndown(n),m=new Blob([a],{type:"text/markdown;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(m),r.download=t("widgets.notepad.default_filename"),document.body.appendChild(r),r.click(),document.body.removeChild(r)},s=n=>{const a=n.target.files?.[0];if(a&&i){const m=new FileReader;m.onload=async r=>{const g=r.target?.result,f=await j.parse(g);i.commands.setContent(f)},m.readAsText(a)}n.target&&(n.target.value="")};return o.jsxs("div",{className:"flex flex-col h-full w-full notepad-widget bg-white rounded-b-md overflow-hidden",children:[o.jsx(_,{editor:i,onUpload:()=>e.current?.click(),onDownload:p}),o.jsx(b,{editor:i,className:"flex-grow overflow-auto"}),o.jsx("input",{type:"file",ref:e,onChange:s,accept:".md,.txt",className:"hidden"})]})};export{Wt as NotepadWidget,Gt as widgetConfig};
