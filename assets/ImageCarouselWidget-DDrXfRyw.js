import{u as k,a as C,r as o,j as e,o as N,b as p}from"./index-BxcM-t4M.js";import{B as E}from"./index-BxcM-t4M.js";import{C as _,a as y}from"./chevron-right-CS9CznGA.js";const L=()=>{const{t:l}=k(),[t,f]=C("image-carousel-images",[]),[a,c]=o.useState(0),i=o.useRef(null),w=n=>{const s=n.target.files;if(console.log("Files selected:",s?.length),!s||s.length===0)return;const m=[];for(let r=0;r<s.length;r++){const g=s[r];if(console.log("Processing file:",g.name,"type:",g.type),g.type.startsWith("image/")){const j=new Promise((v,b)=>{const h=new FileReader;h.onload=x=>v(x.target?.result),h.onerror=x=>b(x),h.readAsDataURL(g)});m.push(j)}}console.log("Image promises created:",m.length),Promise.all(m).then(r=>{console.log("Images loaded successfully:",r.length),console.log("Setting images to:",r),f(r),c(0),i.current&&(i.current.value="")}).catch(r=>{console.error("Error loading images:",r)})},d=o.useCallback(()=>{if(t.length<=1)return;const s=a===0?t.length-1:a-1;c(s)},[a,t.length]),u=o.useCallback(()=>{if(t.length<=1)return;const s=a===t.length-1?0:a+1;c(s)},[a,t.length]);return o.useEffect(()=>{const n=s=>{if(t.length!==0)switch(s.key){case"ArrowLeft":s.preventDefault(),d();break;case"ArrowRight":s.preventDefault(),u();break}};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[t.length,d,u]),console.log("Current render state - images.length:",t.length,"currentIndex:",a),e.jsxs("div",{className:"image-carousel-widget",children:[t.length===0?e.jsxs("div",{className:"placeholder-view",children:[e.jsx(N,{size:64,className:"text-gray-400"}),e.jsx("p",{className:"mt-4 text-center",children:l("widgets.image_carousel.no_images")}),e.jsxs("button",{onClick:()=>i.current?.click(),className:"upload-button",children:[e.jsx(p,{size:18}),l("widgets.image_carousel.select_images")]})]}):e.jsxs("div",{className:"carousel-view",children:[e.jsxs("div",{className:"carousel-image-container",children:[e.jsx("img",{src:t[a],alt:l("widgets.image_carousel.slide_alt",{number:a+1})}),e.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(0,0,0,0.7)",color:"white",padding:"5px",borderRadius:"3px"},children:[a+1," / ",t.length,t.length===1&&e.jsx("div",{style:{fontSize:"12px",marginTop:"3px"},children:l("widgets.image_carousel.more_images_hint")})]})]}),t.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"carousel-arrow left-arrow",onClick:d,children:e.jsx(_,{size:32})}),e.jsx("button",{className:"carousel-arrow right-arrow",onClick:u,children:e.jsx(y,{size:32})})]}),t.length>1&&e.jsx("div",{className:"slide-indicators",children:t.map((n,s)=>e.jsx("div",{className:`indicator-dot ${a===s?"active":""}`,onClick:()=>c(s)},s))}),e.jsx("button",{onClick:()=>i.current?.click(),className:"change-images-button",title:l("widgets.image_carousel.select_new_images"),children:e.jsx(p,{size:16})})]}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",ref:i,onChange:w,className:"hidden"})]})};export{L as ImageCarouselWidget,E as widgetConfig};
