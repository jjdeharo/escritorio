import{r,j as e}from"./index-rAlYdcMp.js";import{G as A}from"./index-rAlYdcMp.js";import{P as v}from"./pause-0NttNBYd.js";import{P as g}from"./play-C4BezC55.js";const C=()=>{const[s,b]=r.useState(!1),[l,f]=r.useState(120),[i,d]=r.useState(4),[u,x]=r.useState(0),m=r.useRef(null),o=r.useRef(null),p=c=>{if(!m.current){const h=window.AudioContext||window.webkitAudioContext;m.current=new h}const t=m.current,n=t.createOscillator(),a=t.createGain();n.type="sine",n.frequency.setValueAtTime(c?900:600,t.currentTime),a.gain.setValueAtTime(1,t.currentTime),a.gain.exponentialRampToValueAtTime(.001,t.currentTime+.05),n.connect(a),a.connect(t.destination),n.start(t.currentTime),n.stop(t.currentTime+.05)};r.useEffect(()=>{if(s){const c=60/l*1e3,t=()=>{x(n=>{const a=(n+1)%i;return p(a===0),a})};p(u===0),o.current=window.setInterval(t,c)}else o.current&&clearInterval(o.current),x(0);return()=>{o.current&&clearInterval(o.current)}},[s,l,i]);const j=()=>{b(!s)};return e.jsxs("div",{className:"metronome-widget",children:[e.jsxs("div",{className:"bpm-display",children:[e.jsx("span",{className:"bpm-value",children:l}),e.jsx("span",{className:"bpm-label",children:"BPM"})]}),e.jsx("div",{className:"bpm-slider",children:e.jsx("input",{type:"range",min:"40",max:"240",value:l,onChange:c=>f(Number(c.target.value)),disabled:s})}),e.jsx("div",{className:"beat-indicators",children:Array.from({length:i},(c,t)=>e.jsx("div",{className:`beat-dot ${s&&u===t?"active":""} ${s&&u===t&&t===0?"first-beat":""}`},t))}),e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"measure-control",children:[e.jsx("button",{onClick:()=>d(Math.max(1,i-1)),disabled:s,children:"-"}),e.jsxs("span",{children:[i,"/4"]}),e.jsx("button",{onClick:()=>d(Math.min(12,i+1)),disabled:s,children:"+"})]}),e.jsx("button",{onClick:j,className:"play-button",children:s?e.jsx(v,{size:32}):e.jsx(g,{size:32})})]})]})};export{C as MetronomeWidget,A as widgetConfig};
