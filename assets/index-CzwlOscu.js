const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AttendanceWidget-CRy0dsb6.js","assets/vendor-react-CvxLrFbY.js","assets/vendor-clsx-DMbM62ou.js","assets/vendor-papaparse-D7EnbpYv.js","assets/vendor-react-i18next-CV9wn5jO.js","assets/vendor-html-parse-stringify-C3VvPRF8.js","assets/vendor-void-elements-SshaXqDN.js","assets/vendor-lucide-react-CYRm5Z9O.js","assets/vendor-react-dom-ovwEKgq_.js","assets/vendor-scheduler-SPyfQU6S.js","assets/vendor-i18next-http-backend-BlWUewvL.js","assets/vendor-react-rnd-CJIym3is.js","assets/vendor-react-draggable-CHzIUO8G.js","assets/vendor-prop-types-Chjiymov.js","assets/vendor-re-resizable-Bd8fNV1d.js","assets/vendor-dnd-kit-core-C4pUYSBz.js","assets/vendor-dnd-kit-utilities-CZrAEsTl.js","assets/vendor-dnd-kit-accessibility-DKV5GxcV.js","assets/vendor-dnd-kit-sortable-BobZZm17.js","assets/vendor-fflate-PjZAcS34.js","assets/vendor-framer-motion-FfyGqyL8.js","assets/vendor-motion-dom-DtvSSoo0.js","assets/vendor-motion-utils-CjIqCkNq.js","assets/vendor-i18next-Bvlggjj8.js","assets/vendor-i18next-browser-languagedetector-OJKzRF51.js","assets/AttendanceWidget-BRBVD50_.css","assets/BoardLiveWidget-FMBr-Xvf.js","assets/ExternalAppWidget-BlQWdW2R.js","assets/CalendarWidget-C3RfLc73.js","assets/ChatgptIaEduWidget-UfcQ5sIg.js","assets/LinkPortalWidget-BmeMb2jA.js","assets/LinkPortalWidget-CanpM5sk.css","assets/ClassDiaryWidget-jgDXXoDT.js","assets/DiceWidget-DbVaJhfq.js","assets/DiceWidget-DKhUyOlY.css","assets/DirectoEscalaWidget-CgOyEcgu.js","assets/getDirectoAppUrl-D2T_aUN8.js","assets/DirectoIdeasWidget-BC97wwr-.js","assets/DirectoMuroWidget-DmO4cuNh.js","assets/DirectoNubeWidget-DIa3Einl.js","assets/DirectoViewerWidget-BKygAkeX.js","assets/DirectoVotaWidget-B62ENcKS.js","assets/DrawingPadWidget-D5vvHm26.js","assets/EdiMarkWebWidget--exBTM7U.js","assets/EdiMarkWebWidget-BxtMZy4w.css","assets/EduMediaIAGWidget-m3CGizxm.js","assets/EduMediaIAGWidget-55EvG_hs.css","assets/FileOpenerWidget-Erq04Euy.js","assets/vendor-marked-IrHqQMcX.js","assets/vendor-katex-KHco_4HN.js","assets/vendor-katex-Qi1jX_nK.css","assets/FileOpenerWidget-BbKTlflL.css","assets/GlobalClocksWidget-NU3jFBeu.js","assets/GlobalClocksWidget-Ca_QpoyH.css","assets/GroupGeneratorWidget-CdRXc7qG.js","assets/GroupGeneratorWidget-kkYbKX9i.css","assets/HtmlSandboxWidget-CeJMj6Tn.js","assets/HtmlSandboxWidget-Cg7SWthN.css","assets/IframeWidget-sgfpPJ1u.js","assets/IframeWidget-DB5Y2nTd.css","assets/ImageCarouselWidget-5dZ-fU7D.js","assets/ImageCarouselWidget-NO2dK4ma.css","assets/LatexMarkdownWidget-CJHngYwA.js","assets/vendor-html-to-image-CCayPtYg.js","assets/LatexMarkdownWidget-1p3U7SuV.css","assets/LocalWebWidget-sVpXQlr5.js","assets/LocalWebWidget-DBzpeu8b.css","assets/MemoryGameWidget-MSqF-Fin.js","assets/MemoryGameWidget-jVyKEXp9.css","assets/MetronomeWidget-CUp-2B0i.js","assets/MetronomeWidget-B6d6WkN_.css","assets/NotepadWidget-DFYh4Jn2.js","assets/vendor-tiptap-react-D3a-0-ED.js","assets/vendor-use-sync-external-store-C97i1TfO.js","assets/vendor-tiptap-core-CKFakkLY.js","assets/vendor-prosemirror-state-NYKsNaF9.js","assets/vendor-prosemirror-model-Cw4923ok.js","assets/vendor-orderedmap-C4TimWWB.js","assets/vendor-prosemirror-transform-cuuh7Eb1.js","assets/vendor-prosemirror-view-BAC1zYEb.js","assets/vendor-prosemirror-keymap-nVVzLNZ8.js","assets/vendor-w3c-keyname-DEtA-KhA.js","assets/vendor-prosemirror-commands-viQ1mFGl.js","assets/vendor-prosemirror-schema-list-CaxV89W7.js","assets/vendor-fast-deep-equal-BSqTf1VG.js","assets/vendor-tiptap-starter-kit-Cz4HOVMm.js","assets/vendor-tiptap-extension-blockquote-CWGVbdF9.js","assets/vendor-tiptap-extension-bold-T3TaQ4ox.js","assets/vendor-tiptap-extension-code-Rhc3bKmR.js","assets/vendor-tiptap-extension-code-block-Z-UswLJ6.js","assets/vendor-tiptap-extension-document-DmBpm_Dh.js","assets/vendor-tiptap-extension-hard-break-CgmATOq2.js","assets/vendor-tiptap-extension-heading-CeYeXkHY.js","assets/vendor-tiptap-extension-horizontal-rule-DSYvxAi1.js","assets/vendor-tiptap-extension-italic-9rLXdwYo.js","assets/vendor-tiptap-extension-link-ChB58ZKs.js","assets/vendor-linkifyjs-DVrXeg1a.js","assets/vendor-tiptap-extension-list-DOkXVaJV.js","assets/vendor-tiptap-extension-paragraph-B6o0SWd_.js","assets/vendor-tiptap-extension-strike-B-4DIOoO.js","assets/vendor-tiptap-extension-text-BVHjtOnu.js","assets/vendor-tiptap-extension-underline-9N49xdTX.js","assets/vendor-tiptap-extensions-DIEPum1A.js","assets/vendor-prosemirror-dropcursor-C0L_H6JX.js","assets/vendor-prosemirror-gapcursor-BdM-MfDS.js","assets/vendor-prosemirror-history-DQINzrbf.js","assets/vendor-rope-sequence-Cxv9J64N.js","assets/vendor-turndown-BfpucfJx.js","assets/NotepadWidget-DO-NzTz2.css","assets/ProgramGuideWidget-CdZOeDgT.js","assets/ProgramGuideWidget-BgYH5Siw.css","assets/QPlayWidget-AfhGcs0i.js","assets/QrCodeGeneratorWidget-SEhpB8uA.js","assets/vendor-qrcode.react-CpH_E45I.js","assets/QrCodeGeneratorWidget-C9sVw1mn.css","assets/RandomSpinnerWidget-4FdAZgiE.js","assets/RandomSpinnerWidget-BAOoHIXm.css","assets/ScientificCalculatorWidget-68nkIvoH.js","assets/ScientificCalculatorWidget-BbkYalVJ.css","assets/ScoreboardWidget-B5snXLdk.js","assets/ScoreboardWidget-Cosun4xH.css","assets/SlidingPuzzleWidget-Bvge9SP_.js","assets/SlidingPuzzleWidget-Bn7_1foX.css","assets/SoundMeterWidget-CBKb1NcE.js","assets/SoundMeterWidget-CZKF7qrT.css","assets/StopwatchWidget-BJLC9AtD.js","assets/StopwatchWidget-HJzaRRM_.css","assets/TicTacToeWidget-MQlzMmGg.js","assets/TicTacToeWidget-9JQ82k6G.css","assets/TimerWidget-BtH0HfEh.js","assets/TrafficLightWidget-S-hPUgDm.js","assets/TrafficLightWidget-BUEVZBE_.css","assets/UnitConverterWidget-CP4QflqI.js","assets/UnitConverterWidget-Cyc2wYQh.css","assets/VceCommunityWidget-BsqaXmdx.js","assets/VceCommunityWidget-Ct8Sp28Q.css","assets/WikipediaSearchWidget-B3h--r1i.js","assets/WikipediaSearchWidget-CcDY2TYh.css","assets/WorkGesturesWidget-CyMfCTBk.js","assets/WorkGesturesWidget-5Yav63Mk.css","assets/WorkListWidget-1r9Ffj6m.js"])))=>i.map(i=>d[i]);
import{j as e,r,R as ft}from"./vendor-react-CvxLrFbY.js";import{b as js}from"./vendor-react-dom-ovwEKgq_.js";import{_ as F,B as vs}from"./vendor-i18next-http-backend-BlWUewvL.js";import{u as L,T as ks,i as Cs}from"./vendor-react-i18next-CV9wn5jO.js";import{B as Yt,P as bt,a as pt,M as Ns,b as Ss,c as Is,X as $e,L as Xt,A as zs,d as Es,C as Ws,F as Ms,T as Os,S as Ds,E as gt,e as Mt,f as xt,g as Ts,h as Ls,i as Fs,G as Ps,H as $s,j as As,k as Rs,U as ct,l as Bs,m as Vs,n as Hs,o as Ks,p as qs,q as Gs,I as Qt,r as Us,s as Ys,t as Xs,D as Ot,u as Qs,v as Js,w as Zs,x as nt,y as Dt,z as en}from"./vendor-lucide-react-CYRm5Z9O.js";import{R as tn}from"./vendor-react-rnd-CJIym3is.js";import{f as Jt,h as rt,D as Zt,i as es,j as ts,P as ss}from"./vendor-dnd-kit-core-C4pUYSBz.js";import{S as ns,h as sn,a as is,s as os,u as rs,v as nn}from"./vendor-dnd-kit-sortable-BobZZm17.js";import{C as as}from"./vendor-dnd-kit-utilities-CZrAEsTl.js";import{s as Tt,Z as on,u as rn,a as Lt,b as an}from"./vendor-fflate-PjZAcS34.js";import{A as ln,m as Ft}from"./vendor-framer-motion-FfyGqyL8.js";import{i as it}from"./vendor-i18next-Bvlggjj8.js";import{B as cn}from"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))c(p);new MutationObserver(p=>{for(const x of p)if(x.type==="childList")for(const l of x.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function i(p){const x={};return p.integrity&&(x.integrity=p.integrity),p.referrerPolicy&&(x.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?x.credentials="include":p.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function c(p){if(p.ep)return;p.ep=!0;const x=i(p);fetch(p.href,x)}})();const Pt="/escritorio/",$=t=>{if(!t)return Pt;const s=t.startsWith("/")?t.slice(1):t;return`${Pt}${s}`},dn={id:"attendance",title:"widgets.attendance.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Attendance.png"),alt:s("widgets.attendance.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:450,height:600}},gn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:dn},Symbol.toStringTag,{value:"Module"})),un={id:"boardlive",title:"widgets.boardlive.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/BoardLive.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},mn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:un},Symbol.toStringTag,{value:"Module"})),hn={id:"calendar",title:"widgets.calendar.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Calendar.png"),alt:s("widgets.calendar.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:320,height:350}},fn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:hn},Symbol.toStringTag,{value:"Module"})),bn={id:"comunidad-chatgpt-ia-edu",title:"widgets.chatgpt_ia_edu.title",searchKeywords:["widgets.chatgpt_ia_edu.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/ComunidadChatGPT-IA-edu.png"),alt:s("widgets.chatgpt_ia_edu.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:620}},pn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:bn},Symbol.toStringTag,{value:"Module"})),xn={id:"class-diary",title:"widgets.class_diary.title",searchKeywords:["widgets.class_diary.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/ClassDiary.png"),alt:s("widgets.class_diary.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:620}},wn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:xn},Symbol.toStringTag,{value:"Module"})),_n={id:"dice",title:"widgets.dice.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Dice.png"),alt:s("widgets.dice.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:400,height:300}},yn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:_n},Symbol.toStringTag,{value:"Module"})),jn={id:"directo-escala",title:"widgets.directo_escala.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoEscala.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},vn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:jn},Symbol.toStringTag,{value:"Module"})),kn={id:"directo-ideas",title:"widgets.directo_ideas.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoIdeas.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Cn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:kn},Symbol.toStringTag,{value:"Module"})),Nn={id:"directo-muro",title:"widgets.directo_muro.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoMuro.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Sn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Nn},Symbol.toStringTag,{value:"Module"})),In={id:"directo-nube",title:"widgets.directo_nube.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoNube.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},zn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:In},Symbol.toStringTag,{value:"Module"})),En=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Directo.png"),alt:t("widgets.directo_viewer.title"),width:52,height:52})},Wn={id:"directo-viewer",title:"widgets.directo_viewer.title",icon:e.jsx(En,{}),defaultSize:{width:800,height:600}},Mn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Wn},Symbol.toStringTag,{value:"Module"})),On={id:"directo-vota",title:"widgets.directo_vota.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoVota.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Dn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:On},Symbol.toStringTag,{value:"Module"})),Tn={id:"drawing-pad",title:"widgets.drawing_pad.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/paleta.png"),alt:s("widgets.drawing_pad.title"),className:"w-8 h-8"})};return e.jsx(t,{})})(),defaultSize:{width:600,height:450}},Ln=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Tn},Symbol.toStringTag,{value:"Module"})),Fn=()=>{const{t}=L();return e.jsx("img",{src:$("icons/EdiMarkWeb.png"),alt:t("widgets.edimarkweb.title"),width:52,height:52})},Pn={id:"edimarkweb",title:"widgets.edimarkweb.title",startTooltip:"widgets.edimarkweb.tooltip",icon:e.jsx(Fn,{}),defaultSize:{width:1100,height:720}},$n=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Pn},Symbol.toStringTag,{value:"Module"})),An={id:"edumedia-iag",title:"widgets.edumedia_iag.title",searchKeywords:["widgets.edumedia_iag.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/EduMedia-IAG.png"),alt:s("widgets.edumedia_iag.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:940,height:640}},Rn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:An},Symbol.toStringTag,{value:"Module"})),Bn={id:"file-opener",title:"widgets.file_opener.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/FileExplorer.png"),alt:s("widgets.file_opener.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:720,height:520}},Vn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Bn},Symbol.toStringTag,{value:"Module"})),Hn={id:"global-clocks",title:"widgets.global_clocks.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/GlobalClocks.png"),alt:s("widgets.global_clocks.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:350,height:400}},Kn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Hn},Symbol.toStringTag,{value:"Module"})),qn={id:"group-generator",title:"widgets.group_generator.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/GroupGenerator.png"),alt:s("widgets.group_generator.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:700,height:550}},Gn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:qn},Symbol.toStringTag,{value:"Module"})),Un=()=>{const{t}=L();return e.jsx("img",{src:$("icons/HtmlSandbox.png"),alt:t("widgets.html_sandbox.title"),width:52,height:52})},Yn={id:"html-sandbox",title:"widgets.html_sandbox.title",icon:e.jsx(Un,{}),defaultSize:{width:600,height:450}},Xn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Yn},Symbol.toStringTag,{value:"Module"})),Qn=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Iframe.png"),alt:t("widgets.iframe.title"),width:52,height:52})},Jn={id:"iframe",title:"widgets.iframe.title",icon:e.jsx(Qn,{}),defaultSize:{width:600,height:500}},Zn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Jn},Symbol.toStringTag,{value:"Module"})),ei=()=>{const{t}=L();return e.jsx("img",{src:$("icons/ImageCarousel.png"),alt:t("widgets.image_carousel.title"),width:52,height:52})},ti={id:"image-carousel",title:"widgets.image_carousel.title",icon:e.jsx(ei,{}),defaultSize:{width:500,height:400}},si=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ti},Symbol.toStringTag,{value:"Module"})),ni={id:"latex-markdown",title:"widgets.latex_markdown.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/LatexMarkdown.png"),alt:s("widgets.latex_markdown.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:550}},ii=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ni},Symbol.toStringTag,{value:"Module"})),oi={id:"local-web",title:"widgets.local_web.title",searchKeywords:["widgets.local_web.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/LocalWeb.png"),alt:s("widgets.local_web.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},ri=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:oi},Symbol.toStringTag,{value:"Module"})),ai=()=>{const{t}=L();return e.jsx("img",{src:$("icons/MemoryGame.png"),alt:t("widgets.memory_game.icon_alt"),width:"52",height:"52"})},li={id:"memory-game",title:"widgets.memory_game.title",icon:e.jsx(ai,{}),defaultSize:{width:500,height:550}},ci=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:li},Symbol.toStringTag,{value:"Module"})),di={id:"metronome",title:"widgets.metronome.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Metronome.png"),alt:s("widgets.metronome.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:400}},gi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:di},Symbol.toStringTag,{value:"Module"})),ui=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Notepad.png"),alt:t("widgets.notepad.icon_alt"),width:"52",height:"52"})},mi={id:"notepad",title:"widgets.notepad.title",icon:e.jsx(ui,{}),defaultSize:{width:500,height:450}},hi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:mi},Symbol.toStringTag,{value:"Module"})),fi={id:"program-guide",title:"widgets.program_guide.title",icon:e.jsx(Yt,{size:44}),defaultSize:{width:800,height:600}},bi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:fi},Symbol.toStringTag,{value:"Module"})),pi={id:"qplay",title:"widgets.qplay.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/QPlay.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},xi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:pi},Symbol.toStringTag,{value:"Module"})),wi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/QrCodeGenerator.png"),alt:t("widgets.qr_code_generator.icon_alt"),width:"52",height:"52"})},_i={id:"qr-code-generator",title:"widgets.qr_code_generator.title",icon:e.jsx(wi,{}),defaultSize:{width:350,height:500}},yi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:_i},Symbol.toStringTag,{value:"Module"})),ji=()=>{const{t}=L();return e.jsx("img",{src:$("icons/RandomSpinner.png"),alt:t("widgets.random_spinner.icon_alt"),width:"52",height:"52"})},vi={id:"random-spinner",title:"widgets.random_spinner.title",icon:e.jsx(ji,{}),defaultSize:{width:720,height:420}},ki=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:vi},Symbol.toStringTag,{value:"Module"})),Ci={id:"scientific-calculator",title:"widgets.scientific_calculator.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/ScientificCalculator.png"),alt:s("widgets.scientific_calculator.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:400,height:600}},Ni=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ci},Symbol.toStringTag,{value:"Module"})),Si=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Scoreboard.png"),alt:t("widgets.scoreboard.icon_alt"),width:"52",height:"52"})},Ii={id:"scoreboard",title:"widgets.scoreboard.title",icon:e.jsx(Si,{}),defaultSize:{width:400,height:450}},zi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ii},Symbol.toStringTag,{value:"Module"})),Ei=()=>{const{t}=L();return e.jsx("img",{src:$("icons/SlidePuzzle.png"),alt:t("widgets.sliding_puzzle.icon_alt"),width:"52",height:"52"})},Wi={id:"sliding-puzzle",title:"widgets.sliding_puzzle.title",icon:e.jsx(Ei,{}),defaultSize:{width:450,height:550}},Mi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Wi},Symbol.toStringTag,{value:"Module"})),Oi={id:"sound-meter",title:"widgets.sound_meter.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/SoundMeter.png"),alt:s("widgets.sound_meter.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:300}},Di=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Oi},Symbol.toStringTag,{value:"Module"})),Ti=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Stopwatch.png"),alt:t("widgets.stopwatch.title"),width:52,height:52})},Li={id:"stopwatch",title:"widgets.stopwatch.title",icon:e.jsx(Ti,{}),defaultSize:{width:320,height:450}},Fi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Li},Symbol.toStringTag,{value:"Module"})),Pi={id:"tic-tac-toe",title:"widgets.tic_tac_toe.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/TicTacToe.png"),alt:s("widgets.tic_tac_toe.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:380,height:520}},$i=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Pi},Symbol.toStringTag,{value:"Module"})),Ai={id:"timer",title:"widgets.timer.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Timer.png"),alt:s("widgets.timer.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:300}},Ri=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ai},Symbol.toStringTag,{value:"Module"})),Bi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/TrafficLight.png"),alt:t("widgets.traffic_light.icon_alt"),width:"52",height:"52"})},Vi={id:"traffic-light",title:"widgets.traffic_light.title",icon:e.jsx(Bi,{}),defaultSize:{width:150,height:350}},Hi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Vi},Symbol.toStringTag,{value:"Module"})),Ki=()=>{const{t}=L();return e.jsx("img",{src:$("icons/UnitConverter.png"),alt:t("widgets.unit_converter.icon_alt"),width:"52",height:"52"})},qi={id:"unit-converter",title:"widgets.unit_converter.title",icon:e.jsx(Ki,{}),defaultSize:{width:450,height:200}},Gi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:qi},Symbol.toStringTag,{value:"Module"})),Ui={id:"vce-community",title:"widgets.vce.title",startTooltip:"widgets.vce.start_tooltip",searchKeywords:["widgets.vce.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/vibe_coding_educativo.png"),alt:s("widgets.vce.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:980,height:620}},Yi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ui},Symbol.toStringTag,{value:"Module"})),Xi={id:"wikipedia-search",title:"widgets.wikipedia.title",searchKeywords:["widgets.wikipedia.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Wikipedia.png"),alt:s("widgets.wikipedia.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:960,height:640}},Qi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Xi},Symbol.toStringTag,{value:"Module"})),Ji=()=>{const{t}=L();return e.jsx("img",{src:$("icons/WorkGestures.png"),alt:t("widgets.work_gestures.icon_alt"),width:"52",height:"52"})},Zi={id:"work-gestures",title:"widgets.work_gestures.title",icon:e.jsx(Ji,{}),defaultSize:{width:450,height:450}},eo=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Zi},Symbol.toStringTag,{value:"Module"})),to={id:"work-list",title:"widgets.work_list.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/WorkList.png"),alt:s("widgets.work_list.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:380,height:400}},so=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:to},Symbol.toStringTag,{value:"Module"})),$t=Object.assign({"./Attendance/widgetConfig.tsx":gn,"./BoardLive/widgetConfig.tsx":mn,"./Calendar/widgetConfig.tsx":fn,"./ChatgptIaEdu/widgetConfig.tsx":pn,"./ClassDiary/widgetConfig.tsx":wn,"./Dice/widgetConfig.tsx":yn,"./DirectoEscala/widgetConfig.tsx":vn,"./DirectoIdeas/widgetConfig.tsx":Cn,"./DirectoMuro/widgetConfig.tsx":Sn,"./DirectoNube/widgetConfig.tsx":zn,"./DirectoViewer/widgetConfig.tsx":Mn,"./DirectoVota/widgetConfig.tsx":Dn,"./DrawingPad/widgetConfig.tsx":Ln,"./EdiMarkWeb/widgetConfig.tsx":$n,"./EduMediaIAG/widgetConfig.tsx":Rn,"./FileOpener/widgetConfig.tsx":Vn,"./GlobalClocks/widgetConfig.tsx":Kn,"./GroupGenerator/widgetConfig.tsx":Gn,"./HtmlSandbox/widgetConfig.tsx":Xn,"./Iframe/widgetConfig.tsx":Zn,"./ImageCarousel/widgetConfig.tsx":si,"./LatexMarkdown/widgetConfig.tsx":ii,"./LocalWeb/widgetConfig.tsx":ri,"./MemoryGame/widgetConfig.tsx":ci,"./Metronome/widgetConfig.tsx":gi,"./Notepad/widgetConfig.tsx":hi,"./ProgramGuide/widgetConfig.tsx":bi,"./QPlay/widgetConfig.tsx":xi,"./QrCodeGenerator/widgetConfig.tsx":yi,"./RandomSpinner/widgetConfig.tsx":ki,"./ScientificCalculator/widgetConfig.tsx":Ni,"./Scoreboard/widgetConfig.tsx":zi,"./SlidingPuzzle/widgetConfig.tsx":Mi,"./SoundMeter/widgetConfig.tsx":Di,"./Stopwatch/widgetConfig.tsx":Fi,"./TicTacToe/widgetConfig.tsx":$i,"./Timer/widgetConfig.tsx":Ri,"./TrafficLight/widgetConfig.tsx":Hi,"./UnitConverter/widgetConfig.tsx":Gi,"./VceCommunity/widgetConfig.tsx":Yi,"./WikipediaSearch/widgetConfig.tsx":Qi,"./WorkGestures/widgetConfig.tsx":eo,"./WorkList/widgetConfig.tsx":so}),At=Object.assign({"./Attendance/AttendanceWidget.tsx":()=>F(()=>import("./AttendanceWidget-CRy0dsb6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25])),"./BoardLive/BoardLiveWidget.tsx":()=>F(()=>import("./BoardLiveWidget-FMBr-Xvf.js"),__vite__mapDeps([26,1,2,27,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./Calendar/CalendarWidget.tsx":()=>F(()=>import("./CalendarWidget-C3RfLc73.js"),__vite__mapDeps([28,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./ChatgptIaEdu/ChatgptIaEduWidget.tsx":()=>F(()=>import("./ChatgptIaEduWidget-UfcQ5sIg.js"),__vite__mapDeps([29,1,2,30,4,5,6,7,31,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./ClassDiary/ClassDiaryWidget.tsx":()=>F(()=>import("./ClassDiaryWidget-jgDXXoDT.js"),__vite__mapDeps([32,1,2,30,4,5,6,7,31,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./Dice/DiceWidget.tsx":()=>F(()=>import("./DiceWidget-DbVaJhfq.js"),__vite__mapDeps([33,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,34])),"./DirectoEscala/DirectoEscalaWidget.tsx":()=>F(()=>import("./DirectoEscalaWidget-CgOyEcgu.js"),__vite__mapDeps([35,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoIdeas/DirectoIdeasWidget.tsx":()=>F(()=>import("./DirectoIdeasWidget-BC97wwr-.js"),__vite__mapDeps([37,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoMuro/DirectoMuroWidget.tsx":()=>F(()=>import("./DirectoMuroWidget-DmO4cuNh.js"),__vite__mapDeps([38,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoNube/DirectoNubeWidget.tsx":()=>F(()=>import("./DirectoNubeWidget-DIa3Einl.js"),__vite__mapDeps([39,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoViewer/DirectoViewerWidget.tsx":()=>F(()=>import("./DirectoViewerWidget-BKygAkeX.js"),__vite__mapDeps([40,1,2,36,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoVota/DirectoVotaWidget.tsx":()=>F(()=>import("./DirectoVotaWidget-B62ENcKS.js"),__vite__mapDeps([41,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DrawingPad/DrawingPadWidget.tsx":()=>F(()=>import("./DrawingPadWidget-D5vvHm26.js"),__vite__mapDeps([42,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./EdiMarkWeb/EdiMarkWebWidget.tsx":()=>F(()=>import("./EdiMarkWebWidget--exBTM7U.js"),__vite__mapDeps([43,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,44])),"./EduMediaIAG/EduMediaIAGWidget.tsx":()=>F(()=>import("./EduMediaIAGWidget-m3CGizxm.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,46])),"./FileOpener/FileOpenerWidget.tsx":()=>F(()=>import("./FileOpenerWidget-Erq04Euy.js"),__vite__mapDeps([47,1,2,48,49,50,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,51])),"./GlobalClocks/GlobalClocksWidget.tsx":()=>F(()=>import("./GlobalClocksWidget-NU3jFBeu.js"),__vite__mapDeps([52,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,53])),"./GroupGenerator/GroupGeneratorWidget.tsx":()=>F(()=>import("./GroupGeneratorWidget-CdRXc7qG.js"),__vite__mapDeps([54,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,55])),"./HtmlSandbox/HtmlSandboxWidget.tsx":()=>F(()=>import("./HtmlSandboxWidget-CeJMj6Tn.js"),__vite__mapDeps([56,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,57])),"./Iframe/IframeWidget.tsx":()=>F(()=>import("./IframeWidget-sgfpPJ1u.js"),__vite__mapDeps([58,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,59])),"./ImageCarousel/ImageCarouselWidget.tsx":()=>F(()=>import("./ImageCarouselWidget-5dZ-fU7D.js"),__vite__mapDeps([60,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,61])),"./LatexMarkdown/LatexMarkdownWidget.tsx":()=>F(()=>import("./LatexMarkdownWidget-CJHngYwA.js"),__vite__mapDeps([62,1,2,48,49,50,63,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,64])),"./LocalWeb/LocalWebWidget.tsx":()=>F(()=>import("./LocalWebWidget-sVpXQlr5.js"),__vite__mapDeps([65,1,2,19,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21,22,23,24,66])),"./MemoryGame/MemoryGameWidget.tsx":()=>F(()=>import("./MemoryGameWidget-MSqF-Fin.js"),__vite__mapDeps([67,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,68])),"./Metronome/MetronomeWidget.tsx":()=>F(()=>import("./MetronomeWidget-CUp-2B0i.js"),__vite__mapDeps([69,1,2,7,8,9,10,4,5,6,11,12,13,14,15,16,17,18,19,20,21,22,23,24,70])),"./Notepad/NotepadWidget.tsx":()=>F(()=>import("./NotepadWidget-DFYh4Jn2.js"),__vite__mapDeps([71,1,2,72,8,9,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,48,107,4,5,6,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,108])),"./ProgramGuide/ProgramGuideWidget.tsx":()=>F(()=>import("./ProgramGuideWidget-CdZOeDgT.js"),__vite__mapDeps([109,1,2,48,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24,110])),"./QPlay/QPlayWidget.tsx":()=>F(()=>import("./QPlayWidget-AfhGcs0i.js"),__vite__mapDeps([111,1,2,27,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./QrCodeGenerator/QrCodeGeneratorWidget.tsx":()=>F(()=>import("./QrCodeGeneratorWidget-SEhpB8uA.js"),__vite__mapDeps([112,1,2,113,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,114])),"./RandomSpinner/RandomSpinnerWidget.tsx":()=>F(()=>import("./RandomSpinnerWidget-4FdAZgiE.js"),__vite__mapDeps([115,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,116])),"./ScientificCalculator/ScientificCalculatorWidget.tsx":()=>F(()=>import("./ScientificCalculatorWidget-68nkIvoH.js"),__vite__mapDeps([117,1,2,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24,118])),"./Scoreboard/ScoreboardWidget.tsx":()=>F(()=>import("./ScoreboardWidget-B5snXLdk.js"),__vite__mapDeps([119,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,120])),"./SlidingPuzzle/SlidingPuzzleWidget.tsx":()=>F(()=>import("./SlidingPuzzleWidget-Bvge9SP_.js"),__vite__mapDeps([121,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,122])),"./SoundMeter/SoundMeterWidget.tsx":()=>F(()=>import("./SoundMeterWidget-CBKb1NcE.js"),__vite__mapDeps([123,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,124])),"./Stopwatch/StopwatchWidget.tsx":()=>F(()=>import("./StopwatchWidget-BJLC9AtD.js"),__vite__mapDeps([125,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,126])),"./TicTacToe/TicTacToeWidget.tsx":()=>F(()=>import("./TicTacToeWidget-MQlzMmGg.js"),__vite__mapDeps([127,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,128])),"./Timer/TimerWidget.tsx":()=>F(()=>import("./TimerWidget-BtH0HfEh.js"),__vite__mapDeps([129,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./TrafficLight/TrafficLightWidget.tsx":()=>F(()=>import("./TrafficLightWidget-S-hPUgDm.js"),__vite__mapDeps([130,1,2,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24,131])),"./UnitConverter/UnitConverterWidget.tsx":()=>F(()=>import("./UnitConverterWidget-CP4QflqI.js"),__vite__mapDeps([132,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,133])),"./VceCommunity/VceCommunityWidget.tsx":()=>F(()=>import("./VceCommunityWidget-BsqaXmdx.js"),__vite__mapDeps([134,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,135])),"./WikipediaSearch/WikipediaSearchWidget.tsx":()=>F(()=>import("./WikipediaSearchWidget-B3h--r1i.js"),__vite__mapDeps([136,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,137])),"./WorkGestures/WorkGesturesWidget.tsx":()=>F(()=>import("./WorkGesturesWidget-CyMfCTBk.js"),__vite__mapDeps([138,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,139])),"./WorkList/WorkListWidget.tsx":()=>F(()=>import("./WorkListWidget-1r9Ffj6m.js"),__vite__mapDeps([140,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./shared/ExternalAppWidget.tsx":()=>F(()=>import("./ExternalAppWidget-BlQWdW2R.js"),__vite__mapDeps([27,1,2,4,5,6])),"./shared/LinkPortalWidget.tsx":()=>F(()=>import("./LinkPortalWidget-BmeMb2jA.js"),__vite__mapDeps([30,1,2,4,5,6,7,31]))}),ls={};for(const t in $t){const s=$t[t];if(!s||!s.widgetConfig){console.warn(`[Widget Registry] El módulo en "${t}" no parece ser un widget válido porque le falta la exportación 'widgetConfig'.`);continue}const i=s.widgetConfig,c=t.slice(0,t.lastIndexOf("/")),p=Object.keys(At).find(u=>u.startsWith(`${c}/`)&&u.endsWith("Widget.tsx"));if(!p){console.warn(`[Widget Registry] No se encontró un componente para la carpeta "${c}".`);continue}const x=At[p],l=r.lazy(async()=>{const u=await x(),g=Object.keys(u).find(w=>w.endsWith("Widget")),E=g?u[g]:u.default;if(!E)throw new Error(`[Widget Registry] El módulo "${p}" no exporta un componente válido.`);return{default:E}});ls[i.id]={...i,component:l}}const Se=ls;function et(t,s){const[i,c]=r.useState(()=>{try{const x=window.localStorage.getItem(t);return x?JSON.parse(x):s}catch(x){return console.error(x),s}});return[i,x=>{try{const l=x instanceof Function?x(i):x;c(l),window.localStorage.setItem(t,JSON.stringify(l))}catch(l){console.error(l)}}]}const no=({title:t,icon:s,children:i,position:c,size:p,zIndex:x,onDragStop:l,onResizeStop:u,onClose:g,onFocus:E,isMinimized:w,isMaximized:m,onToggleMinimize:o,onToggleMaximize:I,onOpenContextMenu:a,isPinned:S,onTogglePin:A,pinLabel:O,unpinLabel:q,isActive:Q})=>{const[ge,J]=ft.useState(!1),ue=w?{...p,height:40}:p,Z={zIndex:x,opacity:w?0:!w&&!Q?.97:1,pointerEvents:w?"none":"auto",transform:w?"scale(0.98)":"scale(1)",transition:w?"width 220ms ease, height 220ms ease, opacity 220ms ease, transform 220ms ease":"opacity 120ms ease"},M=typeof s=="string"?e.jsx("img",{src:s,alt:"","aria-hidden":"true"}):s;return e.jsxs(tn,{size:ue,position:c,onDragStop:l,onResizeStop:u,minWidth:200,minHeight:w?40:150,disableDragging:m,enableResizing:!m&&!w,style:Z,onMouseDown:E,onMouseDownCapture:E,onDragStart:()=>E(),className:`widget-window bg-widget-bg rounded-lg border-2 border-widget-header relative ${Q?"ring-2 ring-accent/70 shadow-2xl":"shadow-xl"}`,dragHandleClassName:"widget-header-drag-handle",bounds:"parent",children:[e.jsxs("div",{className:"widget-header flex items-center justify-between h-10 bg-widget-header text-text-light font-bold px-3 absolute top-0 left-0 right-0",onContextMenu:a,onDoubleClick:ie=>{ie.stopPropagation(),I()},onMouseEnter:()=>J(!0),onMouseLeave:()=>J(!1),children:[e.jsxs("span",{className:"widget-header-drag-handle flex-grow h-full cursor-move flex items-center gap-2",children:[M&&e.jsx("span",{className:"widget-header-icon",children:M}),e.jsx("span",{children:t})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[A&&ge&&e.jsx("button",{onClick:A,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",title:S?q:O,"aria-label":S?q:O,children:S?e.jsx(bt,{size:18}):e.jsx(pt,{size:18})}),e.jsx("button",{onClick:o,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:e.jsx(Ns,{size:18})}),e.jsx("button",{onClick:I,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:m?e.jsx(Ss,{size:18}):e.jsx(Is,{size:18})}),e.jsx("button",{onClick:g,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:e.jsx($e,{size:18})})]})]}),!w&&e.jsx("div",{className:"absolute top-10 left-0 right-0 bottom-0 min-h-0 overflow-auto",children:i})]})},io=({pinnedWidgets:t,onWidgetClick:s,onWidgetsClick:i,onOpenContextMenu:c,onReorderPinned:p,openWidgets:x,onTaskClick:l,onTaskContextMenu:u,isHidden:g=!1,isPeeking:E=!1,onMouseLeave:w,startButtonRef:m})=>{const{t:o}=L(),I=r.useRef(null),[a,S]=r.useState(null),[A,O]=r.useState(null),q=_=>_?.startTooltip?o(_.startTooltip):o(_.title),Q=x.reduce((_,C)=>Math.max(_,C.zIndex),0),ge=Jt(rt(ss,{activationConstraint:{distance:8}}),rt(ts,{coordinateGetter:os})),J=t.filter(_=>Se[_]),ue=x.map(_=>{const C=Se[_.widgetId];if(!C)return null;const W=q(C);return{..._,title:o(C.title),icon:C.icon,label:W}}).filter(_=>!!_).sort((_,C)=>_.title.localeCompare(C.title)),Z=_=>{const{active:C,over:W}=_;if(!W||C.id===W.id)return;const V=J.indexOf(String(C.id)),X=J.indexOf(String(W.id));if(V===-1||X===-1)return;const oe=is(J,V,X),ee=t.filter(te=>!Se[te]);p([...oe,...ee])},M=({widgetId:_})=>{const C=Se[_],{attributes:W,listeners:V,setNodeRef:X,transform:oe,transition:ee,isDragging:te}=rs({id:_});if(!C)return null;const ce={transform:te?as.Transform.toString(oe):void 0,transition:te?ee:void 0},Ie=q(C);return e.jsx("div",{ref:X,style:ce,className:"flex-shrink-0",children:e.jsx("button",{onClick:()=>s(_),onContextMenu:ze=>{ze.stopPropagation(),c(ze,_)},"data-widget-button":"true",className:"group w-14 h-14 bg-accent text-2xl rounded-lg flex items-center justify-center hover:brightness-110 hover:scale-105",title:Ie,...W,...V,children:e.jsx("span",{className:"transform-gpu group-hover:scale-110",children:C.icon})})})},ie=_=>{const C=_.target;C?.closest('[data-widget-button="true"]')||C?.closest('[data-task-button="true"]')||c(_,void 0,!0)};r.useLayoutEffect(()=>{const _=()=>{const C=I.current,W=m?.current;if(!C||!W){S(null),O(null);return}const V=8,X=C.getBoundingClientRect(),oe=W.getBoundingClientRect(),ee=window.innerWidth/2-X.width/2,te=oe.right+V;if(ee<te){const ce=Math.max(240,window.innerWidth-te-V);S(te),O(ce)}else S(null),O(null)};return _(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)},[t,x,g,E,m]);const j=g&&!E?"0.75rem":"0rem";return e.jsxs("div",{ref:I,className:`fixed bottom-5 left-1/2 bg-widget-bg p-2 rounded-2xl flex items-center gap-3 shadow-lg z-[10000] border border-custom-border max-w-[calc(100vw-1rem)] transition-all duration-200 max-[700px]:hidden ${g&&!E?"opacity-0 pointer-events-none":"opacity-100"}`,style:{transform:`${a===null?"translate(-50%, ":"translate(0, "}${j})`,left:a===null?void 0:`${a}px`,maxWidth:A===null?void 0:`${A}px`},"data-toolbar":"true",onContextMenu:ie,onMouseLeave:w,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zt,{sensors:ge,collisionDetection:es,onDragEnd:Z,children:e.jsx(ns,{items:J,strategy:sn,children:e.jsx("div",{className:"flex items-center gap-2",children:J.map(_=>e.jsx(M,{widgetId:_},_))})})}),e.jsx("button",{onClick:i,onContextMenu:_=>c(_,void 0,!0),className:"w-10 h-10 rounded-full text-text-light bg-black/20 hover:bg-black/30 transition-all duration-200 flex items-center justify-center flex-shrink-0",title:o("toolbar.widgetLibrary"),"aria-label":o("toolbar.widgetLibrary"),children:e.jsx(Xt,{size:18})})]}),ue.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-10 w-px bg-white/30"}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pr-1 min-w-0 flex-1",children:ue.map(_=>e.jsx("button",{type:"button",onClick:()=>l(_.instanceId),onContextMenu:C=>{C.stopPropagation(),u(C,_.instanceId)},"data-task-button":"true",className:`min-w-[120px] max-w-[180px] truncate px-3 py-2 rounded-lg border text-xs font-semibold transition ${_.isMinimized?"bg-white/60 border-gray-200 text-gray-500":_.zIndex===Q?"bg-amber-100 border-amber-300 text-amber-800":"bg-white/90 border-gray-200 text-text-dark hover:bg-amber-50"}`,title:_.label,"aria-label":_.label,children:e.jsxs("span",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-sm leading-none",children:_.icon}),e.jsx("span",{className:"truncate",children:_.title})]})},_.instanceId))})]})]})},Rt=[{id:"organization",titleKey:"settings.widgets.categories.organization",widgetIds:["work-list","attendance","class-diary","group-generator","calendar"]},{id:"time",titleKey:"settings.widgets.categories.time",widgetIds:["timer","stopwatch","metronome","global-clocks"]},{id:"math_science",titleKey:"settings.widgets.categories.math_science",widgetIds:["scientific-calculator","unit-converter","latex-markdown"]},{id:"community",titleKey:"settings.widgets.categories.community",widgetIds:["vce-community","comunidad-chatgpt-ia-edu","edumedia-iag"]},{id:"board_writing",titleKey:"settings.widgets.categories.board_writing",widgetIds:["notepad","drawing-pad","image-carousel","edimarkweb","html-sandbox","boardlive"]},{id:"resources",titleKey:"settings.widgets.categories.resources",widgetIds:["iframe","local-web","pdf-viewer","file-opener","directo-viewer","wikipedia-search"]},{id:"interaction",titleKey:"settings.widgets.categories.interaction",widgetIds:["dice","random-spinner","qr-code-generator","traffic-light","sound-meter","scoreboard"]},{id:"participation",titleKey:"settings.widgets.categories.participation",widgetIds:["directo-vota","directo-escala","directo-nube","directo-ideas","directo-muro","qplay","boardlive"]},{id:"logic_games",titleKey:"settings.widgets.categories.logic_games",widgetIds:["tic-tac-toe","memory-game","sliding-puzzle"]},{id:"gestures",titleKey:"settings.widgets.categories.gestures",widgetIds:["work-gestures"]}],cs=(t,s)=>{const i=new Map(t.map(l=>[l.id,l])),c=Rt.map(l=>({...l,widgets:l.widgetIds.map(u=>i.get(u)).filter(u=>!!u).sort((u,g)=>s(u.title).localeCompare(s(g.title)))})),p=new Set(Rt.flatMap(l=>l.widgetIds)),x=t.filter(l=>!p.has(l.id)).sort((l,u)=>s(l.title).localeCompare(s(u.title)));return x.length>0&&c.push({id:"other",titleKey:"settings.widgets.categories.other",widgetIds:x.map(l=>l.id),widgets:x}),c},oo="/escritorio/assets/fondo01-1920-DQ9YqYXb.webp",ro="/escritorio/assets/fondo01-2560-BhYwScvF.webp",ao="/escritorio/assets/fondo02-1920-CkNjKDZL.webp",lo="/escritorio/assets/fondo02-2560-BHdQH5Tz.webp",co="/escritorio/assets/fondo03-1920-6uaXYCMy.webp",go="/escritorio/assets/fondo03-2560-D54ZlzdJ.webp",uo="/escritorio/assets/fondo04-1920-lLv979Fv.webp",mo="/escritorio/assets/fondo04-2560-CLLBOnYy.webp",ho="/escritorio/assets/fondo05-1920-CHlhzsPi.webp",fo="/escritorio/assets/fondo05-2560-hgpnzGY3.webp",bo="/escritorio/assets/fondo06-1920-CQZ3V-je.webp",po="/escritorio/assets/fondo06-2560-bB_z6UE8.webp",xo="/escritorio/assets/fondo07-1920-C8UIaOrN.webp",wo="/escritorio/assets/fondo07-2560-BYU5aKLI.webp",_o="/escritorio/assets/fondo08-1920-AdGMGon5.webp",yo="/escritorio/assets/fondo08-2560-CqfJPhF-.webp",jo="/escritorio/assets/fondo09-1920-B06QmLnf.webp",vo="/escritorio/assets/fondo09-2560-RakF4Xnz.webp",ko="/escritorio/assets/fondo10-1920-Pkarw0Pa.webp",Co="/escritorio/assets/fondo10-2560-CYpZFt1-.webp",No="/escritorio/assets/fondo11-1920-DMUk-tk5.webp",So="/escritorio/assets/fondo11-2560-BPq20Wq-.webp",Io="/escritorio/assets/fondo12-1920-D-tqmJlT.webp",zo="/escritorio/assets/fondo12-2560-CB3zOAPz.webp",Eo="/escritorio/assets/fondo13-1920-DOpAlvqG.webp",Wo="/escritorio/assets/fondo13-2560-CmSJaBRt.webp",Mo="/escritorio/assets/fondo14-1920-CJl22m7O.webp",Oo="/escritorio/assets/fondo14-2560-D4bfWxAE.webp",Do="/escritorio/assets/fondo15-1920-BKFORNdS.webp",To="/escritorio/assets/fondo15-2560-BO3wyQno.webp",Lo="/escritorio/assets/fondo16-1920-DtfASKuP.webp",Fo="/escritorio/assets/fondo16-2560-D2epzX5q.webp",Po="/escritorio/assets/gemini-16uf0k16uf0k16uf-1920-Bkw3X8It.webp",$o="/escritorio/assets/gemini-16uf0k16uf0k16uf-2560-BfXj68w3.webp",Ao="/escritorio/assets/gemini-2ap5fj2ap5fj2ap5-1920-a44PJlMO.webp",Ro="/escritorio/assets/gemini-2ap5fj2ap5fj2ap5-2560-6XLIb1DZ.webp",Bo="/escritorio/assets/gemini-9lvikq9lvikq9lvi-1920-DedAlMh6.webp",Vo="/escritorio/assets/gemini-9lvikq9lvikq9lvi-2560-Cl62r3ny.webp",Ho="/escritorio/assets/gemini-louvkrlouvkrlouv-1920-DBK9_T9Y.webp",Ko="/escritorio/assets/gemini-louvkrlouvkrlouv-2560-CKhcAHXA.webp",qo="/escritorio/assets/gemini-xiejfxiejfxiejfx-1920-CJodUFDt.webp",Go="/escritorio/assets/gemini-xiejfxiejfxiejfx-2560-rYumsXvf.webp",Uo="/escritorio/assets/gemini-yntaleyntaleynta-1920-BGyMXLie.webp",Yo="/escritorio/assets/gemini-yntaleyntaleynta-2560-KPkUYpwP.webp",Xo=Object.assign({"../assets/backgrounds/fondo01-1920.webp":oo,"../assets/backgrounds/fondo01-2560.webp":ro,"../assets/backgrounds/fondo02-1920.webp":ao,"../assets/backgrounds/fondo02-2560.webp":lo,"../assets/backgrounds/fondo03-1920.webp":co,"../assets/backgrounds/fondo03-2560.webp":go,"../assets/backgrounds/fondo04-1920.webp":uo,"../assets/backgrounds/fondo04-2560.webp":mo,"../assets/backgrounds/fondo05-1920.webp":ho,"../assets/backgrounds/fondo05-2560.webp":fo,"../assets/backgrounds/fondo06-1920.webp":bo,"../assets/backgrounds/fondo06-2560.webp":po,"../assets/backgrounds/fondo07-1920.webp":xo,"../assets/backgrounds/fondo07-2560.webp":wo,"../assets/backgrounds/fondo08-1920.webp":_o,"../assets/backgrounds/fondo08-2560.webp":yo,"../assets/backgrounds/fondo09-1920.webp":jo,"../assets/backgrounds/fondo09-2560.webp":vo,"../assets/backgrounds/fondo10-1920.webp":ko,"../assets/backgrounds/fondo10-2560.webp":Co,"../assets/backgrounds/fondo11-1920.webp":No,"../assets/backgrounds/fondo11-2560.webp":So,"../assets/backgrounds/fondo12-1920.webp":Io,"../assets/backgrounds/fondo12-2560.webp":zo,"../assets/backgrounds/fondo13-1920.webp":Eo,"../assets/backgrounds/fondo13-2560.webp":Wo,"../assets/backgrounds/fondo14-1920.webp":Mo,"../assets/backgrounds/fondo14-2560.webp":Oo,"../assets/backgrounds/fondo15-1920.webp":Do,"../assets/backgrounds/fondo15-2560.webp":To,"../assets/backgrounds/fondo16-1920.webp":Lo,"../assets/backgrounds/fondo16-2560.webp":Fo,"../assets/backgrounds/gemini-16uf0k16uf0k16uf-1920.webp":Po,"../assets/backgrounds/gemini-16uf0k16uf0k16uf-2560.webp":$o,"../assets/backgrounds/gemini-2ap5fj2ap5fj2ap5-1920.webp":Ao,"../assets/backgrounds/gemini-2ap5fj2ap5fj2ap5-2560.webp":Ro,"../assets/backgrounds/gemini-9lvikq9lvikq9lvi-1920.webp":Bo,"../assets/backgrounds/gemini-9lvikq9lvikq9lvi-2560.webp":Vo,"../assets/backgrounds/gemini-louvkrlouvkrlouv-1920.webp":Ho,"../assets/backgrounds/gemini-louvkrlouvkrlouv-2560.webp":Ko,"../assets/backgrounds/gemini-xiejfxiejfxiejfx-1920.webp":qo,"../assets/backgrounds/gemini-xiejfxiejfxiejfx-2560.webp":Go,"../assets/backgrounds/gemini-yntaleyntaleynta-1920.webp":Uo,"../assets/backgrounds/gemini-yntaleyntaleynta-2560.webp":Yo}),ot={},Qo=/\/([^/]+?)(?:-(\d+))?\.webp$/;Object.entries(Xo).forEach(([t,s])=>{const i=t.match(Qo);if(!i)return;const c=i[1],p=i[2]?Number(i[2]):0;ot[c]||(ot[c]={}),ot[c][p]=s});const Jo=["gemini-9lvikq9lvikq9lvi","gemini-16uf0k16uf0k16uf","gemini-louvkrlouvkrlouv","gemini-xiejfxiejfxiejfx","gemini-2ap5fj2ap5fj2ap5","gemini-yntaleyntaleynta"],Bt=new Map(Jo.map((t,s)=>[t,s])),at=Object.entries(ot).map(([t,s])=>{const i=Object.keys(s).map(Number).sort((p,x)=>p-x),c=i[0];return{id:t,sizes:i,urlsBySize:s,previewUrl:s[c],urls:i.map(p=>s[p])}}).sort((t,s)=>{const i=Bt.get(t.id),c=Bt.get(s.id);return i!=null&&c!=null?i-c:i!=null?-1:c!=null?1:t.id.localeCompare(s.id)}),Zo=()=>typeof window>"u"?1920:Math.floor(window.innerWidth*(window.devicePixelRatio||1)),er=t=>{const s=Zo(),c=t.sizes.find(p=>p>=s)??t.sizes[t.sizes.length-1];return t.urlsBySize[c]},ds=t=>`url(${er(t)})`,tr=new Set(at.flatMap(t=>t.urls.map(s=>`url(${s})`))),sr=t=>tr.has(t),nr="gemini-9lvikq9lvikq9lvi",Vt=at.find(t=>t.id===nr)??at[0],gs=Vt?ds(Vt):"none",Ze={"--color-bg":"#FFFFFF","--color-widget-bg":"#00809D","--color-widget-header":"#D3AF37","--color-accent":"#FFD700","--color-text-light":"#FCF8DD","--color-text-dark":"#1a202c","--color-border":"#FFFFFF","--wallpaper":gs,"--font-scale":"1",showDateTime:!0,showSystemStats:!1,highContrast:!1},us=r.createContext(void 0),ir=({children:t,value:s})=>e.jsx(us.Provider,{value:s,children:t}),_t=()=>{const t=r.useContext(us);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},or=()=>{const{t}=L(),{theme:s,setTheme:i,defaultTheme:c}=_t(),p=m=>{const{name:o,value:I}=m.target;i({...s,[o]:I})},x=m=>{const{checked:o}=m.target;i(I=>({...I,highContrast:o}))},l=m=>{const{value:o}=m.target;i(I=>({...I,"--font-scale":o}))},u=[{id:"classic",labelKey:"settings.theme.presets.classic",colors:{"--color-bg":c["--color-bg"],"--color-widget-bg":c["--color-widget-bg"],"--color-widget-header":c["--color-widget-header"],"--color-accent":c["--color-accent"],"--color-text-light":c["--color-text-light"],"--color-text-dark":c["--color-text-dark"],"--color-border":c["--color-border"]}},{id:"chalkboard",labelKey:"settings.theme.presets.chalkboard",colors:{"--color-bg":"#122B39","--color-widget-bg":"#1F4E5F","--color-widget-header":"#F4B860","--color-accent":"#F7D07A","--color-text-light":"#F7F4EA","--color-text-dark":"#0B1B21","--color-border":"#122B39"}},{id:"slate",labelKey:"settings.theme.presets.slate",colors:{"--color-bg":"#232136","--color-widget-bg":"#3A355A","--color-widget-header":"#9E7FB2","--color-accent":"#F6C177","--color-text-light":"#F5F2FF","--color-text-dark":"#14111F","--color-border":"#232136"}},{id:"sand",labelKey:"settings.theme.presets.sand",colors:{"--color-bg":"#FFF3D9","--color-widget-bg":"#FF7A5C","--color-widget-header":"#2B7A78","--color-accent":"#F5D547","--color-text-light":"#FFF8EA","--color-text-dark":"#2B1D0E","--color-border":"#F3E2BF"}},{id:"ocean",labelKey:"settings.theme.presets.ocean",colors:{"--color-bg":"#E9F4FF","--color-widget-bg":"#2F80ED","--color-widget-header":"#1B3A57","--color-accent":"#FFB703","--color-text-light":"#F8F9FB","--color-text-dark":"#0E1A24","--color-border":"#D7E8FF"}},{id:"confetti",labelKey:"settings.theme.presets.confetti",colors:{"--color-bg":"#FFF6F9","--color-widget-bg":"#FF6B6B","--color-widget-header":"#6BCB77","--color-accent":"#4D96FF","--color-text-light":"#FFFFFF","--color-text-dark":"#2B2D42","--color-border":"#FDE3EC"}},{id:"sunrise",labelKey:"settings.theme.presets.sunrise",colors:{"--color-bg":"#FFE8D6","--color-widget-bg":"#FF7F50","--color-widget-header":"#6C5B7B","--color-accent":"#F9C74F","--color-text-light":"#FFF7EA","--color-text-dark":"#2D1E1E","--color-border":"#F6D3C1"}},{id:"berry",labelKey:"settings.theme.presets.berry",colors:{"--color-bg":"#F6ECFF","--color-widget-bg":"#7B2CBF","--color-widget-header":"#FAD643","--color-accent":"#FF70A6","--color-text-light":"#FDF7FF","--color-text-dark":"#221133","--color-border":"#EAD9FF"}},{id:"mint",labelKey:"settings.theme.presets.mint",colors:{"--color-bg":"#E8FFF7","--color-widget-bg":"#2A9D8F","--color-widget-header":"#264653","--color-accent":"#E9C46A","--color-text-light":"#F7FFFB","--color-text-dark":"#0E1F20","--color-border":"#D2F3E7"}}],g=m=>{i(o=>({...o,...m.colors}))},E=m=>Object.entries(m.colors).every(([o,I])=>s[o]===I),w=[{id:"--color-bg",labelKey:"desktop_bg"},{id:"--color-widget-bg",labelKey:"widget_bg"},{id:"--color-widget-header",labelKey:"widget_header"},{id:"--color-accent",labelKey:"accent"},{id:"--color-text-light",labelKey:"text_light"},{id:"--color-text-dark",labelKey:"text_dark"}];return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("settings.theme.accessibility_title")}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t("settings.theme.accessibility_help")}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("label",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t("settings.theme.high_contrast")}),e.jsx("input",{type:"checkbox",checked:!!s.highContrast,onChange:x,className:"h-4 w-4 rounded border-gray-300 accent-accent"})]}),e.jsxs("label",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t("settings.theme.font_scale")}),e.jsxs("select",{value:s["--font-scale"],onChange:l,className:"p-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none",children:[e.jsx("option",{value:"0.9",children:t("settings.theme.font_scale_90")}),e.jsx("option",{value:"1",children:t("settings.theme.font_scale_100")}),e.jsx("option",{value:"1.1",children:t("settings.theme.font_scale_110")}),e.jsx("option",{value:"1.25",children:t("settings.theme.font_scale_125")}),e.jsx("option",{value:"1.5",children:t("settings.theme.font_scale_150")})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("settings.theme.presets_title")}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t("settings.theme.presets_help")}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:u.map(m=>{const o=E(m);return e.jsxs("button",{type:"button",onClick:()=>g(m),className:`text-left p-3 rounded-lg border transition-all ${o?"border-accent ring-2 ring-accent":"border-gray-200 hover:border-gray-400"}`,"aria-pressed":o,children:[e.jsxs("div",{className:"h-14 rounded-md overflow-hidden border border-black/10 mb-2",style:{backgroundColor:m.colors["--color-bg"]},children:[e.jsx("div",{style:{backgroundColor:m.colors["--color-widget-header"]},className:"h-4"}),e.jsxs("div",{className:"flex h-10",children:[e.jsx("div",{style:{backgroundColor:m.colors["--color-widget-bg"]},className:"flex-1"}),e.jsx("div",{style:{backgroundColor:m.colors["--color-accent"]},className:"w-6"})]})]}),e.jsx("span",{className:"text-sm font-semibold",children:t(m.labelKey)})]},m.id)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t("settings.theme.theme_colors_title")}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:w.map(({id:m,labelKey:o})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:m,className:"text-sm",children:t(`settings.theme.colors.${o}`)}),e.jsx("input",{type:"color",id:m,name:m,value:s[m],onChange:p,className:"theme-color-input"})]},m))})]})]})},rr=({isOpen:t,onClose:s})=>{const{t:i}=L();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10002] flex items-center justify-center",onClick:c=>{c.stopPropagation(),s()},children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("settings.theme.modal_title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsx("div",{className:"overflow-y-auto",children:e.jsx(or,{})})]})}):null},ar="escritorio-digital",lt="kv",lr=1;let ut=null;const cr=()=>(ut||(ut=new Promise((t,s)=>{const i=window.indexedDB.open(ar,lr);i.onupgradeneeded=()=>{const c=i.result;c.objectStoreNames.contains(lt)||c.createObjectStore(lt)},i.onsuccess=()=>t(i.result),i.onerror=()=>s(i.error)})),ut),yt=async(t,s)=>{const i=await cr();return new Promise((c,p)=>{const l=i.transaction(lt,t).objectStore(lt),u=s(l);u.onsuccess=()=>c(u.result),u.onerror=()=>p(u.error)})},ms=async t=>await yt("readonly",i=>i.get(t))??null,Ht=async(t,s)=>{await yt("readwrite",i=>i.put(s,t))},hs=async t=>{await yt("readwrite",s=>s.delete(t))},wt="__indexed_db__",dr=2e5,gr=1,tt=["work-list-tasks","spinner-options","notepad-content-html","image-carousel-images","tictactoe-players","tictactoe-score","global-clocks-selection","attendance-records","traffic-light-state","scoreboard-players","toolbar-hidden","i18nextLng","profile-order","widgets-view-mode"],ur="escritorio-digital-sites",mr=1,xe="sites",we="files";let mt=null;const Ge=()=>(mt||(mt=new Promise((t,s)=>{const i=window.indexedDB.open(ur,mr);i.onupgradeneeded=()=>{const c=i.result;c.objectStoreNames.contains(xe)||c.createObjectStore(xe,{keyPath:"id"}),c.objectStoreNames.contains(we)||c.createObjectStore(we,{keyPath:"key"}).createIndex("siteId","siteId",{unique:!1})},i.onsuccess=()=>t(i.result),i.onerror=()=>s(i.error)})),mt),hr=t=>{const s=atob(t),i=new Uint8Array(s.length);for(let c=0;c<s.length;c+=1)i[c]=s.charCodeAt(c);return i.buffer},fr=async t=>{const s={};for(const i of t){const c=window.localStorage.getItem(i);if(c)if(c===wt){const p=await ms(i);if(p==null)continue;s[i]={storage:"indexedDb",value:p}}else s[i]={storage:"localStorage",value:c}}return s},br=async t=>{for(const[s,i]of Object.entries(t)){if(i.storage==="indexedDb"){await Ht(s,i.value),window.localStorage.setItem(s,wt);continue}if(i.value.length>dr){await Ht(s,i.value),window.localStorage.setItem(s,wt);continue}window.localStorage.setItem(s,i.value),await hs(s)}},pr=async(t,s)=>{const i=await Ge();return new Promise((c,p)=>{const x=i.transaction([xe,we],"readonly"),l=x.objectStore(xe).getAll(),u=x.objectStore(we).getAll();x.oncomplete=()=>{const g=l.result??[],E=u.result??[],m=(t&&t.length>0?g.filter(a=>!a.profileName||t.includes(a.profileName)):g).map(a=>({...a,profileName:a.profileName??s})),o=new Set(m.map(a=>a.id)),I=E.filter(a=>o.has(a.siteId)).map(a=>({...a,profileName:a.profileName??s}));c({sites:m,files:I})},x.onerror=()=>p(x.error)})},ht=async(t,s)=>{const i=await Ge();return new Promise((c,p)=>{const x=i.transaction([xe,we],"readonly"),l=x.objectStore(xe).getAll(),u=x.objectStore(we).getAll();x.oncomplete=()=>{const g=l.result??[],E=u.result??[],w=t&&t.length>0?g.filter(a=>!a.profileName||t.includes(a.profileName)):g,m=new Set(w.map(a=>a.id)),o=w.reduce((a,S)=>a+(S.totalBytes||0),0),I=E.filter(a=>m.has(a.siteId)).reduce((a,S)=>a+(S.size||0),0);c({siteCount:w.length,totalBytes:I>0?I:o})},x.onerror=()=>p(x.error)})},fs=async()=>{const t=await Ge();await new Promise((s,i)=>{const c=t.transaction([xe,we],"readwrite");c.objectStore(xe).clear(),c.objectStore(we).clear(),c.oncomplete=()=>s(),c.onerror=()=>i(c.error)})},xr=async(t,s)=>{const i=await Ge();await new Promise((c,p)=>{const x=i.transaction([xe,we],"readwrite"),l=x.objectStore(xe),u=x.objectStore(we);t.sites.forEach(g=>{const w=(g.profileName&&s?.profileNameMap?.get(g.profileName))??g.profileName??s?.fallbackProfileName;l.put({...g,profileName:w})}),t.files.forEach(g=>{const w=(g.profileName&&s?.profileNameMap?.get(g.profileName))??g.profileName??s?.fallbackProfileName,m=hr(g.dataBase64),o=new Blob([m],{type:g.type});u.put({key:g.key,siteId:g.siteId,path:g.path,blob:o,size:g.size,type:g.type,profileName:w})}),x.oncomplete=()=>c(),x.onerror=()=>p(x.error)})},wr=async(t,s)=>{const i=await Ge();if(s?.signal?.aborted)throw new Error("abort");await new Promise((l,u)=>{const g=i.transaction(xe,"readwrite"),E=g.objectStore(xe);t.sites.forEach(w=>{const o=(w.profileName&&s?.profileNameMap?.get(w.profileName))??w.profileName??s?.fallbackProfileName;E.put({...w,profileName:o})}),g.oncomplete=()=>l(),g.onerror=()=>u(g.error)});const c=t.files.length,p=50;let x=0;for(let l=0;l<t.files.length;l+=p){if(s?.signal?.aborted)throw new Error("abort");const u=t.files.slice(l,l+p);await new Promise((g,E)=>{const w=i.transaction(we,"readwrite"),m=w.objectStore(we);u.forEach(o=>{const a=(o.profileName&&s?.profileNameMap?.get(o.profileName))??o.profileName??s?.fallbackProfileName;m.put({key:o.key,siteId:o.siteId,path:o.path,blob:o.blob,size:o.size,type:o.type,profileName:a})}),w.oncomplete=()=>g(),w.onerror=()=>E(w.error)}),x+=u.length,s?.onProgress&&s.onProgress(x,c),s?.yieldControl&&await s.yieldControl()}},bs=t=>({meta:{app:"Escritorio Digital",version:gr,createdAt:new Date().toISOString()},data:t}),ps=t=>{if(!t||typeof t!="object")return!1;const s=t;return!(!s.meta||!s.data||typeof s.meta.app!="string"||typeof s.meta.version!="number"||typeof s.meta.createdAt!="string"||typeof s.data!="object")},_r=t=>{const s=new Uint8Array(t);return s.length>=4&&s[0]===80&&s[1]===75&&s[2]===3&&s[3]===4},yr=async(t,s,i,c,p)=>{const x=bs(t),l=[];await new Promise((w,m)=>{const o=new on((a,S,A)=>{if(a){m(a);return}S&&l.push(S),A&&w()}),I=(a,S)=>{const A=new an(a,{level:6});o.add(A),A.push(S,!0)};(async()=>{try{if(I("manifest.json",Tt(JSON.stringify(x))),s){const a=s.files.map(O=>({key:O.key,siteId:O.siteId,path:O.path,type:O.type,size:O.size,profileName:O.profileName}));I("localWeb/meta.json",Tt(JSON.stringify({sites:s.sites,files:a})));const S=s.files.length;let A=0;for(const O of s.files){if(p?.aborted){m(new Error("abort"));return}const q=await O.blob.arrayBuffer();I(`localWeb/files/${O.key}`,new Uint8Array(q)),A+=1,i&&i(A,S),c&&await c()}}o.end()}catch(a){m(a)}})()});const u=l.reduce((w,m)=>w+m.length,0),g=new Uint8Array(u);let E=0;return l.forEach(w=>{g.set(w,E),E+=w.length}),g},jr=t=>{const s=rn(new Uint8Array(t)),i=s["manifest.json"];if(!i)throw new Error("missing manifest");const c=JSON.parse(Lt(i));if(!ps(c))throw new Error("invalid payload");const p=s["localWeb/meta.json"];if(!p)return{payload:c};const x=JSON.parse(Lt(p)),l=[];return x.files.forEach(u=>{const g=s[`localWeb/files/${u.key}`];g&&l.push({...u,profileName:u.profileName,blob:new Blob([g],{type:u.type})})}),{payload:c,localWeb:{sites:x.sites??[],files:l}}},vr=async(t,s)=>{const i=await Ge(),{sites:c,files:p}=await new Promise((w,m)=>{const o=i.transaction([xe,we],"readonly"),I=o.objectStore(xe).getAll(),a=o.objectStore(we).getAll();o.oncomplete=()=>{w({sites:I.result??[],files:a.result??[]})},o.onerror=()=>m(o.error)}),x=Date.now(),l=c.filter(w=>w.profileName===t||!w.profileName);if(l.length===0)return;const u=new Map,g=l.map(w=>{const m=crypto.randomUUID();return u.set(w.id,m),{...w,id:m,profileName:s,createdAt:x,updatedAt:x}}),E=p.filter(w=>u.has(w.siteId)).map(w=>{const m=u.get(w.siteId);return{...w,key:`${m}::${w.path}`,siteId:m,profileName:s}});await new Promise((w,m)=>{const o=i.transaction([xe,we],"readwrite"),I=o.objectStore(xe),a=o.objectStore(we);l.forEach(S=>{S.profileName||I.put({...S,profileName:t})}),g.forEach(S=>I.put(S)),E.forEach(S=>{a.put({key:S.key,siteId:S.siteId,path:S.path,blob:S.blob,size:S.size,type:S.type,profileName:S.profileName})}),o.oncomplete=()=>w(),o.onerror=()=>m(o.error)})},kr=({profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,onCloseSettings:p,profileOrder:x,setProfileOrder:l})=>{const{t:u}=L(),[g,E]=r.useState(""),[w,m]=r.useState("empty"),[o,I]=r.useState(null),[a,S]=r.useState(""),{theme:A}=_t(),O=["work-list","timer","file-opener","vce-community"],q="Escritorio Principal",Q=x.filter(j=>t[j]);Object.keys(t).forEach(j=>{Q.includes(j)||Q.push(j)});const ge=j=>j===q?u("settings.profiles.default_name"):j,J=async()=>{const j=g.trim();if(j&&!t[j]){const _=t[i],C=w==="clone"?{..._,theme:A}:{theme:Ze,activeWidgets:[],pinnedWidgets:O,vceFavorites:[]};if(s(W=>({...W,[j]:{...C}})),l(W=>[...W,j]),w==="clone")try{await vr(i,j)}catch(W){console.error(W)}c(j),E("")}else alert(u("settings.profiles.invalid_name_alert"))},ue=j=>{if(Object.keys(t).length<=1){alert(u("settings.profiles.delete_last_alert"));return}const _=ge(j);if(window.confirm(u("settings.profiles.delete_confirm",{name:_}))){const C={...t};delete C[j],s(C),l(W=>W.filter(V=>V!==j)),i===j&&c(Object.keys(C)[0])}},Z=()=>{I(null),S("")},M=j=>{const _=a.trim();if(!_){alert(u("settings.profiles.invalid_name_alert"));return}if(_===j){Z();return}if(t[_]){alert(u("settings.profiles.invalid_name_alert"));return}s(C=>{const W={...C},V=W[j];return V?(delete W[j],W[_]=V,W):C}),l(C=>C.map(W=>W===j?_:W)),i===j&&c(_),Z()},ie=(j,_)=>{l(C=>{const W=C.filter(te=>t[te]),V=W.indexOf(j);if(V===-1)return C;const X=_==="up"?V-1:V+1;if(X<0||X>=W.length)return C;const oe=[...W],[ee]=oe.splice(V,1);return oe.splice(X,0,ee),oe})};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:u("settings.profiles.save_current_title")}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:u("settings.profiles.create_mode_label")}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"profile-create-mode",value:"empty",checked:w==="empty",onChange:()=>m("empty")}),e.jsx("span",{children:u("settings.profiles.create_mode_empty")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"profile-create-mode",value:"clone",checked:w==="clone",onChange:()=>m("clone")}),e.jsx("span",{children:u("settings.profiles.create_mode_clone")})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:j=>E(j.target.value),placeholder:u("settings.profiles.new_profile_placeholder"),className:"flex-grow bg-white border-2 border-gray-300 rounded p-2 focus:border-accent outline-none text-sm"}),e.jsx("button",{onClick:J,className:"font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark",children:u("settings.profiles.save_button")})]})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>{p(),window.dispatchEvent(new CustomEvent("open-profile-backup",{detail:{tab:"export"}}))},className:"w-full text-left px-3 py-2 rounded-lg bg-white border border-gray-300 text-sm text-text-dark hover:bg-gray-100 transition-colors shadow-sm",children:u("backup.manage_profiles")})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:u("settings.profiles.saved_profiles_title")}),e.jsx("ul",{className:"space-y-2",children:Q.map((j,_)=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[o===j?e.jsx("input",{type:"text",value:a,onChange:C=>S(C.target.value),onBlur:()=>M(j),onKeyDown:C=>{C.key==="Enter"&&M(j),C.key==="Escape"&&Z()},placeholder:u("settings.profiles.rename_placeholder"),className:"flex-grow bg-white border-2 border-gray-300 rounded p-2 focus:border-accent outline-none text-sm"}):e.jsx("div",{onDoubleClick:()=>{I(j),S(j)},className:"flex-grow font-semibold cursor-text rounded px-2 py-1 hover:bg-white/60",title:u("settings.profiles.rename_hint"),children:ge(j)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ie(j,"up"),disabled:_===0,className:"p-2 rounded-lg bg-white border border-gray-200 text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed",title:u("settings.profiles.move_up"),"aria-label":u("settings.profiles.move_up"),children:e.jsx(zs,{size:16})}),e.jsx("button",{onClick:()=>ie(j,"down"),disabled:_===Q.length-1,className:"p-2 rounded-lg bg-white border border-gray-200 text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed",title:u("settings.profiles.move_down"),"aria-label":u("settings.profiles.move_down"),children:e.jsx(Es,{size:16})}),e.jsx("button",{onClick:()=>c(j),disabled:j===i,className:"p-2 rounded-lg bg-blue-500 text-white disabled:opacity-50",title:u(j===i?"settings.profiles.active_button":"settings.profiles.load_button"),"aria-label":u(j===i?"settings.profiles.active_button":"settings.profiles.load_button"),children:j===i?e.jsx(Ws,{size:16}):e.jsx(Ms,{size:16})}),e.jsx("button",{onClick:()=>ue(j),className:"p-2 rounded-lg bg-red-500 text-white",title:u("settings.profiles.delete_button"),"aria-label":u("settings.profiles.delete_button"),children:e.jsx(Os,{size:16})})]})]},j))})]})]})},Cr=({isOpen:t,onClose:s,initialTab:i="general",themeModalRequestId:c,pinnedWidgets:p,setPinnedWidgets:x,profiles:l,setProfiles:u,activeProfileName:g,setActiveProfileName:E,profileOrder:w,setProfileOrder:m})=>{const{t:o,i18n:I}=L(),[a,S]=r.useState("general"),[A,O]=r.useState(""),[q,Q]=et("widgets-view-mode","theme"),[ge,J]=r.useState(!1),ue=r.useRef(null),{theme:Z,setTheme:M,setWallpaper:ie,resetTheme:j}=_t(),_=r.useRef(null),C=r.useRef(null);r.useEffect(()=>{t&&S(i)},[t,i]),r.useEffect(()=>{if(!t||a!=="widgets")return;const v=window.requestAnimationFrame(()=>{C.current?.focus()});return()=>window.cancelAnimationFrame(v)},[t,a]),r.useEffect(()=>{t||J(!1)},[t]),r.useEffect(()=>{!t||c==null||c<=0||ue.current!==c&&(ue.current=c,S("theme"),J(!0))},[t,c]);const W=v=>{const T=v.target.files?.[0];if(T){const G=new FileReader;G.onload=le=>{const re=le.target?.result;ie(`url(${re})`)},G.readAsDataURL(T)}},V=v=>{const{checked:T}=v.target;M(G=>({...G,showDateTime:T}))},X=v=>{const{checked:T}=v.target;M(G=>({...G,showSystemStats:T}))},oe=v=>{const{value:T}=v.target;M({...Z,"--color-bg":T,"--wallpaper":"none"})},ee=r.useCallback(v=>v.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),[]),te=r.useMemo(()=>{const v=ee(A.trim());return Object.values(Se).filter(G=>{if(!A.trim())return!0;const le=ee(o(G.title)),re=G.startTooltip?ee(o(G.startTooltip)):"",ve=(G.searchKeywords||[]).flatMap(se=>o(se).split(",")).map(se=>ee(se.trim())).filter(Boolean).some(se=>se.includes(v));return le.includes(v)||re.includes(v)||ve}).sort((G,le)=>o(G.title).localeCompare(o(le.title)))},[ee,A,o]),ce=r.useMemo(()=>cs(te,o),[te,o]),Ie=20,ze=Object.keys(Se).length,De=v=>{x(T=>T.includes(v)?T.filter(G=>G!==v):T.length<Ie?[...T,v]:(alert(o("settings.widgets.max_widgets_alert",{max:Ie})),T))},H=v=>{const T=v.target.value;I.changeLanguage(T)},N=async()=>{if(!window.confirm(o("settings.general.reset_confirm")))return;const v=Array.from(new Set(["desktop-profiles","active-profile-name",...tt]));try{v.forEach(T=>window.localStorage.removeItem(T)),await Promise.all(tt.map(T=>hs(T))),await fs()}catch(T){console.warn("No se pudieron limpiar las preferencias locales.",T)}window.location.reload()};return e.jsxs(ln,{children:[t&&e.jsx(Ft.div,{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:e.jsxs(Ft.div,{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col",onClick:v=>v.stopPropagation(),initial:{scale:.7,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.7,opacity:0},transition:{type:"spring",stiffness:100,damping:10},children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:o("settings.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsxs("div",{className:"flex border-b",children:[e.jsx("button",{onClick:()=>S("general"),className:`flex-1 p-3 font-semibold ${a==="general"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.general")}),e.jsx("button",{onClick:()=>S("profiles"),className:`flex-1 p-3 font-semibold ${a==="profiles"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.profiles")}),e.jsx("button",{onClick:()=>S("widgets"),className:`flex-1 p-3 font-semibold ${a==="widgets"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.widgets")}),e.jsx("button",{onClick:()=>S("theme"),className:`flex-1 p-3 font-semibold ${a==="theme"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.theme")})]}),e.jsxs("div",{className:"overflow-y-auto px-4 pb-4 pt-0",children:[a==="general"&&e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:o("settings.tabs.general")}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{htmlFor:"language-select",className:"font-medium",children:[o("settings.general.language"),":"]}),e.jsxs("select",{id:"language-select",value:I.language,onChange:H,className:"p-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none",children:[e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"ca",children:"Català"}),e.jsx("option",{value:"eu",children:"Euskara"}),e.jsx("option",{value:"gl",children:"Galego"}),e.jsx("option",{value:"pt",children:"Português"}),e.jsx("option",{value:"fr",children:"Français"}),e.jsx("option",{value:"it",children:"Italiano"}),e.jsx("option",{value:"de",children:"Deutsch"}),e.jsx("option",{value:"en",children:"English"})]})]}),e.jsxs("div",{className:"mt-6 p-4 border border-red-300 rounded-lg bg-red-50",children:[e.jsx("h4",{className:"font-semibold text-red-700 mb-2",children:o("settings.general.reset_title")}),e.jsx("p",{className:"text-sm text-red-700 mb-3",children:o("settings.general.reset_description")}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:o("settings.general.reset_button")})]})]}),a==="profiles"&&e.jsx("div",{className:"pt-4",children:e.jsx(kr,{profiles:l,setProfiles:u,activeProfileName:g,setActiveProfileName:E,onCloseSettings:s,profileOrder:w,setProfileOrder:m})}),a==="widgets"&&e.jsxs("div",{children:[e.jsxs("div",{className:"sticky top-0 z-10 -mx-4 px-4 pt-4 pb-4 bg-white/90 backdrop-blur border-b border-black/5 mb-4",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx(Ds,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:o("settings.widgets.search"),value:A,onChange:v=>O(v.target.value),ref:C,className:"w-full pl-10 pr-4 py-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:o("settings.widgets.view_label")}),e.jsxs("div",{className:"flex rounded-lg border border-gray-200 overflow-hidden bg-white/70",children:[e.jsx("button",{type:"button",onClick:()=>Q("theme"),className:`px-3 py-1.5 text-sm font-semibold transition-colors ${q==="theme"?"bg-accent text-text-dark":"text-gray-600 hover:bg-gray-100"}`,children:o("settings.widgets.view_by_theme")}),e.jsx("button",{type:"button",onClick:()=>Q("alphabetical"),className:`px-3 py-1.5 text-sm font-semibold transition-colors ${q==="alphabetical"?"bg-accent text-text-dark":"text-gray-600 hover:bg-gray-100"}`,children:o("settings.widgets.view_alphabetical")})]})]})]}),e.jsx("p",{className:"mb-4 text-sm text-gray-600",children:o("settings.widgets.pinned_info",{count:p.length,max:Ie,total:ze})}),q==="alphabetical"?e.jsx("ul",{className:"space-y-2",children:te.map(v=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:v.icon}),e.jsx("span",{className:"font-semibold",children:o(v.title)})]}),e.jsx("button",{onClick:()=>De(v.id),className:`font-semibold py-2 px-4 rounded-lg transition-colors ${p.includes(v.id)?"bg-widget-header text-text-light hover:bg-[#7b69b1]":"bg-accent text-text-dark hover:bg-[#8ec9c9]"}`,children:p.includes(v.id)?o("settings.widgets.remove"):o("settings.widgets.add")})]},v.id))}):e.jsx("div",{className:"space-y-5",children:ce.filter(v=>v.widgets.length>0).map(v=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2 uppercase tracking-wide",children:o(v.titleKey)}),e.jsx("ul",{className:"space-y-2",children:v.widgets.map(T=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:T.icon}),e.jsx("span",{className:"font-semibold",children:o(T.title)})]}),e.jsx("button",{onClick:()=>De(T.id),className:`font-semibold py-2 px-4 rounded-lg transition-colors ${p.includes(T.id)?"bg-widget-header text-text-light hover:bg-[#7b69b1]":"bg-accent text-text-dark hover:bg-[#8ec9c9]"}`,children:p.includes(T.id)?o("settings.widgets.remove"):o("settings.widgets.add")})]},T.id))})]},v.id))})]}),a==="theme"&&e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"p-4 bg-white/70 border border-gray-200 rounded-lg space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:o("settings.theme.open_modal_title")}),e.jsx("p",{className:"text-sm text-gray-600",children:o("settings.theme.open_modal_help")})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Z["--color-bg"]},"aria-hidden":"true"}),e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Z["--color-widget-bg"]},"aria-hidden":"true"}),e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Z["--color-accent"]},"aria-hidden":"true"})]}),e.jsx("button",{type:"button",onClick:()=>J(!0),className:"font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark hover:bg-[#8ec9c9] transition-colors",children:o("settings.theme.open_modal_button")})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o("settings.theme.wallpaper_title")}),e.jsx("div",{className:"mb-4 p-3 bg-white/70 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.solid_color_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.solid_color_help")})]}),e.jsx("input",{type:"color",value:Z["--color-bg"],onChange:oe,className:"theme-color-input","aria-label":o("settings.theme.solid_color_title")})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4 max-h-56 overflow-y-auto pr-1",children:at.map(v=>{const T=ds(v),G=v.urls.some(le=>Z["--wallpaper"]===`url(${le})`);return e.jsx("button",{type:"button",onClick:()=>ie(T),className:`h-20 rounded-lg border transition-all ${G?"border-accent ring-2 ring-accent":"border-gray-200 hover:border-gray-400"}`,style:{backgroundImage:`url(${v.previewUrl})`,backgroundSize:"cover",backgroundPosition:"center"},"aria-label":o("settings.theme.wallpaper_title")},v.id)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_.current?.click(),className:"flex-1 font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark hover:bg-[#8ec9c9] transition-colors",children:o("settings.theme.upload_image_button")}),e.jsx("button",{onClick:()=>ie("none"),className:"flex-1 font-semibold py-2 px-4 rounded-lg bg-gray-300 text-text-dark hover:bg-gray-400 transition-colors",children:o("settings.theme.remove_wallpaper_button")})]}),e.jsx("input",{type:"file",ref:_,onChange:W,accept:"image/*",className:"hidden"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o("settings.theme.screen_items_title")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.show_datetime_label")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.show_datetime_help")})]}),e.jsx("input",{type:"checkbox",checked:!!(Z.showDateTime??!0),onChange:V,className:"h-5 w-5"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.show_system_stats_label")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.show_system_stats_help")})]}),e.jsx("input",{type:"checkbox",checked:!!(Z.showSystemStats??!1),onChange:X,className:"h-5 w-5"})]})]})]}),e.jsx("button",{onClick:j,className:"w-full font-bold py-2 px-4 rounded-lg bg-red-500 text-white hover:bg-red-600 transition-colors mt-6",children:o("settings.theme.reset_theme_button")})]})]})]})},"settings-modal"),e.jsx(rr,{isOpen:ge,onClose:()=>J(!1)},"theme-settings-modal")]})},Nr=({isOpen:t,onClose:s})=>{const{t:i}=L();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("credits.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-sm space-y-4",children:[e.jsx("p",{dangerouslySetInnerHTML:{__html:i("credits.original_project")}}),e.jsxs("p",{children:[i("credits.original_link")," ",e.jsx("a",{href:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/"})]}),e.jsx("p",{children:e.jsxs(ks,{i18nKey:"credits.new_version",children:["Esta nueva versión fue desarrollada en colaboración por ",e.jsx("strong",{children:"María Teresa González"}),", ",e.jsx("strong",{children:"Juan José de Haro"})," y ",e.jsx("strong",{children:"Pablo G. Guízar"}),". El repositorio de este proyecto se encuentra en:",e.jsx("a",{href:"https://github.com/escritorio-digital/escritorio",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:i("credits.repository_link_text")})]})}),e.jsx("hr",{}),e.jsx("p",{dangerouslySetInnerHTML:{__html:i("credits.vibe_community")}}),e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[i("credits.vibe_apps_link_text")," ",e.jsx("a",{href:"https://vibe-coding-educativo.github.io/app_edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:i("credits.vibe_apps_repo_text")})]}),e.jsxs("li",{children:[i("credits.vibe_telegram_link_text")," ",e.jsx("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"t.me/vceduca"})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"text-center p-4 bg-gray-100 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("credits.open_knowledge_adherence")}),e.jsx("a",{href:"https://conocimiento-abierto.github.io/",target:"_blank",rel:"noopener noreferrer",className:"text-lg font-bold text-blue-600 hover:underline",children:i("credits.open_knowledge_decalogue")}),e.jsx("p",{className:"mt-4",children:e.jsx("a",{href:"https://creativecommons.org/licenses/by-sa/4.0/deed.es",target:"_blank",rel:"noopener noreferrer",className:"inline-block",title:"Creative Commons Attribution-ShareAlike 4.0 International License",children:e.jsx("img",{src:"https://i.creativecommons.org/l/by-sa/4.0/88x31.png",alt:"Licencia Creative Commons BY-SA 4.0"})})})]})]})]})}):null},Sr=({isOpen:t,onClose:s})=>{const{t:i}=L();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("about.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-sm space-y-5",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:i("about.app_name_label")}),e.jsx("p",{className:"font-semibold",children:i("about.app_name_value")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:i("about.version_label")}),e.jsx("p",{className:"font-semibold",children:i("about.version_value")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold mb-2",children:i("about.history_title")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.initial_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.initial_text")}),e.jsxs("p",{className:"text-sm mt-2",children:[i("about.original_app_label")," ",e.jsxs("a",{href:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["mtgonzalezm.github.io/escritorio-interactivo-aula ",e.jsx(gt,{size:14})]})]})]}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.development_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.development_text")})]}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.continuity_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.continuity_text")})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold mb-2",children:i("about.community_title")}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-700",children:i("about.community_text")}),e.jsxs("p",{className:"text-sm",children:[i("about.community_repo_label")," ",e.jsxs("a",{href:"https://vibe-coding-educativo.github.io/app_edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["vibe-coding-educativo.github.io/app_edu ",e.jsx(gt,{size:14})]})]}),e.jsxs("p",{className:"text-sm",children:[i("about.community_telegram_label")," ",e.jsxs("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["t.me/vceduca ",e.jsx(gt,{size:14})]})]})]})]})]})]})}):null},Kt={organization:{Icon:qs,className:"bg-emerald-100 text-emerald-700"},time:{Icon:Ks,className:"bg-blue-100 text-blue-700"},math_science:{Icon:Hs,className:"bg-teal-100 text-teal-700"},board_writing:{Icon:Vs,className:"bg-amber-100 text-amber-700"},resources:{Icon:Bs,className:"bg-amber-100 text-amber-700"},interaction:{Icon:ct,className:"bg-rose-100 text-rose-700"},participation:{Icon:Rs,className:"bg-indigo-100 text-indigo-700"},logic_games:{Icon:As,className:"bg-purple-100 text-purple-700"},gestures:{Icon:$s,className:"bg-orange-100 text-orange-700"},community:{Icon:Ps,className:"bg-sky-100 text-sky-700"},other:{Icon:Fs,className:"bg-gray-100 text-gray-700"}},qt=20,Ir=({isOpen:t,onClose:s,onAddWidget:i,onOpenSettingsTab:c,onOpenThemeModal:p,onOpenAbout:x,onOpenCredits:l,onRemoveFavorite:u,onReorderFavorites:g,onClearFavorites:E,onAddFavorite:w,pinnedWidgets:m,anchorRect:o,anchorRef:I})=>{const{t:a,i18n:S}=L(),A=f=>f.startTooltip?a(f.startTooltip):a(f.title),O=r.useRef(null),q=r.useRef(null),Q=r.useRef(null),ge=r.useRef(null),J=r.useRef(null),[ue,Z]=r.useState(""),[M,ie]=r.useState(null),[j,_]=r.useState("widgets"),[C,W]=r.useState(null),[V,X]=r.useState({isOpen:!1,x:0,y:0,widgetId:null}),[oe,ee]=r.useState(!1),[te,ce]=r.useState(null),[Ie,ze]=r.useState(null),De=r.useRef(null),H=r.useCallback(f=>f.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),[]),N=r.useMemo(()=>Object.values(Se),[]),v=H(ue.trim()),T=v.length>0,G=r.useMemo(()=>v?N.filter(f=>{const D=H(a(f.title)),P=f.startTooltip?H(a(f.startTooltip)):"",U=(f.searchKeywords||[]).flatMap(K=>a(K).split(",")).map(K=>H(K.trim())).filter(Boolean).some(K=>K.includes(v));return D.includes(v)||P.includes(v)||U}):N,[H,v,a,N]),le=r.useMemo(()=>cs(G,a),[G,a]),re=r.useMemo(()=>m.filter(f=>Se[f]),[m]),ve=r.useMemo(()=>re.map(f=>Se[f]).filter(Boolean),[re]),se=r.useMemo(()=>new Set(re),[re]),Ee=r.useMemo(()=>le.filter(f=>f.widgets.length>0),[le]);r.useEffect(()=>{if(!t)return;Z(""),_("widgets");const f=o?{left:Math.round(o.left),bottom:Math.round(window.innerHeight-o.top+4)}:{left:16,bottom:96};ie(f);const D=requestAnimationFrame(()=>{Q.current?.focus()});return()=>cancelAnimationFrame(D)},[o,t]),r.useEffect(()=>{if(!t)return;const f=window.setTimeout(()=>{Q.current?.focus(),Q.current?.select()},0);return()=>window.clearTimeout(f)},[t]),r.useEffect(()=>{t||(X({isOpen:!1,x:0,y:0,widgetId:null}),ee(!1))},[t]),r.useEffect(()=>{if(Ee.length===0){W(null);return}(!C||!Ee.some(f=>f.id===C))&&W(Ee[0].id)},[C,Ee]),r.useEffect(()=>{if(!t)return;const f=P=>{O.current&&O.current.contains(P.target)||I?.current&&I.current.contains(P.target)||s()},D=P=>{P.key==="Escape"&&s()};return window.addEventListener("mousedown",f),window.addEventListener("keydown",D),()=>{window.removeEventListener("mousedown",f),window.removeEventListener("keydown",D)}},[I,t,s]),r.useEffect(()=>{if(!V.isOpen)return;const f=()=>{const K=O.current,he=ge.current;if(!K||!he)return;const h=8,k=Math.max(h,K.clientWidth-he.offsetWidth-h),z=Math.max(h,K.clientHeight-he.offsetHeight-h);let R=Math.min(Math.max(V.x,h),k),B=Math.min(Math.max(V.y,h),z);(R!==V.x||B!==V.y)&&X(ne=>({...ne,x:R,y:B}))},D=K=>{O.current&&O.current.contains(K.target)&&K.target.closest('[data-favorite-menu="true"]')||X({isOpen:!1,x:0,y:0,widgetId:null})},P=K=>{K.key==="Escape"&&X({isOpen:!1,x:0,y:0,widgetId:null})},U=requestAnimationFrame(f);return window.addEventListener("mousedown",D),window.addEventListener("keydown",P),()=>{cancelAnimationFrame(U),window.removeEventListener("mousedown",D),window.removeEventListener("keydown",P)}},[V.isOpen]),r.useEffect(()=>{if(!oe)return;const f=P=>{J.current&&J.current.contains(P.target)||ee(!1)},D=P=>{P.key==="Escape"&&ee(!1)};return window.addEventListener("mousedown",f),window.addEventListener("keydown",D),()=>{window.removeEventListener("mousedown",f),window.removeEventListener("keydown",D)}},[oe]),r.useEffect(()=>{if(!t||!M)return;const f=O.current;if(!f)return;const D=f.getBoundingClientRect(),P=8;let U=M.left,K=M.bottom;D.left<P&&(U+=P-D.left),D.right>window.innerWidth-P&&(U-=D.right-(window.innerWidth-P)),D.top<P&&(K-=P-D.top),D.bottom>window.innerHeight-P&&(K+=D.bottom-(window.innerHeight-P)),(U!==M.left||K!==M.bottom)&&ie({left:U,bottom:K})},[t,M]);const me=r.useCallback(()=>{if(!t||!M)return;const f=O.current?.querySelector('[data-start-menu-header="true"]'),D=O.current?.querySelector('[data-start-menu-search="true"]'),P=q.current;if(!f||!D||!P)return;const U=24,K=f.getBoundingClientRect().height,he=D.getBoundingClientRect().height,h=Math.floor(window.innerHeight*.72),k=Math.max(0,h-K-he-U),z=P.scrollHeight,R=Math.min(k,220),B=Math.min(k,Math.max(z,R));let ne=B;T?ne=De.current??B:De.current=B,ce(ne),ze(K+he+U+ne)},[t,M,T]);r.useLayoutEffect(()=>{if(!(!t||!M))return me(),window.addEventListener("resize",me),()=>{window.removeEventListener("resize",me)}},[t,M,me]),r.useEffect(()=>{if(!t)return;const f=requestAnimationFrame(me);return()=>{cancelAnimationFrame(f)}},[t,me]),r.useEffect(()=>{t&&me()},[t,T,me]);const Ae=Jt(rt(ss,{activationConstraint:{distance:6}}),rt(ts,{coordinateGetter:os})),Be=f=>{const{active:D,over:P}=f;if(!P||D.id===P.id)return;const U=re.indexOf(String(D.id)),K=re.indexOf(String(P.id));if(U===-1||K===-1)return;const he=is(re,U,K),h=m.filter(k=>!Se[k]);g([...he,...h])},Ue=({widgetId:f})=>{const D=Se[f],{attributes:P,listeners:U,setNodeRef:K,transform:he,transition:h,isDragging:k}=rs({id:f});if(!D)return null;const z={transform:as.Transform.toString(he),transition:h};return e.jsxs("button",{ref:K,style:z,onClick:()=>Te(D.id),onContextMenu:R=>{R.preventDefault(),R.stopPropagation();const B=O.current?.getBoundingClientRect(),ne=B?R.clientX-B.left:R.clientX,ye=B?R.clientY-B.top:R.clientY;X({isOpen:!0,x:ne,y:ye,widgetId:D.id})},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm min-w-0 ${k?"opacity-70":""}`,title:A(D),children:[e.jsx("span",{className:"text-2xl",children:D.icon}),e.jsx("span",{className:"flex-1 min-w-0 text-sm font-semibold text-text-dark leading-tight truncate",children:a(D.title)}),e.jsx("span",{...P,...U,onClick:R=>R.stopPropagation(),className:"text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",title:a("start_menu.reorder_favorites"),children:e.jsx(Xs,{size:16})})]})};if(!t||!M)return null;const Te=f=>{i(f),s()},_e=f=>{c(f),s()},Ye=f=>{if(f.key!=="Enter")return;const D=G[0];D&&Te(D.id)},ke=C&&Ee.find(f=>f.id===C)||null,Ve=(f,D=!0)=>e.jsx("div",{className:"space-y-1",children:f.map(P=>e.jsxs("button",{onClick:()=>Te(P.id),onContextMenu:U=>{U.preventDefault(),U.stopPropagation();const K=O.current?.getBoundingClientRect(),he=K?U.clientX-K.left:U.clientX,h=K?U.clientY-K.top:U.clientY;X({isOpen:!0,x:he,y:h,widgetId:P.id})},className:`w-full flex items-center gap-3 px-3 py-[0.45rem] rounded-lg border transition text-left shadow-sm min-w-0 ${D&&se.has(P.id)?"bg-amber-50 border-amber-300":"bg-white/90 hover:bg-amber-50 border-gray-200"}`,title:A(P),children:[e.jsx("span",{className:"text-2xl",children:P.icon}),e.jsx("span",{className:"flex-1 min-w-0 text-sm font-semibold text-text-dark leading-tight truncate",children:a(P.title)}),D&&se.has(P.id)&&e.jsx(Mt,{size:14,className:"text-amber-500"})]},P.id))});return e.jsxs("div",{ref:O,className:"fixed z-[10001] w-[min(34rem,calc(100vw-1rem))] max-h-[72vh] bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200 flex flex-col overflow-hidden",style:{left:M.left,bottom:M.bottom,height:Ie?`${Ie}px`:void 0},onContextMenu:f=>{f.preventDefault(),f.stopPropagation()},children:[e.jsxs("div",{"data-start-menu-header":"true",className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-white to-amber-50/70 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:$("escritorio-digital.png"),alt:a("toolbar.start"),width:"22",height:"22"}),e.jsx("h3",{className:"text-base font-semibold text-text-dark",children:a("start_menu.title")})]}),e.jsxs("div",{className:"relative flex items-center gap-2 text-gray-600",children:[e.jsx("button",{type:"button",onClick:()=>{_("favorites")},className:`p-2 rounded-full border transition ${j==="favorites"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("start_menu.favorites"),"aria-label":a("start_menu.favorites"),children:e.jsx(Mt,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{_("shortcuts")},className:`p-2 rounded-full border transition ${j==="shortcuts"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("context_menu.settings"),"aria-label":a("context_menu.settings"),children:e.jsx(xt,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{ee(f=>!f)},className:"p-2 rounded-full border bg-white/80 border-gray-200 hover:bg-amber-50 transition",title:a("start_menu.language_label"),"aria-label":a("start_menu.language_label"),children:e.jsx(Ts,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{_("help")},className:`p-2 rounded-full border transition ${j==="help"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("start_menu.help"),"aria-label":a("start_menu.help"),children:e.jsx(Ls,{size:16})}),oe&&e.jsx("div",{ref:J,className:"absolute right-0 top-10 z-[10003] min-w-[160px] rounded-lg border border-gray-200 bg-white/95 shadow-xl p-1 text-sm text-text-dark",children:[{id:"es",label:"Español"},{id:"ca",label:"Català"},{id:"eu",label:"Euskara"},{id:"gl",label:"Galego"},{id:"pt",label:"Português"},{id:"fr",label:"Français"},{id:"it",label:"Italiano"},{id:"de",label:"Deutsch"},{id:"en",label:"English"}].map(f=>e.jsx("button",{onClick:()=>{S.changeLanguage(f.id),ee(!1)},className:`w-full text-left px-3 py-2 rounded-md hover:bg-gray-100 transition ${S.language===f.id?"bg-amber-50 text-amber-800":""}`,children:f.label},f.id))})]})]}),e.jsx("div",{"data-start-menu-search":"true",className:"px-4 py-3 border-b border-gray-200 bg-white/70",children:e.jsx("div",{className:"relative",children:e.jsx("input",{ref:Q,autoFocus:!0,type:"text",placeholder:a("settings.widgets.search"),value:ue,onChange:f=>Z(f.target.value),onKeyDown:Ye,className:"w-full pl-3 pr-4 py-2 border rounded-lg bg-white/90 focus:ring-2 focus:ring-accent focus:outline-none"})})}),e.jsx("div",{className:"flex-1 overflow-hidden px-4 py-3 bg-gradient-to-b from-white to-gray-50",children:e.jsxs("div",{className:"flex items-start gap-4 h-full",children:[e.jsx("div",{ref:q,className:"w-52 shrink-0 flex flex-col gap-4 min-h-0",children:e.jsx("div",{className:"pr-1",style:{maxHeight:te?`${te}px`:void 0,overflowY:"auto"},children:e.jsx("div",{className:"space-y-1",children:Ee.map(f=>{const D=Kt[f.id]??Kt.other;return e.jsxs("button",{onClick:()=>{_("widgets"),W(f.id)},className:`w-full text-left px-3 py-2 rounded-lg text-[0.8125rem] font-semibold border transition flex items-center gap-2 ${C===f.id&&j==="widgets"?"bg-accent text-text-dark border-transparent":"bg-white/90 hover:bg-amber-50 border-gray-200"}`,children:[e.jsx("span",{className:`h-5 w-5 rounded-md flex items-center justify-center ${D.className}`,children:e.jsx(D.Icon,{size:12})}),e.jsx("span",{className:"leading-tight",children:a(f.titleKey)}),e.jsx("span",{className:"ml-auto text-[0.625rem] font-semibold text-gray-600",children:f.widgets.length})]},f.id)})})})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1 h-full",style:te?{maxHeight:`${te}px`}:void 0,children:[j==="favorites"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("start_menu.favorites")}),ve.length>0&&e.jsx("button",{className:"text-xs font-semibold text-red-600 hover:text-red-700",onClick:()=>{window.confirm(a("start_menu.clear_favorites_confirm"))&&E()},children:a("start_menu.clear_favorites")})]}),ve.length>0?e.jsx(Zt,{sensors:Ae,collisionDetection:es,onDragStart:()=>{X({isOpen:!1,x:0,y:0,widgetId:null})},onDragEnd:Be,children:e.jsx(ns,{items:re,strategy:nn,children:e.jsx("div",{className:"space-y-1",children:re.map(f=>e.jsx(Ue,{widgetId:f},f))})})}):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")})]}),j==="shortcuts"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("context_menu.settings")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>_e("general"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Gs,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.settings")})]}),e.jsxs("button",{onClick:()=>_e("profiles"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.manage_profiles")})]}),e.jsxs("button",{onClick:()=>{p(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(xt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("start_menu.theme_accessibility")})]}),e.jsxs("button",{onClick:()=>_e("theme"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Qt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.change_background")})]}),e.jsxs("button",{onClick:()=>_e("widgets"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Xt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("toolbar.widgetLibrary")})]})]})]}),j==="help"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("start_menu.help")}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>{Te("program-guide")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Yt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.guide")})]}),e.jsxs("button",{onClick:()=>{x(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Us,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.about")})]}),e.jsxs("button",{onClick:()=>{l(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Ys,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.licenses")})]})]})]}),j==="widgets"&&e.jsx("div",{className:"space-y-3",children:T?G.length>0?Ve(G,!0):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")}):ke?.widgets.length?Ve(ke.widgets,!0):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")})})]})]})}),V.isOpen&&V.widgetId&&e.jsx("div",{"data-favorite-menu":"true",ref:ge,className:"absolute z-[10002] min-w-[180px] bg-white/95 backdrop-blur-md rounded-lg shadow-xl border border-gray-200 py-2 text-sm text-text-dark",style:{left:V.x,top:V.y},children:e.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{const f=V.widgetId;se.has(f)?u(f):re.length<qt?w(f):alert(a("settings.widgets.max_widgets_alert",{max:qt})),X({isOpen:!1,x:0,y:0,widgetId:null})},children:se.has(V.widgetId)?a("start_menu.remove_favorite"):a("start_menu.add_favorite")})})]})},zr=({profiles:t,activeProfileName:s,setActiveProfileName:i,onManageProfiles:c,onOpenContextMenu:p,setProfiles:x,profileOrder:l})=>{const[u,g]=r.useState(!1),[E,w]=r.useState(!1),[m,o]=r.useState("export"),[I]=r.useState(!0),[a,S]=r.useState(!0),[A,O]=r.useState(!0),[q,Q]=r.useState(!1),[ge,J]=r.useState(!1),[ue,Z]=r.useState(!1),[M,ie]=r.useState([]),[j,_]=r.useState("replace"),[C,W]=r.useState(""),[V,X]=r.useState(""),[oe,ee]=r.useState(!1),[te,ce]=r.useState(!1),[Ie,ze]=r.useState(""),[De,H]=r.useState(""),{t:N}=L(),v=r.useMemo(()=>{const h=Object.keys(t),k=l.filter(z=>h.includes(z));return h.forEach(z=>{k.includes(z)||k.push(z)}),k},[t,l]),T=I&&M.length>0&&M.length<v.length,G=(ge||ue)&&M.length>0,le=r.useRef(null),re=r.useRef(null),ve=r.useRef(0),se=r.useRef(null),Ee="Escritorio Principal";r.useEffect(()=>{const h=k=>{const z=k.detail;o(z?.tab??"export"),w(!0),g(!1)};return window.addEventListener("open-profile-backup",h),()=>window.removeEventListener("open-profile-backup",h)},[]);const me=h=>h===Ee?N("settings.profiles.default_name"):h,Ae=h=>{i(h),g(!1)},Be=()=>{c(),g(!1)};r.useEffect(()=>{if(!u&&!E)return;const h=k=>{le.current&&(le.current.contains(k.target)||(g(!1),w(!1)))};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[u,E]),r.useEffect(()=>{if(!E)return;ie(k=>k.length===v.length&&k.every(z=>v.includes(z))?k:v),W(""),X(""),o("export"),_("replace");const h=tt.some(k=>!!window.localStorage.getItem(k));Q(h),S(h),ht().then(k=>{const z=k.siteCount>0;J(z),z||O(!1)}).catch(()=>{J(!1),O(!1)})},[E,v,s]),r.useEffect(()=>{E&&M.length!==0&&ht(M).then(h=>{const k=h.siteCount>0;Z(k),k||O(!1)}).catch(()=>{Z(!1),O(!1)})},[E,M,s]),r.useEffect(()=>{T&&a&&S(!1)},[T,a]),r.useEffect(()=>{G||A&&O(!1)},[G,A]);const Ue=h=>{ie(k=>k.includes(h)?k.filter(z=>z!==h):[...k,h])},Te=h=>{const k=new Blob([h],{type:"application/zip"}),z=URL.createObjectURL(k),R=document.createElement("a");R.href=z,R.download=`escritorio-digital-backup-${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(R),R.click(),R.remove(),URL.revokeObjectURL(z)},_e=()=>{ce(!1),ze(""),H("")},Ye=h=>{if(!Number.isFinite(h))return"0 B";if(h<1024)return`${h} B`;const k=h/1024;if(k<1024)return`${k.toFixed(1)} KB`;const z=k/1024;return z<1024?`${z.toFixed(1)} MB`:`${(z/1024).toFixed(2)} GB`},ke=async()=>{const h={};if(I&&M.length>0){const k={};M.forEach(z=>{t[z]&&(k[z]=t[z])}),h.profiles=k,h.activeProfileName=k[s]?s:M[0]}return a&&q&&!T&&(h.widgetData=await fr(tt)),bs(h)},Ve=(h,k)=>{const z={...h},R=new Map;return Object.entries(k).forEach(([B,ne])=>{let ye=B;if(z[ye]){let fe=2;for(;z[`${B} (${fe})`];)fe+=1;ye=`${B} (${fe})`}z[ye]=ne,R.set(B,ye)}),{updated:z,nameMap:R}},f=async()=>{let h=0;for(const k of tt){const z=window.localStorage.getItem(k);if(z)if(z==="__indexed_db__"){const R=await ms(k);R&&(h+=new Blob([R]).size)}else h+=new Blob([z]).size}return h},D=async()=>{let h=0;if(I&&M.length>0){const k={};M.forEach(R=>{t[R]&&(k[R]=t[R])});const z={profiles:k,activeProfileName:k[s]?s:M[0]};h+=new Blob([JSON.stringify(z)]).size}if(a&&q&&!T&&(h+=await f()),A){const k=await ht(M);k.siteCount>0&&(h+=Math.ceil(k.totalBytes*1.1))}return h};r.useEffect(()=>{if(!E)return;ve.current+=1;const h=ve.current;(async()=>{if(I&&M.length===0){X(N("backup.size_unknown")),ee(!1);return}ee(!0);try{const z=await D();if(ve.current!==h)return;X(N("backup.size_label",{size:Ye(z)}))}catch{ve.current===h&&X(N("backup.size_unknown"))}finally{ve.current===h&&ee(!1)}})()},[E,I,a,A,M,q,ge,t,s,N]);const P=async()=>{if(I&&M.length===0){W(N("backup.no_profiles"));return}W(N("backup.exporting")),w(!1),ce(!0),ze(N("backup.progress_export_title")),H(N("backup.progress_preparing")),se.current?.abort();const h=new AbortController;se.current=h;try{const k=await ke(),z=M.includes(s)?s:M[0],R=A?await pr(M,z):void 0;let B=0,ne=0;const ye=await yr(k.data,R,(fe,de)=>{const be=performance.now();be-B>200&&(H(`${fe}/${de}`),B=be)},async()=>{ne+=1,ne%5===0&&await new Promise(fe=>requestAnimationFrame(()=>fe()))},h.signal);if(h.signal.aborted)return;Te(ye),W(N("backup.export_ready"))}catch(k){h.signal.aborted||(console.error(k),W(N("backup.invalid_file")))}finally{h.signal.aborted||_e()}},U=()=>{w(!1),re.current?.click()},K=async h=>{const k=h.target.files?.[0];if(k)try{W(N("backup.importing")),ce(!0),ze(N("backup.progress_import_title")),H(N("backup.progress_preparing")),se.current?.abort();const z=new AbortController;se.current=z;const R=await k.arrayBuffer();let B,ne;if(_r(R)||k.name.toLowerCase().endsWith(".zip")){const de=jr(R);B=de.payload,ne=de.localWeb}else{const de=new TextDecoder().decode(R);if(B=JSON.parse(de),!ps(B)){W(N("backup.invalid_file")),_e();return}}if(!B?.data){W(N("backup.invalid_file")),_e();return}if(z.signal.aborted)return;let ye,fe=B.data.activeProfileName||s;if(B.data.profiles)if(j==="replace"){const de=B.data.profiles,be=Object.keys(de);if(be.length>0){x(de);const pe=B.data.activeProfileName,We=pe&&de[pe]?pe:be[0];i(We),fe=We}}else x(de=>{const be=Ve(de,B.data.profiles||{});ye=be.nameMap;const pe=B.data.activeProfileName;if(pe){const We=be.nameMap.get(pe);We?(i(We),fe=We):be.updated[pe]&&(i(pe),fe=pe)}return be.updated});if(B.data.widgetData&&await br(B.data.widgetData),B.data.localWeb||ne){if(j==="replace"&&await fs(),ne){let de=0,be=0;await wr(ne,{signal:z.signal,onProgress:(pe,We)=>{const Xe=performance.now();Xe-de>200&&(H(`${pe}/${We}`),de=Xe)},yieldControl:async()=>{be+=1,be%5===0&&await new Promise(pe=>requestAnimationFrame(()=>pe()))},profileNameMap:ye,fallbackProfileName:fe})}else B.data.localWeb&&await xr(B.data.localWeb,{profileNameMap:ye,fallbackProfileName:fe});window.dispatchEvent(new Event("local-web-data-changed"))}W(N("backup.import_done")),z.signal.aborted||_e(),window.location.reload()}catch(z){se.current?.signal.aborted?W(""):(console.error(z),W(N("backup.invalid_file"))),_e()}finally{h.target.value=""}},he=()=>{se.current?.abort(),_e(),W("")};return e.jsx("div",{className:"fixed bottom-4 right-4 z-[9999]",ref:le,onContextMenu:p,children:e.jsxs("div",{className:"relative",children:[u&&e.jsxs("div",{className:"absolute bottom-full mb-2 w-56 bg-white/80 backdrop-blur-md rounded-lg shadow-lg border border-black/10 text-sm",children:[e.jsx("ul",{className:"p-1",children:v.map(h=>e.jsx("li",{children:e.jsx("button",{onClick:()=>Ae(h),className:`w-full text-left px-3 py-2 rounded-md transition-colors ${h===s?"font-semibold bg-accent/30 text-text-dark":"hover:bg-accent hover:text-text-dark"}`,children:me(h)})},h))}),e.jsxs("div",{className:"border-t border-black/10 p-1 space-y-1",children:[e.jsxs("button",{onClick:Be,className:"w-full text-left px-3 py-2 rounded-md hover:bg-accent hover:text-text-dark transition-colors flex items-center gap-2",children:[e.jsx(ct,{size:16}),N("settings.profiles.manage_button")]}),e.jsxs("button",{onClick:()=>{w(!0),g(!1)},className:"w-full text-left px-3 py-2 rounded-md hover:bg-accent hover:text-text-dark transition-colors flex items-center gap-2",children:[e.jsx(Ot,{size:16}),N("backup.manage_profiles")]})]})]}),e.jsxs("button",{onClick:()=>g(!u),onContextMenu:p,className:"w-56 h-12 px-4 bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40 transition-colors flex items-center justify-between",title:N("settings.profiles.switcher_title"),children:[e.jsx("span",{className:"font-semibold",children:me(s)}),u?e.jsx(Qs,{size:20}):e.jsx(Js,{size:20})]}),E&&e.jsx("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"w-full max-w-xl bg-white/90 backdrop-blur-md rounded-xl shadow-2xl border border-black/10 p-5 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"font-semibold text-lg",children:N("backup.manage_profiles")}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-600 hover:text-gray-800",children:"✕"})]}),e.jsxs("div",{className:"flex border-b border-gray-300 mb-5",children:[e.jsx("button",{onClick:()=>o("export"),className:`-mb-px px-4 py-2 text-sm font-semibold rounded-t-md border transition-colors ${m==="export"?"bg-accent text-text-dark border-accent border-b-white shadow-sm":"bg-gray-100 text-gray-600 border-transparent hover:text-text-dark"}`,children:N("backup.tab_export")}),e.jsx("button",{onClick:()=>o("import"),className:`-mb-px ml-1 px-4 py-2 text-sm font-semibold rounded-t-md border transition-colors ${m==="import"?"bg-accent text-text-dark border-accent border-b-white shadow-sm":"bg-gray-100 text-gray-600 border-transparent hover:text-text-dark"}`,children:N("backup.tab_import")})]}),m==="export"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:N("backup.choose_profiles")}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-auto border border-gray-200 rounded-lg p-2 bg-white/60",children:v.map(h=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:M.includes(h),onChange:()=>Ue(h)}),e.jsx("span",{children:me(h)})]},h))}),e.jsx("div",{className:"text-xs text-gray-500",children:N("backup.include_profiles")}),q&&e.jsxs("label",{className:`flex items-center gap-2 ${T?"opacity-50":""}`,children:[e.jsx("input",{type:"checkbox",checked:a,onChange:h=>S(h.target.checked),disabled:T}),e.jsx("span",{children:N("backup.include_widgets")})]}),e.jsxs("label",{className:`flex items-center gap-2 ${G?"":"opacity-50"}`,children:[e.jsx("input",{type:"checkbox",checked:A,onChange:h=>O(h.target.checked),disabled:!G}),e.jsx("span",{children:N("backup.include_local_web")})]})]}),e.jsx("div",{className:"mt-3 text-sm text-gray-700 font-semibold",children:oe?N("backup.size_estimating"):V||N("backup.size_unknown")}),C&&e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:C}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:P,className:"w-full py-2 rounded-md bg-accent text-text-dark font-semibold hover:bg-[#8ec9c9] transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ot,{size:16}),N("backup.export_button")]})})]}),m==="import"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:N("backup.import_mode_label")}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"import-mode",value:"replace",checked:j==="replace",onChange:()=>_("replace")}),e.jsx("span",{children:N("backup.import_mode_replace")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"import-mode",value:"merge",checked:j==="merge",onChange:()=>_("merge")}),e.jsx("span",{children:N("backup.import_mode_merge")})]})]}),C&&e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:C}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:U,className:"w-full py-2 rounded-md border border-gray-200 bg-white hover:bg-gray-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Zs,{size:16}),N("backup.import_button")]})}),e.jsx("p",{className:"mt-3 text-[11px] text-gray-500",children:N("backup.import_note")})]})]})}),te&&e.jsx("div",{className:"fixed inset-0 z-[10002] flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"w-full max-w-sm bg-white/95 backdrop-blur-md rounded-xl shadow-2xl border border-black/10 p-5 text-sm",children:[e.jsx("div",{className:"font-semibold text-lg mb-2",children:Ie}),e.jsx("div",{className:"text-sm text-gray-700 mb-4",children:De}),e.jsx("button",{onClick:he,className:"w-full py-2 rounded-md border border-gray-200 bg-white hover:bg-gray-100 transition-colors font-semibold",children:N("backup.progress_cancel")})]})}),e.jsx("input",{ref:re,type:"file",accept:"application/json,application/zip,.zip",className:"hidden",onChange:K})]})})},Er=({profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,profileOrder:p,setProfileOrder:x})=>{const{t:l,i18n:u}=L(),g=t[i]||Object.values(t)[0],E=g.theme?.showDateTime??!0,w=g.theme?.showSystemStats??!1,m=r.useCallback(n=>{s(d=>{const b=d[i]||g;if(!b)return d;const y=typeof n=="function"?n(b.activeWidgets):n;return y===b.activeWidgets?d:{...d,[i]:{...b,activeWidgets:y}}})},[g,i,s]),o=r.useCallback(n=>{s(d=>{const b=d[i]||g;if(!b)return d;const y=typeof n=="function"?n(b.pinnedWidgets):n;return y===b.pinnedWidgets?d:{...d,[i]:{...b,pinnedWidgets:y}}})},[g,i,s]),I=r.useCallback(()=>{const n=!E,d={...g,theme:{...g.theme,showDateTime:n}};s(b=>({...b,[i]:d}))},[g,i,s,E]),a=r.useCallback(()=>{const n=!w,d={...g,theme:{...g.theme,showSystemStats:n}};s(b=>({...b,[i]:d}))},[g,i,s,w]),[S,A]=r.useState(100),O=r.useRef(100);r.useEffect(()=>{const n=g.activeWidgets.reduce((d,b)=>b.zIndex>d?b.zIndex:d,100);A(d=>d<n?n:d)},[g.activeWidgets]),r.useEffect(()=>{O.current=S},[S]);const[q,Q]=r.useState(null),[ge,J]=r.useState(!1),[ue,Z]=r.useState(!1),[M,ie]=r.useState(!1),[j,_]=r.useState(0),C=r.useRef(null),[W,V]=r.useState(!1),[X,oe]=r.useState(null),[ee,te]=r.useState("general"),[ce,Ie]=et("toolbar-hidden",!1),[ze,De]=r.useState(!1),[H,N]=r.useState({isOpen:!1,x:0,y:0,widgetId:null,windowInstanceId:null}),v=r.useRef(null),[T,G]=r.useState(!1),[le,re]=r.useState(!!document.fullscreenElement);r.useEffect(()=>{if(g.activeWidgets.length===0){Q(null);return}if(!q||!g.activeWidgets.some(n=>n.instanceId===q)){const n=g.activeWidgets.reduce((d,b)=>d?b.zIndex>d.zIndex?b:d:b,null);Q(n?n.instanceId:null)}},[g.activeWidgets,q]),r.useEffect(()=>{const n=Object.keys(t);x(d=>{const b=d.filter(y=>n.includes(y));return n.forEach(y=>{b.includes(y)||b.push(y)}),b.length===d.length&&b.every((y,Y)=>y===d[Y])?d:b})},[t,x]);const ve=()=>{const d=Math.max(200,window.innerWidth-32),b=Math.max(150,window.innerHeight-32);return{margin:16,maxWidth:d,maxHeight:b}},se=n=>{if(n.isMaximized)return n;const{margin:d,maxWidth:b,maxHeight:y}=ve(),Y=(Fe,Pe)=>{if(typeof Fe=="number")return Fe;const Ne=Fe.trim();if(Ne.endsWith("vw")){const Je=Number.parseFloat(Ne);return Number.isFinite(Je)?window.innerWidth*Je/100:Pe}if(Ne.endsWith("vh")){const Je=Number.parseFloat(Ne);return Number.isFinite(Je)?window.innerHeight*Je/100:Pe}const Wt=Number.parseFloat(Ne);return Number.isFinite(Wt)?Wt:Pe},ae=Math.min(Y(n.size.width,b),b),je=Math.min(Y(n.size.height,y),y),Ce=Math.max(d,window.innerWidth-ae-d),Oe=Math.max(d,window.innerHeight-je-d),Re=Math.min(Math.max(n.position.x,d),Ce),qe=Math.min(Math.max(n.position.y,d),Oe);return{...n,size:{width:ae,height:je},position:{x:Re,y:qe}}},Ee=n=>{const d=Se[n];if(!d)return;const b=S+1;A(b);const{margin:y,maxWidth:Y,maxHeight:ae}=ve(),je=typeof d.defaultSize.width=="number"?Math.min(d.defaultSize.width,Y):d.defaultSize.width,Ce=typeof d.defaultSize.height=="number"?Math.min(d.defaultSize.height,ae):d.defaultSize.height,Oe=typeof je=="number"?je:Y,Re=typeof Ce=="number"?Ce:ae,qe=Math.max(y,window.innerWidth-Oe-y),Fe=Math.max(y,window.innerHeight-Re-y),Pe={instanceId:`${n}-${Date.now()}`,widgetId:n,position:{x:Math.max(y,Math.random()*qe),y:Math.max(y,Math.random()*Fe)},size:{width:je,height:Ce},zIndex:b};m(Ne=>[...Ne,Pe]),Q(Pe.instanceId)},me=n=>m(d=>{const b=d.filter(y=>y.instanceId!==n);if(q===n){const y=b.reduce((Y,ae)=>Y?ae.zIndex>Y.zIndex?ae:Y:ae,null);Q(y?y.instanceId:null)}return b}),Ae=r.useCallback(n=>{const d=O.current+1;O.current=d,A(d),m(b=>b.map(y=>y.instanceId===n?{...y,zIndex:d}:y)),Q(n)},[m]),Be=n=>m(d=>d.map(b=>b.instanceId===n?{...b,isMinimized:!b.isMinimized}:b)),Ue=r.useCallback(n=>{const d=g.activeWidgets.find(b=>b.instanceId===n);if(d){if(d.isMinimized){const b=S+1;A(b),m(y=>y.map(Y=>Y.instanceId===n?{...Y,isMinimized:!1,zIndex:b}:Y)),Q(n);return}if(q!==n){Ae(n);return}m(b=>b.map(y=>y.instanceId===n?{...y,isMinimized:!0}:y))}},[g.activeWidgets,q,Ae,S,m,A]),Te=r.useCallback(()=>{m(n=>n.map(d=>({...d,isMinimized:!0})))},[m]),_e=n=>{const d=S+1;A(d),m(b=>b.map(y=>y.instanceId===n?y.isMaximized?{...y,isMaximized:!1,position:y.previousPosition||{x:100,y:100},size:y.previousSize||{width:500,height:400},zIndex:d}:{...y,isMaximized:!0,isMinimized:!1,previousPosition:y.position,previousSize:y.size,position:{x:0,y:0},size:{width:"100vw",height:"100vh"},zIndex:d}:y))};r.useEffect(()=>{if(!H.isOpen)return;const n=y=>{v.current&&v.current.contains(y.target)||N(Y=>({...Y,isOpen:!1}))},d=()=>{N(y=>({...y,isOpen:!1}))},b=y=>{y.key==="Escape"&&N(Y=>({...Y,isOpen:!1}))};return window.addEventListener("mousedown",n),window.addEventListener("keydown",b),window.addEventListener("resize",d),()=>{window.removeEventListener("mousedown",n),window.removeEventListener("keydown",b),window.removeEventListener("resize",d)}},[H.isOpen]),r.useEffect(()=>{if(!H.isOpen)return;const d=requestAnimationFrame(()=>{const b=v.current;if(!b)return;const y=b.getBoundingClientRect(),Y=8,ae=Math.max(Y,window.innerWidth-y.width-Y),je=Math.max(Y,window.innerHeight-y.height-Y),Ce=Math.min(Math.max(H.x,Y),ae),Oe=Math.min(Math.max(H.y,Y),je);(Ce!==H.x||Oe!==H.y)&&N(Re=>({...Re,x:Ce,y:Oe}))});return()=>cancelAnimationFrame(d)},[H.isOpen,H.x,H.y]),r.useEffect(()=>{const n=()=>{G(!0)};return window.addEventListener("storage-quota-exceeded",n),()=>window.removeEventListener("storage-quota-exceeded",n)},[]),r.useEffect(()=>{const n=()=>{m(d=>d.map(se))};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[m]),r.useEffect(()=>{m(n=>n.map(se))},[i]),r.useEffect(()=>{const n=()=>{re(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",n),()=>document.removeEventListener("fullscreenchange",n)},[]);const Ye=async()=>{try{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()}catch(n){console.warn("No se pudo cambiar a pantalla completa.",n)}},ke=n=>{te(n),J(!0),N(d=>({...d,isOpen:!1}))},Ve=()=>{te("theme"),J(!0),_(n=>n+1)},f=n=>{oe(n),V(d=>!d)},D=n=>n instanceof HTMLElement?n.isContentEditable?!0:!!n.closest('input, textarea, select, [contenteditable="true"]'):!1,P=()=>{const n=window.getSelection?.();return!!(n&&!n.isCollapsed&&n.toString().trim())},U=(n,d,b=!1)=>{!b&&D(n.target)||!b&&P()||(n.preventDefault(),N({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:d??null,windowInstanceId:null}))},K=(n,d)=>{n.preventDefault();const b=g.activeWidgets.find(y=>y.instanceId===d)?.widgetId??null;N({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:b,windowInstanceId:d})},he=(n,d,b)=>{n.preventDefault(),n.stopPropagation(),N({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:d,windowInstanceId:b})},h=()=>{m([]),N(n=>({...n,isOpen:!1}))},[k,z]=r.useState(new Date),[R,B]=r.useState({usage:null,quota:null}),[ne,ye]=r.useState({width:window.screen.width,height:window.screen.height}),[fe,de]=r.useState({width:window.innerWidth,height:window.innerHeight}),be=r.useRef(null),[pe,We]=r.useState(null),Xe=new Intl.DateTimeFormat(u.language,{year:"numeric",month:"short",day:"numeric"}).format(k),jt=new Intl.DateTimeFormat(u.language,{hour:"2-digit",minute:"2-digit"}).format(k);r.useEffect(()=>{const n=window.setInterval(()=>z(new Date),1e3);return()=>window.clearInterval(n)},[]),r.useEffect(()=>{if(!E){We(null);return}const n=()=>{const b=be.current;if(!b)return;const y=b.getBoundingClientRect();We(y.bottom)},d=window.requestAnimationFrame(n);return window.addEventListener("resize",n),()=>{window.cancelAnimationFrame(d),window.removeEventListener("resize",n)}},[E,Xe,jt,u.language]),r.useEffect(()=>{const n=async()=>{if(!navigator.storage?.estimate){B({usage:null,quota:null});return}const y=await navigator.storage.estimate();B({usage:typeof y.usage=="number"?y.usage:null,quota:typeof y.quota=="number"?y.quota:null})};n();const d=window.setInterval(n,3e4),b=()=>n();return window.addEventListener("storage-usage-changed",b),()=>{window.clearInterval(d),window.removeEventListener("storage-usage-changed",b)}},[]),r.useEffect(()=>{const n=()=>{ye({width:window.screen.width,height:window.screen.height}),de({width:window.innerWidth,height:window.innerHeight})};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const dt=(n,d=2)=>{if(n==null||!Number.isFinite(n))return l("system_stats.not_available");if(n<1024)return`${n} B`;const b=n/1024;if(b<1024)return`${b.toFixed(1)} KB`;const y=b/1024;return y<1024?`${y.toFixed(1)} MB`:`${(y/1024).toFixed(d)} GB`},vt=n=>n==null||!Number.isFinite(n)?null:(n/1024**3).toFixed(2),kt=g.activeWidgets.length>0,st=R.usage,Qe=R.quota,Ct=st!=null&&Qe!=null?Math.max(0,Qe-st):null,Nt=navigator,St=typeof Nt.deviceMemory=="number"?Nt.deviceMemory:null,It=typeof navigator.hardwareConcurrency=="number"?navigator.hardwareConcurrency:null,xs=vt(Qe),ws=vt(Ct),zt=st!=null&&Qe!=null,_s=zt&&xs!==ws,Le=[],Me=H.widgetId??(H.windowInstanceId?g.activeWidgets.find(n=>n.instanceId===H.windowInstanceId)?.widgetId:null),He=Me?g.pinnedWidgets.includes(Me):!1,Ke=H.windowInstanceId?g.activeWidgets.find(n=>n.instanceId===H.windowInstanceId)??null:null,Et=!!Me,ys=!!H.windowInstanceId||kt;return zt&&(Le.push({label:l("system_stats.storage_used"),value:`${dt(st,2)} / ${dt(Qe,2)}`}),_s&&Le.push({label:l("system_stats.storage_free"),value:dt(Ct,2)})),St!=null&&Le.push({label:l("system_stats.memory"),value:l("system_stats.memory_value",{value:St})}),It!=null&&Le.push({label:l("system_stats.cpu"),value:l("system_stats.cpu_value",{value:It})}),Le.push({label:l("system_stats.screen"),value:l("system_stats.screen_value",{width:ne.width,height:ne.height})}),Le.push({label:l("system_stats.window"),value:l("system_stats.window_value",{width:fe.width,height:fe.height})}),e.jsxs("div",{className:"w-screen h-screen overflow-hidden",onContextMenu:n=>U(n),children:[e.jsx("button",{onClick:Ye,onContextMenu:n=>U(n,void 0,!0),className:"fixed top-4 left-4 z-[2] p-2 rounded-full text-white/80 bg-black/15 backdrop-blur-sm hover:bg-black/30 hover:text-white transition-colors",title:l(le?"desktop.fullscreen_exit":"desktop.fullscreen_enter"),"aria-label":l(le?"desktop.fullscreen_exit":"desktop.fullscreen_enter"),children:le?e.jsx(nt,{size:18}):e.jsx(Dt,{size:18})}),E&&e.jsxs("div",{ref:be,className:"fixed top-4 right-4 z-[1] pointer-events-none select-none text-white bg-black/45 backdrop-blur-md rounded-2xl px-6 py-5 shadow-lg",children:[e.jsx("div",{className:"text-lg opacity-90",children:Xe}),e.jsx("div",{className:"text-4xl font-semibold leading-tight",children:jt})]}),w&&Le.length>0&&e.jsx("div",{className:"fixed right-4 z-[1] pointer-events-none select-none text-white bg-black/45 backdrop-blur-md rounded-2xl px-5 py-4 shadow-lg min-w-[220px]",style:{top:E&&pe!=null?`${Math.round(pe+5)}px`:"1rem"},children:e.jsx("div",{className:"space-y-1 text-sm",children:Le.map(n=>e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-white/70",children:n.label}),e.jsx("span",{className:"text-white",children:n.value})]},n.label))})}),g.activeWidgets.map(n=>{const d=Se[n.widgetId];if(!d)return null;const b=d.component,y=g.pinnedWidgets.includes(n.widgetId),Y=n.instanceId===q;return e.jsx(no,{id:n.instanceId,title:l(d.title),icon:d.icon,position:n.position,size:n.size,zIndex:n.zIndex,isMinimized:n.isMinimized,isMaximized:n.isMaximized,onToggleMinimize:()=>Be(n.instanceId),onToggleMaximize:()=>_e(n.instanceId),onClose:()=>me(n.instanceId),onFocus:()=>Ae(n.instanceId),onDragStop:(ae,je)=>{m(Ce=>Ce.map(Oe=>Oe.instanceId===n.instanceId?{...Oe,position:{x:je.x,y:je.y}}:Oe))},onResizeStop:(ae,je,Ce,Oe,Re)=>{const qe=Number.parseFloat(Ce.style.width),Fe=Number.parseFloat(Ce.style.height);m(Pe=>Pe.map(Ne=>Ne.instanceId===n.instanceId?{...Ne,size:{width:Number.isFinite(qe)?qe:Ne.size.width,height:Number.isFinite(Fe)?Fe:Ne.size.height},position:Re}:Ne))},onOpenContextMenu:ae=>he(ae,n.widgetId,n.instanceId),isPinned:y,isActive:Y,onTogglePin:()=>{o(ae=>ae.includes(n.widgetId)?ae.filter(je=>je!==n.widgetId):[...ae,n.widgetId])},pinLabel:l("toolbar.add_widget"),unpinLabel:l("toolbar.remove_widget"),children:e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:l("loading")}),children:e.jsx(b,{})})},n.instanceId)}),ce&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 h-2 z-[10000]",onMouseEnter:()=>De(!0)}),e.jsx(io,{pinnedWidgets:g.pinnedWidgets,onWidgetClick:Ee,onWidgetsClick:()=>ke("widgets"),onOpenContextMenu:(n,d,b)=>U(n,d,b),onReorderPinned:n=>o(n),openWidgets:g.activeWidgets,onTaskClick:Ue,onTaskContextMenu:K,isHidden:ce,isPeeking:ze,onMouseLeave:()=>{ce&&De(!1)},startButtonRef:C}),e.jsxs("button",{ref:C,onClick:n=>f(n.currentTarget.getBoundingClientRect()),onContextMenu:n=>U(n,void 0,!0),className:`fixed bottom-4 left-4 z-[10001] flex items-center gap-2 px-5 py-2.5 rounded-full shadow-lg border border-black/10 backdrop-blur-md transition ${W?"bg-accent text-text-dark":"bg-white/90 text-text-dark hover:bg-white"}`,title:l("toolbar.start"),"aria-label":l("toolbar.start"),children:[e.jsx("img",{src:$("escritorio-digital.png"),alt:l("toolbar.start"),width:"24",height:"24"}),e.jsx("span",{className:"text-sm font-semibold",children:l("toolbar.start")})]}),e.jsx(Ir,{isOpen:W,onClose:()=>V(!1),onAddWidget:Ee,onOpenSettingsTab:ke,onOpenThemeModal:Ve,onOpenAbout:()=>ie(!0),onOpenCredits:()=>Z(!0),onRemoveFavorite:n=>o(d=>d.filter(b=>b!==n)),onReorderFavorites:n=>o(n),onClearFavorites:()=>o([]),onAddFavorite:n=>o(d=>d.includes(n)?d:[...d,n]),pinnedWidgets:g.pinnedWidgets,anchorRect:X,anchorRef:C}),e.jsx(Sr,{isOpen:M,onClose:()=>ie(!1)}),e.jsx(Cr,{isOpen:ge,onClose:()=>J(!1),initialTab:ee,themeModalRequestId:j,pinnedWidgets:g.pinnedWidgets,setPinnedWidgets:o,profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,profileOrder:p,setProfileOrder:x}),e.jsx(Nr,{isOpen:ue,onClose:()=>Z(!1)}),e.jsx(zr,{profiles:t,activeProfileName:i,setActiveProfileName:c,setProfiles:s,onManageProfiles:()=>ke("profiles"),onOpenContextMenu:n=>U(n,void 0,!0),profileOrder:p}),T&&e.jsxs("div",{className:"fixed top-4 right-4 z-[10002] max-w-sm bg-white/95 backdrop-blur-md border border-amber-200 shadow-xl rounded-lg p-4 text-sm text-text-dark",children:[e.jsx("p",{className:"font-semibold text-amber-700",children:l("storage_warning.title")}),e.jsx("p",{className:"mt-1 text-gray-700",children:l("storage_warning.body")}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 rounded-md bg-amber-500 text-white hover:bg-amber-600 transition",onClick:()=>ke("general"),children:l("storage_warning.open_settings")}),e.jsx("button",{className:"px-3 py-1.5 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition",onClick:()=>G(!1),children:l("storage_warning.dismiss")})]})]}),H.isOpen&&e.jsx("div",{ref:v,className:"fixed z-[10000] min-w-[220px] bg-white/95 backdrop-blur-md rounded-lg shadow-xl border border-gray-200 py-2 text-sm text-text-dark",style:{left:H.x,top:H.y},children:H.windowInstanceId&&Ke?e.jsxs(e.Fragment,{children:[Et&&e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Me&&(o(He?n=>n.filter(d=>d!==Me):n=>n.includes(Me)?n:[...n,Me]),N(n=>({...n,isOpen:!1,widgetId:null,windowInstanceId:null})))},children:[He?e.jsx(bt,{size:16}):e.jsx(pt,{size:16}),l(He?"toolbar.remove_widget":"toolbar.add_widget")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Be(Ke.instanceId),N(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx(nt,{size:16}),l("context_menu.minimize_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{_e(Ke.instanceId),N(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[Ke.isMaximized?e.jsx(nt,{size:16}):e.jsx(Dt,{size:16}),Ke.isMaximized?l("context_menu.restore_window"):l("context_menu.maximize_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{me(Ke.instanceId),N(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx($e,{size:16}),l("context_menu.close_window")]})]}):e.jsxs(e.Fragment,{children:[Et&&e.jsx(e.Fragment,{children:e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Me&&(o(He?n=>n.filter(d=>d!==Me):n=>n.includes(Me)?n:[...n,Me]),N(n=>({...n,isOpen:!1,widgetId:null,windowInstanceId:null})))},children:[He?e.jsx(bt,{size:16}):e.jsx(pt,{size:16}),l(He?"toolbar.remove_widget":"toolbar.add_widget")]})}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>ke("widgets"),children:[e.jsx(en,{size:16}),l("context_menu.new_widget")]}),ys&&e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>ke("profiles"),children:[e.jsx(ct,{size:16}),l("context_menu.manage_profiles")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>ke("general"),children:[e.jsx(xt,{size:16}),l("context_menu.settings")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>ke("theme"),children:[e.jsx(Qt,{size:16}),l("context_menu.change_background")]}),e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{Ie(!ce),N(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_toolbar")}),e.jsx("span",{className:`h-4 w-4 rounded border ${ce?"border-gray-400":"bg-accent border-accent"}`})]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{I(),N(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_datetime")}),e.jsx("span",{className:`h-4 w-4 rounded border ${E?"bg-accent border-accent":"border-gray-400"}`})]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{a(),N(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_system_stats")}),e.jsx("span",{className:`h-4 w-4 rounded border ${w?"bg-accent border-accent":"border-gray-400"}`})]}),kt&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Te(),N(n=>({...n,isOpen:!1}))},children:[e.jsx(nt,{size:16}),l("context_menu.minimize_windows")]}),H.windowInstanceId&&e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{me(H.windowInstanceId),N(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx($e,{size:16}),l("context_menu.close_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:h,children:[e.jsx($e,{size:16}),l("context_menu.reset_layout")]})]})]})})]})};function Gt(){const[t,s]=et("desktop-profiles",{"Escritorio Principal":{theme:Ze,activeWidgets:[],pinnedWidgets:["work-list","timer","file-opener","vce-community"],vceFavorites:[]}}),[i,c]=et("profile-order",[]),[p,x]=et("active-profile-name","Escritorio Principal");r.useEffect(()=>{const o=I=>{const a=I.detail;if(!a||!a.profileName||!a.favorites)return;const S=a.profileName,A=a.favorites;s(O=>{const q=O[S];return q?{...O,[S]:{...q,vceFavorites:A}}:O})};return window.addEventListener("vce-favorites-update",o),()=>window.removeEventListener("vce-favorites-update",o)},[s]);const l=t[p]||Object.values(t)[0],u=l.theme||Ze,g=o=>{const I=l.theme,a=typeof o=="function"?o(I):o,S={...l,theme:a};s(A=>({...A,[p]:S}))},E=o=>{g(I=>({...I,"--wallpaper":o}))},w=()=>{g(Ze)};r.useEffect(()=>{document.body.style.backgroundImage=u["--wallpaper"],document.body.classList.toggle("high-contrast",!!u.highContrast);const o=document.documentElement;for(const[I,a]of Object.entries(u))I.startsWith("--")&&I!=="--wallpaper"&&o.style.setProperty(I,a)},[u]),r.useEffect(()=>{const o=u["--wallpaper"];if(!o)return;const I=o.toLowerCase(),a=I.startsWith("url(data:")||I.startsWith("url(http");I==="none"||a||sr(o)||g(A=>({...A,"--wallpaper":gs}))},[u["--wallpaper"],g]),r.useEffect(()=>{window.dispatchEvent(new CustomEvent("active-profile-change",{detail:{name:p}}))},[p]),r.useEffect(()=>{window.dispatchEvent(new Event("profiles-updated"))},[t]);const m={theme:u,setTheme:g,setWallpaper:E,resetTheme:w,defaultTheme:Ze};return e.jsx(ir,{value:m,children:e.jsx(Er,{profiles:t,setProfiles:s,activeProfileName:p,setActiveProfileName:x,profileOrder:i,setProfileOrder:c})})}const Wr="/escritorio/";it.use(vs).use(cn).use(Cs).init({fallbackLng:"es",supportedLngs:["es","ca","eu","gl","pt","fr","it","de","en"],debug:!1,initImmediate:!1,ns:"translation",defaultNS:"translation",backend:{loadPath:`${Wr}locales/{{lng}}/{{ns}}.json`,requestOptions:{cache:"no-cache"}},interpolation:{escapeValue:!1},detection:{order:["querystring","cookie","localStorage","navigator","htmlTag"],caches:["localStorage","cookie"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t.startsWith("ca")?"ca":t.startsWith("gl")?"gl":t.startsWith("eu")?"eu":t.startsWith("es")?"es":t.startsWith("pt")?"pt":t.startsWith("it")?"it":t.startsWith("de")?"de":t.startsWith("en")?"en":t.startsWith("fr")?"fr":t},react:{useSuspense:!1}});const Mr=new Promise(t=>{const s=()=>{it.loadNamespaces(["translation"]).then(()=>t())};it.isInitialized?s():it.on("initialized",s)}),Or=()=>{const{t}=L();return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:t("loading")})},Ut=js.createRoot(document.getElementById("root"));Mr.then(()=>{Ut.render(e.jsx(ft.StrictMode,{children:e.jsx(r.Suspense,{fallback:e.jsx(Or,{}),children:e.jsx(Gt,{})})}))}).catch(t=>{console.error("i18n init error:",t),Ut.render(e.jsx(ft.StrictMode,{children:e.jsx(Gt,{})}))});export{mi as A,$ as B,fi as C,pi as D,_i as E,vi as F,Ci as G,Ii as H,Wi as I,Oi as J,Li as K,Pi as L,Ai as M,Vi as N,qi as O,Ui as P,Xi as Q,Zi as R,to as S,un as a,hn as b,bn as c,xn as d,_n as e,jn as f,kn as g,Nn as h,In as i,Wn as j,On as k,Tn as l,Pn as m,An as n,Bn as o,Hn as p,qn as q,Yn as r,Jn as s,ti as t,et as u,ni as v,dn as w,oi as x,li as y,di as z};
