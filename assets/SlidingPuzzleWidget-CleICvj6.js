import{r as d,j as s}from"./vendor-react-CvxLrFbY.js";import{I as Z}from"./index-BRUjA2Tl.js";import{u as b}from"./vendor-react-i18next-CV9wn5jO.js";import{w as _,ar as N}from"./vendor-lucide-react-CYRm5Z9O.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-react-dom-ovwEKgq_.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-i18next-http-backend-BlWUewvL.js";import"./vendor-react-rnd-CJIym3is.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-core-C4pUYSBz.js";import"./vendor-dnd-kit-utilities-CZrAEsTl.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-dnd-kit-sortable-BobZZm17.js";import"./vendor-fflate-PjZAcS34.js";import"./vendor-framer-motion-FfyGqyL8.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";import"./vendor-i18next-Bvlggjj8.js";import"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";const P=(n,l)=>{let m=0;const e=n.filter(a=>a!==l*l-1);for(let a=0;a<e.length-1;a++)for(let c=a+1;c<e.length;c++)e[a]>e[c]&&m++;if(l%2===1)return m%2===0;{const a=l-Math.floor(n.indexOf(l*l-1)/l);return(m+a)%2!==0}},V=()=>{const{t:n}=b(),[l,m]=d.useState(null),[e,a]=d.useState(3),[c,u]=d.useState([]),[f,g]=d.useState(!1),h=()=>{const t=e*e,o=Array.from({length:t},(i,p)=>p);let r;do r=[...o].sort(()=>Math.random()-.5);while(!P(r,e)||r.every((i,p)=>i===p));u(r),g(!1)};d.useEffect(()=>{l&&h()},[l,e]),d.useEffect(()=>{if(c.length===0)return;const t=c.every((o,r)=>o===r);g(t)},[c]);const w=t=>{if(t.target.files&&t.target.files[0]){const o=new FileReader;o.onload=r=>{m(r.target?.result)},o.readAsDataURL(t.target.files[0])}},y=t=>{if(f)return;const o=c.indexOf(e*e-1);if(((i,p)=>{const z=Math.floor(i/e),v=i%e,x=Math.floor(p/e),j=p%e;return z===x&&Math.abs(v-j)===1||v===j&&Math.abs(z-x)===1})(t,o)){const i=[...c];[i[t],i[o]]=[i[o],i[t]],u(i)}};return l?s.jsxs("div",{className:"sliding-puzzle-widget",children:[s.jsxs("div",{className:"puzzle-board",style:{gridTemplateColumns:`repeat(${e}, 1fr)`},children:[c.map((t,o)=>{const r=t===e*e-1,i=t%e,p=Math.floor(t/e);return s.jsx("div",{className:`puzzle-piece ${r?"empty":""}`,onClick:()=>y(o),children:!r&&s.jsx("div",{className:"piece-image",style:{backgroundImage:`url(${l})`,backgroundSize:`${e*100}% ${e*100}%`,backgroundPosition:`${i*100/(e-1)}% ${p*100/(e-1)}%`}})},o)}),f&&s.jsx("div",{className:"solved-overlay",children:n("widgets.sliding_puzzle.solved_overlay")})]}),s.jsxs("div",{className:"puzzle-controls",children:[s.jsxs("label",{children:[n("widgets.sliding_puzzle.complexity_label"),s.jsxs("select",{value:e,onChange:t=>a(Number(t.target.value)),children:[s.jsx("option",{value:3,children:n("widgets.sliding_puzzle.difficulty.easy")}),s.jsx("option",{value:4,children:n("widgets.sliding_puzzle.difficulty.normal")}),s.jsx("option",{value:5,children:n("widgets.sliding_puzzle.difficulty.hard")})]})]}),s.jsxs("button",{onClick:h,children:[s.jsx(N,{size:16})," ",n("widgets.sliding_puzzle.shuffle_button")]})]})]}):s.jsxs("div",{className:"puzzle-placeholder",children:[s.jsx(_,{size:48}),s.jsx("p",{children:n("widgets.sliding_puzzle.upload_prompt")}),s.jsx("input",{type:"file",accept:"image/*",onChange:w})]})};export{V as SlidingPuzzleWidget,Z as widgetConfig};
