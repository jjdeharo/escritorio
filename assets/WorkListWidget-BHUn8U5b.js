import{u as C,r as d,j as t,W as T,O as E,aQ as S,X as L}from"./react-vendor-C9LHBUkp.js";import{u as R}from"./index-DIQ32RE2.js";import{S as F}from"./index-DIQ32RE2.js";import{av as j}from"./vendor-BnVc6iZf.js";import"./editor-vendor-Dlj3R3R2.js";import"./i18n-vendor-DdbEjq8F.js";const A=()=>{const{t:o,ready:w}=C(),[r,a]=R("work-list-tasks",[]),[m,k]=d.useState(""),[n,p]=d.useState(null),[u,x]=d.useState(""),g=d.useRef(null),b=e=>{e.key==="Enter"&&m.trim()!==""&&(a([...r,{id:Date.now(),text:m.trim(),completed:!1}]),k(""))},_=e=>{a(r.map(s=>s.id===e?{...s,completed:!s.completed}:s))},h=e=>{a(r.filter(s=>s.id!==e))},f=e=>{p(e.id),x(e.text)},v=e=>{e.key==="Enter"&&n!==null&&(u.trim()===""?h(n):a(r.map(s=>s.id===n?{...s,text:u.trim()}:s)),p(null),x(""))},y=()=>{const e=j.unparse(r.map(i=>({id:i.id,text:i.text,completed:i.completed}))),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),c=URL.createObjectURL(s);l.setAttribute("href",c),l.setAttribute("download","lista_de_trabajo.csv"),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},N=e=>{const s=e.target.files?.[0];s&&j.parse(s,{header:!0,skipEmptyLines:!0,complete:l=>{const c=l.data.map(i=>({id:Number(i.id)||Date.now()+Math.random(),text:String(i.text||""),completed:String(i.completed).toLowerCase()==="true"})).filter(i=>i.text);window.confirm(o("widgets.work_list.replace_list_confirm"))?a(c):a(i=>[...i,...c])},error:l=>{console.error("Error al parsear el CSV:",l),alert(o("widgets.work_list.csv_error"))}}),e.target&&(e.target.value="")};return console.log("WorkList translations:",{ready:w,placeholder:o("widgets.work_list.add_task_placeholder"),title:o("widgets.work_list.title")}),w?t.jsxs("div",{className:"work-list-widget",children:[t.jsxs("div",{className:"flex gap-2 mb-2",children:[t.jsx("input",{type:"text",className:"work-list-input",placeholder:o("widgets.work_list.add_task_placeholder"),value:m,onChange:e=>k(e.target.value),onKeyPress:b}),t.jsx("button",{onClick:()=>g.current?.click(),className:"work-list-icon-button",title:o("widgets.work_list.load_csv"),children:t.jsx(T,{size:20})}),t.jsx("button",{onClick:y,className:"work-list-icon-button",title:o("widgets.work_list.download_csv"),children:t.jsx(E,{size:20})})]}),t.jsx("ul",{className:"work-list-items",children:r.map(e=>t.jsxs("li",{className:`work-list-item ${e.completed?"opacity-50":""}`,children:[t.jsx("input",{type:"checkbox",className:"work-list-checkbox",checked:e.completed,onChange:()=>_(e.id)}),n===e.id?t.jsx("input",{type:"text",value:u,onChange:s=>x(s.target.value),onKeyPress:v,onBlur:()=>p(null),className:"work-list-edit-input",autoFocus:!0}):t.jsx("span",{className:`flex-grow cursor-pointer ${e.completed?"line-through":""}`,onDoubleClick:()=>f(e),children:e.text}),t.jsx("button",{onClick:()=>f(e),className:"work-list-action",children:t.jsx(S,{size:16})}),t.jsx("button",{onClick:()=>h(e.id),className:"work-list-action delete",children:t.jsx(L,{size:16})})]},e.id))}),t.jsx("p",{className:"work-list-hint",children:o("widgets.work_list.double_click_edit")}),t.jsx("input",{type:"file",ref:g,onChange:N,accept:".csv",className:"hidden"})]}):t.jsx("div",{className:"flex items-center justify-center h-full",children:o("loading")})};export{A as WorkListWidget,F as widgetConfig};
