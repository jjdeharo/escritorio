const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AttendanceWidget-CaWitwkI.js","assets/vendor-react-CvxLrFbY.js","assets/vendor-clsx-DMbM62ou.js","assets/vendor-papaparse-D7EnbpYv.js","assets/vendor-react-i18next-CV9wn5jO.js","assets/vendor-html-parse-stringify-C3VvPRF8.js","assets/vendor-void-elements-SshaXqDN.js","assets/vendor-lucide-react-CYRm5Z9O.js","assets/vendor-react-dom-ovwEKgq_.js","assets/vendor-scheduler-SPyfQU6S.js","assets/vendor-i18next-http-backend-BlWUewvL.js","assets/vendor-react-rnd-CJIym3is.js","assets/vendor-react-draggable-CHzIUO8G.js","assets/vendor-prop-types-Chjiymov.js","assets/vendor-re-resizable-Bd8fNV1d.js","assets/vendor-dnd-kit-core-C4pUYSBz.js","assets/vendor-dnd-kit-utilities-CZrAEsTl.js","assets/vendor-dnd-kit-accessibility-DKV5GxcV.js","assets/vendor-dnd-kit-sortable-BobZZm17.js","assets/vendor-fflate-PjZAcS34.js","assets/vendor-framer-motion-FfyGqyL8.js","assets/vendor-motion-dom-DtvSSoo0.js","assets/vendor-motion-utils-CjIqCkNq.js","assets/vendor-i18next-Bvlggjj8.js","assets/vendor-i18next-browser-languagedetector-OJKzRF51.js","assets/AttendanceWidget-BRBVD50_.css","assets/BoardLiveWidget-CAZh2aSu.js","assets/ExternalAppWidget-CsdzeyYi.js","assets/CalendarWidget-ChZGfypu.js","assets/ChatgptIaEduWidget-DjaXj4YP.js","assets/LinkPortalWidget-BmeMb2jA.js","assets/LinkPortalWidget-CanpM5sk.css","assets/ClassDiaryWidget-n9OyigNU.js","assets/DiceWidget-9H5r8-6D.js","assets/DiceWidget-DKhUyOlY.css","assets/DirectoEscalaWidget-lHTdcwGz.js","assets/getDirectoAppUrl-D2T_aUN8.js","assets/DirectoIdeasWidget-DXLND5Lv.js","assets/DirectoMuroWidget-DR71ofLM.js","assets/DirectoNubeWidget-BHNvwt3-.js","assets/DirectoViewerWidget-DVt-F0gK.js","assets/DirectoVotaWidget-DW-ZoYvz.js","assets/DrawingPadWidget-DQoT7KdE.js","assets/EdiMarkWebWidget-C4bI-Lmw.js","assets/EdiMarkWebWidget-BxtMZy4w.css","assets/EduMediaIAGWidget-CRlQXp0B.js","assets/EduMediaIAGWidget-55EvG_hs.css","assets/FileOpenerWidget-BO3xGqo1.js","assets/vendor-marked-IrHqQMcX.js","assets/vendor-katex-KHco_4HN.js","assets/vendor-katex-Qi1jX_nK.css","assets/FileOpenerWidget-BbKTlflL.css","assets/GlobalClocksWidget-DvoS2ksm.js","assets/GlobalClocksWidget-Ca_QpoyH.css","assets/GroupGeneratorWidget-BY_gPaGd.js","assets/GroupGeneratorWidget-kkYbKX9i.css","assets/HtmlSandboxWidget-C-06tWiu.js","assets/HtmlSandboxWidget-Cg7SWthN.css","assets/IframeWidget-NU_JmoYG.js","assets/IframeWidget-DB5Y2nTd.css","assets/ImageCarouselWidget-C5EOFBLf.js","assets/ImageCarouselWidget-NO2dK4ma.css","assets/LatexMarkdownWidget-iJc_KcdC.js","assets/vendor-html-to-image-CCayPtYg.js","assets/LatexMarkdownWidget-1p3U7SuV.css","assets/LocalWebWidget-De6B3N0G.js","assets/LocalWebWidget-DBzpeu8b.css","assets/MemoryGameWidget-ucINRTvc.js","assets/MemoryGameWidget-jVyKEXp9.css","assets/MetronomeWidget-PYh2S2nK.js","assets/MetronomeWidget-B6d6WkN_.css","assets/NotepadWidget-y441YSHw.js","assets/vendor-tiptap-react-D3a-0-ED.js","assets/vendor-use-sync-external-store-C97i1TfO.js","assets/vendor-tiptap-core-CKFakkLY.js","assets/vendor-prosemirror-state-NYKsNaF9.js","assets/vendor-prosemirror-model-Cw4923ok.js","assets/vendor-orderedmap-C4TimWWB.js","assets/vendor-prosemirror-transform-cuuh7Eb1.js","assets/vendor-prosemirror-view-BAC1zYEb.js","assets/vendor-prosemirror-keymap-nVVzLNZ8.js","assets/vendor-w3c-keyname-DEtA-KhA.js","assets/vendor-prosemirror-commands-viQ1mFGl.js","assets/vendor-prosemirror-schema-list-CaxV89W7.js","assets/vendor-fast-deep-equal-BSqTf1VG.js","assets/vendor-tiptap-starter-kit-Cz4HOVMm.js","assets/vendor-tiptap-extension-blockquote-CWGVbdF9.js","assets/vendor-tiptap-extension-bold-T3TaQ4ox.js","assets/vendor-tiptap-extension-code-Rhc3bKmR.js","assets/vendor-tiptap-extension-code-block-Z-UswLJ6.js","assets/vendor-tiptap-extension-document-DmBpm_Dh.js","assets/vendor-tiptap-extension-hard-break-CgmATOq2.js","assets/vendor-tiptap-extension-heading-CeYeXkHY.js","assets/vendor-tiptap-extension-horizontal-rule-DSYvxAi1.js","assets/vendor-tiptap-extension-italic-9rLXdwYo.js","assets/vendor-tiptap-extension-link-ChB58ZKs.js","assets/vendor-linkifyjs-DVrXeg1a.js","assets/vendor-tiptap-extension-list-DOkXVaJV.js","assets/vendor-tiptap-extension-paragraph-B6o0SWd_.js","assets/vendor-tiptap-extension-strike-B-4DIOoO.js","assets/vendor-tiptap-extension-text-BVHjtOnu.js","assets/vendor-tiptap-extension-underline-9N49xdTX.js","assets/vendor-tiptap-extensions-DIEPum1A.js","assets/vendor-prosemirror-dropcursor-C0L_H6JX.js","assets/vendor-prosemirror-gapcursor-BdM-MfDS.js","assets/vendor-prosemirror-history-DQINzrbf.js","assets/vendor-rope-sequence-Cxv9J64N.js","assets/vendor-turndown-BfpucfJx.js","assets/NotepadWidget-DO-NzTz2.css","assets/ProgramGuideWidget-OzLA9FWG.js","assets/ProgramGuideWidget-BgYH5Siw.css","assets/QPlayWidget-zEn_0XvL.js","assets/QrCodeGeneratorWidget-CLJDy-61.js","assets/vendor-qrcode.react-CpH_E45I.js","assets/QrCodeGeneratorWidget-C9sVw1mn.css","assets/RandomSpinnerWidget-CZlFvG7m.js","assets/RandomSpinnerWidget-BAOoHIXm.css","assets/ScientificCalculatorWidget-CgtNEEUZ.js","assets/ScientificCalculatorWidget-BbkYalVJ.css","assets/ScoreboardWidget-CNudDMig.js","assets/ScoreboardWidget-Cosun4xH.css","assets/SlidingPuzzleWidget-CleICvj6.js","assets/SlidingPuzzleWidget-Bn7_1foX.css","assets/SoundMeterWidget-CIwzjGCR.js","assets/SoundMeterWidget-CZKF7qrT.css","assets/StopwatchWidget-BgAsVE_k.js","assets/StopwatchWidget-HJzaRRM_.css","assets/TicTacToeWidget-BtlPVMNq.js","assets/TicTacToeWidget-9JQ82k6G.css","assets/TimerWidget-ClDpPBij.js","assets/TrafficLightWidget-nBFm1H1r.js","assets/TrafficLightWidget-BUEVZBE_.css","assets/UnitConverterWidget-3aOF2WMD.js","assets/UnitConverterWidget-Cyc2wYQh.css","assets/VceCommunityWidget-CbH7dJ6o.js","assets/VceCommunityWidget-Ct8Sp28Q.css","assets/WikipediaSearchWidget-5sO6H4QX.js","assets/WikipediaSearchWidget-CcDY2TYh.css","assets/WorkGesturesWidget-IC27OLVN.js","assets/WorkGesturesWidget-5Yav63Mk.css","assets/WorkListWidget-uwGhEjHd.js"])))=>i.map(i=>d[i]);
import{j as e,r,R as ft}from"./vendor-react-CvxLrFbY.js";import{b as ks}from"./vendor-react-dom-ovwEKgq_.js";import{_ as F,B as Cs}from"./vendor-i18next-http-backend-BlWUewvL.js";import{u as L,T as Ns,i as Ss}from"./vendor-react-i18next-CV9wn5jO.js";import{B as Qt,P as bt,a as pt,M as Is,b as zs,c as Es,X as Pe,L as Jt,A as Ws,d as Ms,C as Os,F as Ds,T as Ts,S as Ls,E as gt,e as Dt,f as xt,g as Fs,h as Ps,i as $s,G as As,H as Rs,j as Bs,k as Vs,U as ct,l as Hs,m as Ks,n as qs,o as Gs,p as Us,q as Ys,I as Zt,r as Xs,s as Qs,t as Js,D as Tt,u as Zs,v as en,w as tn,x as nt,y as Lt,z as sn}from"./vendor-lucide-react-CYRm5Z9O.js";import{R as nn}from"./vendor-react-rnd-CJIym3is.js";import{f as es,h as rt,D as ts,i as ss,j as ns,P as is}from"./vendor-dnd-kit-core-C4pUYSBz.js";import{S as os,h as on,a as rs,s as as,u as ls,v as rn}from"./vendor-dnd-kit-sortable-BobZZm17.js";import{C as cs}from"./vendor-dnd-kit-utilities-CZrAEsTl.js";import{s as Ft,Z as an,u as ln,a as Pt,b as cn}from"./vendor-fflate-PjZAcS34.js";import{A as dn,m as $t}from"./vendor-framer-motion-FfyGqyL8.js";import{i as it}from"./vendor-i18next-Bvlggjj8.js";import{B as gn}from"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const b of document.querySelectorAll('link[rel="modulepreload"]'))c(b);new MutationObserver(b=>{for(const p of b)if(p.type==="childList")for(const l of p.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function i(b){const p={};return b.integrity&&(p.integrity=b.integrity),b.referrerPolicy&&(p.referrerPolicy=b.referrerPolicy),b.crossOrigin==="use-credentials"?p.credentials="include":b.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function c(b){if(b.ep)return;b.ep=!0;const p=i(b);fetch(b.href,p)}})();const At="/escritorio/",$=t=>{if(!t)return At;const s=t.startsWith("/")?t.slice(1):t;return`${At}${s}`},un={id:"attendance",title:"widgets.attendance.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Attendance.png"),alt:s("widgets.attendance.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:450,height:600}},mn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:un},Symbol.toStringTag,{value:"Module"})),hn={id:"boardlive",title:"widgets.boardlive.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/BoardLive.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},fn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:hn},Symbol.toStringTag,{value:"Module"})),bn={id:"calendar",title:"widgets.calendar.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Calendar.png"),alt:s("widgets.calendar.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:320,height:350}},pn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:bn},Symbol.toStringTag,{value:"Module"})),xn={id:"comunidad-chatgpt-ia-edu",title:"widgets.chatgpt_ia_edu.title",searchKeywords:["widgets.chatgpt_ia_edu.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/ComunidadChatGPT-IA-edu.png"),alt:s("widgets.chatgpt_ia_edu.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:620}},wn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:xn},Symbol.toStringTag,{value:"Module"})),_n={id:"class-diary",title:"widgets.class_diary.title",searchKeywords:["widgets.class_diary.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/ClassDiary.png"),alt:s("widgets.class_diary.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:620}},yn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:_n},Symbol.toStringTag,{value:"Module"})),jn={id:"dice",title:"widgets.dice.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Dice.png"),alt:s("widgets.dice.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:400,height:300}},vn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:jn},Symbol.toStringTag,{value:"Module"})),kn={id:"directo-escala",title:"widgets.directo_escala.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoEscala.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Cn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:kn},Symbol.toStringTag,{value:"Module"})),Nn={id:"directo-ideas",title:"widgets.directo_ideas.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoIdeas.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Sn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Nn},Symbol.toStringTag,{value:"Module"})),In={id:"directo-muro",title:"widgets.directo_muro.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoMuro.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},zn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:In},Symbol.toStringTag,{value:"Module"})),En={id:"directo-nube",title:"widgets.directo_nube.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoNube.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Wn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:En},Symbol.toStringTag,{value:"Module"})),Mn=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Directo.png"),alt:t("widgets.directo_viewer.title"),width:52,height:52})},On={id:"directo-viewer",title:"widgets.directo_viewer.title",icon:e.jsx(Mn,{}),defaultSize:{width:800,height:600}},Dn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:On},Symbol.toStringTag,{value:"Module"})),Tn={id:"directo-vota",title:"widgets.directo_vota.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoVota.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Ln=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Tn},Symbol.toStringTag,{value:"Module"})),Fn={id:"drawing-pad",title:"widgets.drawing_pad.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/paleta.png"),alt:s("widgets.drawing_pad.title"),className:"w-8 h-8"})};return e.jsx(t,{})})(),defaultSize:{width:600,height:450}},Pn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Fn},Symbol.toStringTag,{value:"Module"})),$n=()=>{const{t}=L();return e.jsx("img",{src:$("icons/EdiMarkWeb.png"),alt:t("widgets.edimarkweb.title"),width:52,height:52})},An={id:"edimarkweb",title:"widgets.edimarkweb.title",startTooltip:"widgets.edimarkweb.tooltip",icon:e.jsx($n,{}),defaultSize:{width:1100,height:720}},Rn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:An},Symbol.toStringTag,{value:"Module"})),Bn={id:"edumedia-iag",title:"widgets.edumedia_iag.title",searchKeywords:["widgets.edumedia_iag.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/EduMedia-IAG.png"),alt:s("widgets.edumedia_iag.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:940,height:640}},Vn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Bn},Symbol.toStringTag,{value:"Module"})),Hn={id:"file-opener",title:"widgets.file_opener.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/FileExplorer.png"),alt:s("widgets.file_opener.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:720,height:520}},Kn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Hn},Symbol.toStringTag,{value:"Module"})),qn={id:"global-clocks",title:"widgets.global_clocks.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/GlobalClocks.png"),alt:s("widgets.global_clocks.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:350,height:400}},Gn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:qn},Symbol.toStringTag,{value:"Module"})),Un={id:"group-generator",title:"widgets.group_generator.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/GroupGenerator.png"),alt:s("widgets.group_generator.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:700,height:550}},Yn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Un},Symbol.toStringTag,{value:"Module"})),Xn=()=>{const{t}=L();return e.jsx("img",{src:$("icons/HtmlSandbox.png"),alt:t("widgets.html_sandbox.title"),width:52,height:52})},Qn={id:"html-sandbox",title:"widgets.html_sandbox.title",icon:e.jsx(Xn,{}),defaultSize:{width:600,height:450}},Jn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Qn},Symbol.toStringTag,{value:"Module"})),Zn=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Iframe.png"),alt:t("widgets.iframe.title"),width:52,height:52})},ei={id:"iframe",title:"widgets.iframe.title",icon:e.jsx(Zn,{}),defaultSize:{width:600,height:500}},ti=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ei},Symbol.toStringTag,{value:"Module"})),si=()=>{const{t}=L();return e.jsx("img",{src:$("icons/ImageCarousel.png"),alt:t("widgets.image_carousel.title"),width:52,height:52})},ni={id:"image-carousel",title:"widgets.image_carousel.title",icon:e.jsx(si,{}),defaultSize:{width:500,height:400}},ii=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ni},Symbol.toStringTag,{value:"Module"})),oi={id:"latex-markdown",title:"widgets.latex_markdown.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/LatexMarkdown.png"),alt:s("widgets.latex_markdown.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:550}},ri=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:oi},Symbol.toStringTag,{value:"Module"})),ai={id:"local-web",title:"widgets.local_web.title",searchKeywords:["widgets.local_web.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/LocalWeb.png"),alt:s("widgets.local_web.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},li=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ai},Symbol.toStringTag,{value:"Module"})),ci=()=>{const{t}=L();return e.jsx("img",{src:$("icons/MemoryGame.png"),alt:t("widgets.memory_game.icon_alt"),width:"52",height:"52"})},di={id:"memory-game",title:"widgets.memory_game.title",icon:e.jsx(ci,{}),defaultSize:{width:500,height:550}},gi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:di},Symbol.toStringTag,{value:"Module"})),ui={id:"metronome",title:"widgets.metronome.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Metronome.png"),alt:s("widgets.metronome.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:400}},mi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ui},Symbol.toStringTag,{value:"Module"})),hi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Notepad.png"),alt:t("widgets.notepad.icon_alt"),width:"52",height:"52"})},fi={id:"notepad",title:"widgets.notepad.title",icon:e.jsx(hi,{}),defaultSize:{width:500,height:450}},bi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:fi},Symbol.toStringTag,{value:"Module"})),pi={id:"program-guide",title:"widgets.program_guide.title",icon:e.jsx(Qt,{size:44}),defaultSize:{width:800,height:600}},xi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:pi},Symbol.toStringTag,{value:"Module"})),wi={id:"qplay",title:"widgets.qplay.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/QPlay.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},_i=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:wi},Symbol.toStringTag,{value:"Module"})),yi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/QrCodeGenerator.png"),alt:t("widgets.qr_code_generator.icon_alt"),width:"52",height:"52"})},ji={id:"qr-code-generator",title:"widgets.qr_code_generator.title",icon:e.jsx(yi,{}),defaultSize:{width:350,height:500}},vi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ji},Symbol.toStringTag,{value:"Module"})),ki=()=>{const{t}=L();return e.jsx("img",{src:$("icons/RandomSpinner.png"),alt:t("widgets.random_spinner.icon_alt"),width:"52",height:"52"})},Ci={id:"random-spinner",title:"widgets.random_spinner.title",icon:e.jsx(ki,{}),defaultSize:{width:720,height:420}},Ni=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ci},Symbol.toStringTag,{value:"Module"})),Si={id:"scientific-calculator",title:"widgets.scientific_calculator.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/ScientificCalculator.png"),alt:s("widgets.scientific_calculator.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:400,height:600}},Ii=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Si},Symbol.toStringTag,{value:"Module"})),zi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Scoreboard.png"),alt:t("widgets.scoreboard.icon_alt"),width:"52",height:"52"})},Ei={id:"scoreboard",title:"widgets.scoreboard.title",icon:e.jsx(zi,{}),defaultSize:{width:400,height:450}},Wi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ei},Symbol.toStringTag,{value:"Module"})),Mi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/SlidePuzzle.png"),alt:t("widgets.sliding_puzzle.icon_alt"),width:"52",height:"52"})},Oi={id:"sliding-puzzle",title:"widgets.sliding_puzzle.title",icon:e.jsx(Mi,{}),defaultSize:{width:450,height:550}},Di=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Oi},Symbol.toStringTag,{value:"Module"})),Ti={id:"sound-meter",title:"widgets.sound_meter.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/SoundMeter.png"),alt:s("widgets.sound_meter.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:300}},Li=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ti},Symbol.toStringTag,{value:"Module"})),Fi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/Stopwatch.png"),alt:t("widgets.stopwatch.title"),width:52,height:52})},Pi={id:"stopwatch",title:"widgets.stopwatch.title",icon:e.jsx(Fi,{}),defaultSize:{width:320,height:450}},$i=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Pi},Symbol.toStringTag,{value:"Module"})),Ai={id:"tic-tac-toe",title:"widgets.tic_tac_toe.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/TicTacToe.png"),alt:s("widgets.tic_tac_toe.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:380,height:520}},Ri=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ai},Symbol.toStringTag,{value:"Module"})),Bi={id:"timer",title:"widgets.timer.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Timer.png"),alt:s("widgets.timer.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:300}},Vi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Bi},Symbol.toStringTag,{value:"Module"})),Hi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/TrafficLight.png"),alt:t("widgets.traffic_light.icon_alt"),width:"52",height:"52"})},Ki={id:"traffic-light",title:"widgets.traffic_light.title",icon:e.jsx(Hi,{}),defaultSize:{width:150,height:350}},qi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ki},Symbol.toStringTag,{value:"Module"})),Gi=()=>{const{t}=L();return e.jsx("img",{src:$("icons/UnitConverter.png"),alt:t("widgets.unit_converter.icon_alt"),width:"52",height:"52"})},Ui={id:"unit-converter",title:"widgets.unit_converter.title",icon:e.jsx(Gi,{}),defaultSize:{width:450,height:200}},Yi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ui},Symbol.toStringTag,{value:"Module"})),Xi={id:"vce-community",title:"widgets.vce.title",startTooltip:"widgets.vce.start_tooltip",searchKeywords:["widgets.vce.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/vibe_coding_educativo.png"),alt:s("widgets.vce.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:980,height:620}},Qi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Xi},Symbol.toStringTag,{value:"Module"})),Ji={id:"wikipedia-search",title:"widgets.wikipedia.title",searchKeywords:["widgets.wikipedia.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/Wikipedia.png"),alt:s("widgets.wikipedia.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:960,height:640}},Zi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ji},Symbol.toStringTag,{value:"Module"})),eo=()=>{const{t}=L();return e.jsx("img",{src:$("icons/WorkGestures.png"),alt:t("widgets.work_gestures.icon_alt"),width:"52",height:"52"})},to={id:"work-gestures",title:"widgets.work_gestures.title",icon:e.jsx(eo,{}),defaultSize:{width:450,height:450}},so=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:to},Symbol.toStringTag,{value:"Module"})),no={id:"work-list",title:"widgets.work_list.title",icon:(()=>{const t=()=>{const{t:s}=L();return e.jsx("img",{src:$("icons/WorkList.png"),alt:s("widgets.work_list.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:380,height:400}},io=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:no},Symbol.toStringTag,{value:"Module"})),Rt=Object.assign({"./Attendance/widgetConfig.tsx":mn,"./BoardLive/widgetConfig.tsx":fn,"./Calendar/widgetConfig.tsx":pn,"./ChatgptIaEdu/widgetConfig.tsx":wn,"./ClassDiary/widgetConfig.tsx":yn,"./Dice/widgetConfig.tsx":vn,"./DirectoEscala/widgetConfig.tsx":Cn,"./DirectoIdeas/widgetConfig.tsx":Sn,"./DirectoMuro/widgetConfig.tsx":zn,"./DirectoNube/widgetConfig.tsx":Wn,"./DirectoViewer/widgetConfig.tsx":Dn,"./DirectoVota/widgetConfig.tsx":Ln,"./DrawingPad/widgetConfig.tsx":Pn,"./EdiMarkWeb/widgetConfig.tsx":Rn,"./EduMediaIAG/widgetConfig.tsx":Vn,"./FileOpener/widgetConfig.tsx":Kn,"./GlobalClocks/widgetConfig.tsx":Gn,"./GroupGenerator/widgetConfig.tsx":Yn,"./HtmlSandbox/widgetConfig.tsx":Jn,"./Iframe/widgetConfig.tsx":ti,"./ImageCarousel/widgetConfig.tsx":ii,"./LatexMarkdown/widgetConfig.tsx":ri,"./LocalWeb/widgetConfig.tsx":li,"./MemoryGame/widgetConfig.tsx":gi,"./Metronome/widgetConfig.tsx":mi,"./Notepad/widgetConfig.tsx":bi,"./ProgramGuide/widgetConfig.tsx":xi,"./QPlay/widgetConfig.tsx":_i,"./QrCodeGenerator/widgetConfig.tsx":vi,"./RandomSpinner/widgetConfig.tsx":Ni,"./ScientificCalculator/widgetConfig.tsx":Ii,"./Scoreboard/widgetConfig.tsx":Wi,"./SlidingPuzzle/widgetConfig.tsx":Di,"./SoundMeter/widgetConfig.tsx":Li,"./Stopwatch/widgetConfig.tsx":$i,"./TicTacToe/widgetConfig.tsx":Ri,"./Timer/widgetConfig.tsx":Vi,"./TrafficLight/widgetConfig.tsx":qi,"./UnitConverter/widgetConfig.tsx":Yi,"./VceCommunity/widgetConfig.tsx":Qi,"./WikipediaSearch/widgetConfig.tsx":Zi,"./WorkGestures/widgetConfig.tsx":so,"./WorkList/widgetConfig.tsx":io}),Bt=Object.assign({"./Attendance/AttendanceWidget.tsx":()=>F(()=>import("./AttendanceWidget-CaWitwkI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25])),"./BoardLive/BoardLiveWidget.tsx":()=>F(()=>import("./BoardLiveWidget-CAZh2aSu.js"),__vite__mapDeps([26,1,2,27,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./Calendar/CalendarWidget.tsx":()=>F(()=>import("./CalendarWidget-ChZGfypu.js"),__vite__mapDeps([28,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./ChatgptIaEdu/ChatgptIaEduWidget.tsx":()=>F(()=>import("./ChatgptIaEduWidget-DjaXj4YP.js"),__vite__mapDeps([29,1,2,30,4,5,6,7,31,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./ClassDiary/ClassDiaryWidget.tsx":()=>F(()=>import("./ClassDiaryWidget-n9OyigNU.js"),__vite__mapDeps([32,1,2,30,4,5,6,7,31,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./Dice/DiceWidget.tsx":()=>F(()=>import("./DiceWidget-9H5r8-6D.js"),__vite__mapDeps([33,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,34])),"./DirectoEscala/DirectoEscalaWidget.tsx":()=>F(()=>import("./DirectoEscalaWidget-lHTdcwGz.js"),__vite__mapDeps([35,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoIdeas/DirectoIdeasWidget.tsx":()=>F(()=>import("./DirectoIdeasWidget-DXLND5Lv.js"),__vite__mapDeps([37,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoMuro/DirectoMuroWidget.tsx":()=>F(()=>import("./DirectoMuroWidget-DR71ofLM.js"),__vite__mapDeps([38,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoNube/DirectoNubeWidget.tsx":()=>F(()=>import("./DirectoNubeWidget-BHNvwt3-.js"),__vite__mapDeps([39,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoViewer/DirectoViewerWidget.tsx":()=>F(()=>import("./DirectoViewerWidget-DVt-F0gK.js"),__vite__mapDeps([40,1,2,36,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DirectoVota/DirectoVotaWidget.tsx":()=>F(()=>import("./DirectoVotaWidget-DW-ZoYvz.js"),__vite__mapDeps([41,1,2,27,4,5,6,36,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./DrawingPad/DrawingPadWidget.tsx":()=>F(()=>import("./DrawingPadWidget-DQoT7KdE.js"),__vite__mapDeps([42,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./EdiMarkWeb/EdiMarkWebWidget.tsx":()=>F(()=>import("./EdiMarkWebWidget-C4bI-Lmw.js"),__vite__mapDeps([43,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,44])),"./EduMediaIAG/EduMediaIAGWidget.tsx":()=>F(()=>import("./EduMediaIAGWidget-CRlQXp0B.js"),__vite__mapDeps([45,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,46])),"./FileOpener/FileOpenerWidget.tsx":()=>F(()=>import("./FileOpenerWidget-BO3xGqo1.js"),__vite__mapDeps([47,1,2,48,49,50,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,51])),"./GlobalClocks/GlobalClocksWidget.tsx":()=>F(()=>import("./GlobalClocksWidget-DvoS2ksm.js"),__vite__mapDeps([52,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,53])),"./GroupGenerator/GroupGeneratorWidget.tsx":()=>F(()=>import("./GroupGeneratorWidget-BY_gPaGd.js"),__vite__mapDeps([54,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,55])),"./HtmlSandbox/HtmlSandboxWidget.tsx":()=>F(()=>import("./HtmlSandboxWidget-C-06tWiu.js"),__vite__mapDeps([56,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,57])),"./Iframe/IframeWidget.tsx":()=>F(()=>import("./IframeWidget-NU_JmoYG.js"),__vite__mapDeps([58,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,59])),"./ImageCarousel/ImageCarouselWidget.tsx":()=>F(()=>import("./ImageCarouselWidget-C5EOFBLf.js"),__vite__mapDeps([60,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,61])),"./LatexMarkdown/LatexMarkdownWidget.tsx":()=>F(()=>import("./LatexMarkdownWidget-iJc_KcdC.js"),__vite__mapDeps([62,1,2,48,49,50,63,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,64])),"./LocalWeb/LocalWebWidget.tsx":()=>F(()=>import("./LocalWebWidget-De6B3N0G.js"),__vite__mapDeps([65,1,2,19,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21,22,23,24,66])),"./MemoryGame/MemoryGameWidget.tsx":()=>F(()=>import("./MemoryGameWidget-ucINRTvc.js"),__vite__mapDeps([67,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,68])),"./Metronome/MetronomeWidget.tsx":()=>F(()=>import("./MetronomeWidget-PYh2S2nK.js"),__vite__mapDeps([69,1,2,7,8,9,10,4,5,6,11,12,13,14,15,16,17,18,19,20,21,22,23,24,70])),"./Notepad/NotepadWidget.tsx":()=>F(()=>import("./NotepadWidget-y441YSHw.js"),__vite__mapDeps([71,1,2,72,8,9,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,48,107,4,5,6,7,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,108])),"./ProgramGuide/ProgramGuideWidget.tsx":()=>F(()=>import("./ProgramGuideWidget-OzLA9FWG.js"),__vite__mapDeps([109,1,2,48,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24,110])),"./QPlay/QPlayWidget.tsx":()=>F(()=>import("./QPlayWidget-zEn_0XvL.js"),__vite__mapDeps([111,1,2,27,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./QrCodeGenerator/QrCodeGeneratorWidget.tsx":()=>F(()=>import("./QrCodeGeneratorWidget-CLJDy-61.js"),__vite__mapDeps([112,1,2,113,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,114])),"./RandomSpinner/RandomSpinnerWidget.tsx":()=>F(()=>import("./RandomSpinnerWidget-CZlFvG7m.js"),__vite__mapDeps([115,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,116])),"./ScientificCalculator/ScientificCalculatorWidget.tsx":()=>F(()=>import("./ScientificCalculatorWidget-CgtNEEUZ.js"),__vite__mapDeps([117,1,2,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24,118])),"./Scoreboard/ScoreboardWidget.tsx":()=>F(()=>import("./ScoreboardWidget-CNudDMig.js"),__vite__mapDeps([119,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,120])),"./SlidingPuzzle/SlidingPuzzleWidget.tsx":()=>F(()=>import("./SlidingPuzzleWidget-CleICvj6.js"),__vite__mapDeps([121,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,122])),"./SoundMeter/SoundMeterWidget.tsx":()=>F(()=>import("./SoundMeterWidget-CIwzjGCR.js"),__vite__mapDeps([123,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,124])),"./Stopwatch/StopwatchWidget.tsx":()=>F(()=>import("./StopwatchWidget-BgAsVE_k.js"),__vite__mapDeps([125,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,126])),"./TicTacToe/TicTacToeWidget.tsx":()=>F(()=>import("./TicTacToeWidget-BtlPVMNq.js"),__vite__mapDeps([127,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,128])),"./Timer/TimerWidget.tsx":()=>F(()=>import("./TimerWidget-ClDpPBij.js"),__vite__mapDeps([129,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./TrafficLight/TrafficLightWidget.tsx":()=>F(()=>import("./TrafficLightWidget-nBFm1H1r.js"),__vite__mapDeps([130,1,2,4,5,6,8,9,10,7,11,12,13,14,15,16,17,18,19,20,21,22,23,24,131])),"./UnitConverter/UnitConverterWidget.tsx":()=>F(()=>import("./UnitConverterWidget-3aOF2WMD.js"),__vite__mapDeps([132,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,133])),"./VceCommunity/VceCommunityWidget.tsx":()=>F(()=>import("./VceCommunityWidget-CbH7dJ6o.js"),__vite__mapDeps([134,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,135])),"./WikipediaSearch/WikipediaSearchWidget.tsx":()=>F(()=>import("./WikipediaSearchWidget-5sO6H4QX.js"),__vite__mapDeps([136,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,137])),"./WorkGestures/WorkGesturesWidget.tsx":()=>F(()=>import("./WorkGesturesWidget-IC27OLVN.js"),__vite__mapDeps([138,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,139])),"./WorkList/WorkListWidget.tsx":()=>F(()=>import("./WorkListWidget-uwGhEjHd.js"),__vite__mapDeps([140,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])),"./shared/ExternalAppWidget.tsx":()=>F(()=>import("./ExternalAppWidget-CsdzeyYi.js"),__vite__mapDeps([27,1,2,4,5,6])),"./shared/LinkPortalWidget.tsx":()=>F(()=>import("./LinkPortalWidget-BmeMb2jA.js"),__vite__mapDeps([30,1,2,4,5,6,7,31]))}),ds={};for(const t in Rt){const s=Rt[t];if(!s||!s.widgetConfig){console.warn(`[Widget Registry] El módulo en "${t}" no parece ser un widget válido porque le falta la exportación 'widgetConfig'.`);continue}const i=s.widgetConfig,c=t.slice(0,t.lastIndexOf("/")),b=Object.keys(Bt).find(u=>u.startsWith(`${c}/`)&&u.endsWith("Widget.tsx"));if(!b){console.warn(`[Widget Registry] No se encontró un componente para la carpeta "${c}".`);continue}const p=Bt[b],l=r.lazy(async()=>{const u=await p(),g=Object.keys(u).find(x=>x.endsWith("Widget")),z=g?u[g]:u.default;if(!z)throw new Error(`[Widget Registry] El módulo "${b}" no exporta un componente válido.`);return{default:z}});ds[i.id]={...i,component:l}}const Ie=ds;function et(t,s){const[i,c]=r.useState(()=>{try{const p=window.localStorage.getItem(t);return p?JSON.parse(p):s}catch(p){return console.error(p),s}});return[i,p=>{try{const l=p instanceof Function?p(i):p;c(l),window.localStorage.setItem(t,JSON.stringify(l))}catch(l){console.error(l)}}]}const oo=({title:t,icon:s,children:i,position:c,size:b,zIndex:p,onDragStop:l,onResizeStop:u,onClose:g,onFocus:z,isMinimized:x,isMaximized:_,onToggleMinimize:o,onToggleMaximize:j,onOpenContextMenu:a,isPinned:S,onTogglePin:B,pinLabel:W,unpinLabel:q,isActive:te})=>{const[se,G]=ft.useState(!1),ue=x?{...b,height:40}:b,Q={zIndex:p,opacity:x?0:!x&&!te?.97:1,pointerEvents:x?"none":"auto",transform:x?"scale(0.98)":"scale(1)",transition:x?"width 220ms ease, height 220ms ease, opacity 220ms ease, transform 220ms ease":"opacity 120ms ease"},O=typeof s=="string"?e.jsx("img",{src:s,alt:"","aria-hidden":"true"}):s;return e.jsxs(nn,{size:ue,position:c,onDragStop:l,onResizeStop:u,minWidth:200,minHeight:x?40:150,disableDragging:_,enableResizing:!_&&!x,style:Q,onMouseDown:z,onMouseDownCapture:z,onDragStart:()=>z(),className:`widget-window bg-widget-bg rounded-lg border-2 border-widget-header relative ${te?"ring-2 ring-accent/70 shadow-2xl":"shadow-xl"}`,dragHandleClassName:"widget-header-drag-handle",bounds:"parent",children:[e.jsxs("div",{className:"widget-header flex items-center justify-between h-10 bg-widget-header text-text-light font-bold px-3 absolute top-0 left-0 right-0",onContextMenu:a,onDoubleClick:ae=>{ae.stopPropagation(),j()},onMouseEnter:()=>G(!0),onMouseLeave:()=>G(!1),children:[e.jsxs("span",{className:"widget-header-drag-handle flex-grow h-full cursor-move flex items-center gap-2",children:[O&&e.jsx("span",{className:"widget-header-icon",children:O}),e.jsx("span",{children:t})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[B&&se&&e.jsx("button",{onClick:B,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",title:S?q:W,"aria-label":S?q:W,children:S?e.jsx(bt,{size:18}):e.jsx(pt,{size:18})}),e.jsx("button",{onClick:o,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:e.jsx(Is,{size:18})}),e.jsx("button",{onClick:j,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:_?e.jsx(zs,{size:18}):e.jsx(Es,{size:18})}),e.jsx("button",{onClick:g,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:e.jsx(Pe,{size:18})})]})]}),!x&&e.jsx("div",{className:"absolute top-10 left-0 right-0 bottom-0 min-h-0 overflow-auto",children:i})]})},ro=({pinnedWidgets:t,onWidgetClick:s,onWidgetsClick:i,onOpenContextMenu:c,onReorderPinned:b,openWidgets:p,onTaskClick:l,onTaskContextMenu:u,isHidden:g=!1,isPeeking:z=!1,onMouseLeave:x,startButtonRef:_})=>{const{t:o}=L(),j=r.useRef(null),[a,S]=r.useState(null),[B,W]=r.useState(null),q=y=>y?.startTooltip?o(y.startTooltip):o(y.title),te=p.reduce((y,N)=>Math.max(y,N.zIndex),0),se=es(rt(is,{activationConstraint:{distance:8}}),rt(ns,{coordinateGetter:as})),G=t.filter(y=>Ie[y]),ue=p.map(y=>{const N=Ie[y.widgetId];if(!N)return null;const E=q(N);return{...y,title:o(N.title),icon:N.icon,label:E}}).filter(y=>!!y).sort((y,N)=>y.title.localeCompare(N.title)),Q=y=>{const{active:N,over:E}=y;if(!E||N.id===E.id)return;const V=G.indexOf(String(N.id)),U=G.indexOf(String(E.id));if(V===-1||U===-1)return;const ie=rs(G,V,U),ne=t.filter(Z=>!Ie[Z]);b([...ie,...ne])},O=({widgetId:y})=>{const N=Ie[y],{attributes:E,listeners:V,setNodeRef:U,transform:ie,transition:ne,isDragging:Z}=ls({id:y});if(!N)return null;const we={transform:Z?cs.Transform.toString(ie):void 0,transition:Z?ne:void 0},ze=q(N);return e.jsx("div",{ref:U,style:we,className:"flex-shrink-0",children:e.jsx("button",{onClick:()=>s(y),onContextMenu:ce=>{ce.stopPropagation(),c(ce,y)},"data-widget-button":"true",className:"group w-14 h-14 bg-accent text-2xl rounded-lg flex items-center justify-center hover:brightness-110 hover:scale-105",title:ze,...E,...V,children:e.jsx("span",{className:"transform-gpu group-hover:scale-110",children:N.icon})})})},ae=y=>{const N=y.target;N?.closest('[data-widget-button="true"]')||N?.closest('[data-task-button="true"]')||c(y,void 0,!0)};r.useLayoutEffect(()=>{const y=()=>{const N=j.current,E=_?.current;if(!N||!E){S(null),W(null);return}const V=8,U=N.getBoundingClientRect(),ie=E.getBoundingClientRect(),ne=window.innerWidth/2-U.width/2,Z=ie.right+V;if(ne<Z){const we=Math.max(240,window.innerWidth-Z-V);S(Z),W(we)}else S(null),W(null)};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[t,p,g,z,_]);const k=g&&!z?"0.75rem":"0rem";return e.jsxs("div",{ref:j,className:`fixed bottom-5 left-1/2 bg-widget-bg p-2 rounded-2xl flex items-center gap-3 shadow-lg z-[10000] border border-custom-border max-w-[calc(100vw-1rem)] transition-all duration-200 max-[700px]:hidden ${g&&!z?"opacity-0 pointer-events-none":"opacity-100"}`,style:{transform:`${a===null?"translate(-50%, ":"translate(0, "}${k})`,left:a===null?void 0:`${a}px`,maxWidth:B===null?void 0:`${B}px`},"data-toolbar":"true",onContextMenu:ae,onMouseLeave:x,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{sensors:se,collisionDetection:ss,onDragEnd:Q,children:e.jsx(os,{items:G,strategy:on,children:e.jsx("div",{className:"flex items-center gap-2",children:G.map(y=>e.jsx(O,{widgetId:y},y))})})}),e.jsx("button",{onClick:i,onContextMenu:y=>c(y,void 0,!0),className:"w-10 h-10 rounded-full text-text-light bg-black/20 hover:bg-black/30 transition-all duration-200 flex items-center justify-center flex-shrink-0",title:o("toolbar.widgetLibrary"),"aria-label":o("toolbar.widgetLibrary"),children:e.jsx(Jt,{size:18})})]}),ue.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-10 w-px bg-white/30"}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pr-1 min-w-0 flex-1",children:ue.map(y=>e.jsx("button",{type:"button",onClick:()=>l(y.instanceId),onContextMenu:N=>{N.stopPropagation(),u(N,y.instanceId)},"data-task-button":"true",className:`min-w-[120px] max-w-[180px] truncate px-3 py-2 rounded-lg border text-xs font-semibold transition ${y.isMinimized?"bg-white/60 border-gray-200 text-gray-500":y.zIndex===te?"bg-amber-100 border-amber-300 text-amber-800":"bg-white/90 border-gray-200 text-text-dark hover:bg-amber-50"}`,title:y.label,"aria-label":y.label,children:e.jsxs("span",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-sm leading-none",children:y.icon}),e.jsx("span",{className:"truncate",children:y.title})]})},y.instanceId))})]})]})},Vt=[{id:"organization",titleKey:"settings.widgets.categories.organization",widgetIds:["work-list","attendance","class-diary","group-generator","calendar"]},{id:"time",titleKey:"settings.widgets.categories.time",widgetIds:["timer","stopwatch","metronome","global-clocks"]},{id:"math_science",titleKey:"settings.widgets.categories.math_science",widgetIds:["scientific-calculator","unit-converter","latex-markdown"]},{id:"community",titleKey:"settings.widgets.categories.community",widgetIds:["vce-community","comunidad-chatgpt-ia-edu","edumedia-iag"]},{id:"board_writing",titleKey:"settings.widgets.categories.board_writing",widgetIds:["notepad","drawing-pad","image-carousel","edimarkweb","html-sandbox","boardlive"]},{id:"resources",titleKey:"settings.widgets.categories.resources",widgetIds:["iframe","local-web","pdf-viewer","file-opener","directo-viewer","wikipedia-search"]},{id:"interaction",titleKey:"settings.widgets.categories.interaction",widgetIds:["dice","random-spinner","qr-code-generator","traffic-light","sound-meter","scoreboard"]},{id:"participation",titleKey:"settings.widgets.categories.participation",widgetIds:["directo-vota","directo-escala","directo-nube","directo-ideas","directo-muro","qplay","boardlive"]},{id:"logic_games",titleKey:"settings.widgets.categories.logic_games",widgetIds:["tic-tac-toe","memory-game","sliding-puzzle"]},{id:"gestures",titleKey:"settings.widgets.categories.gestures",widgetIds:["work-gestures"]}],gs=(t,s)=>{const i=new Map(t.map(l=>[l.id,l])),c=Vt.map(l=>({...l,widgets:l.widgetIds.map(u=>i.get(u)).filter(u=>!!u).sort((u,g)=>s(u.title).localeCompare(s(g.title)))})),b=new Set(Vt.flatMap(l=>l.widgetIds)),p=t.filter(l=>!b.has(l.id)).sort((l,u)=>s(l.title).localeCompare(s(u.title)));return p.length>0&&c.push({id:"other",titleKey:"settings.widgets.categories.other",widgetIds:p.map(l=>l.id),widgets:p}),c},ao="/escritorio/assets/fondo01-1920-DQ9YqYXb.webp",lo="/escritorio/assets/fondo01-2560-BhYwScvF.webp",co="/escritorio/assets/fondo02-1920-CkNjKDZL.webp",go="/escritorio/assets/fondo02-2560-BHdQH5Tz.webp",uo="/escritorio/assets/fondo03-1920-6uaXYCMy.webp",mo="/escritorio/assets/fondo03-2560-D54ZlzdJ.webp",ho="/escritorio/assets/fondo04-1920-lLv979Fv.webp",fo="/escritorio/assets/fondo04-2560-CLLBOnYy.webp",bo="/escritorio/assets/fondo05-1920-CHlhzsPi.webp",po="/escritorio/assets/fondo05-2560-hgpnzGY3.webp",xo="/escritorio/assets/fondo06-1920-CQZ3V-je.webp",wo="/escritorio/assets/fondo06-2560-bB_z6UE8.webp",_o="/escritorio/assets/fondo07-1920-C8UIaOrN.webp",yo="/escritorio/assets/fondo07-2560-BYU5aKLI.webp",jo="/escritorio/assets/fondo08-1920-AdGMGon5.webp",vo="/escritorio/assets/fondo08-2560-CqfJPhF-.webp",ko="/escritorio/assets/fondo09-1920-B06QmLnf.webp",Co="/escritorio/assets/fondo09-2560-RakF4Xnz.webp",No="/escritorio/assets/fondo10-1920-Pkarw0Pa.webp",So="/escritorio/assets/fondo10-2560-CYpZFt1-.webp",Io="/escritorio/assets/fondo11-1920-DMUk-tk5.webp",zo="/escritorio/assets/fondo11-2560-BPq20Wq-.webp",Eo="/escritorio/assets/fondo12-1920-D-tqmJlT.webp",Wo="/escritorio/assets/fondo12-2560-CB3zOAPz.webp",Mo="/escritorio/assets/fondo13-1920-DOpAlvqG.webp",Oo="/escritorio/assets/fondo13-2560-CmSJaBRt.webp",Do="/escritorio/assets/fondo14-1920-CJl22m7O.webp",To="/escritorio/assets/fondo14-2560-D4bfWxAE.webp",Lo="/escritorio/assets/fondo15-1920-BKFORNdS.webp",Fo="/escritorio/assets/fondo15-2560-BO3wyQno.webp",Po="/escritorio/assets/fondo16-1920-DtfASKuP.webp",$o="/escritorio/assets/fondo16-2560-D2epzX5q.webp",Ao="/escritorio/assets/gemini-16uf0k16uf0k16uf-1920-Bkw3X8It.webp",Ro="/escritorio/assets/gemini-16uf0k16uf0k16uf-2560-BfXj68w3.webp",Bo="/escritorio/assets/gemini-2ap5fj2ap5fj2ap5-1920-a44PJlMO.webp",Vo="/escritorio/assets/gemini-2ap5fj2ap5fj2ap5-2560-6XLIb1DZ.webp",Ho="/escritorio/assets/gemini-9lvikq9lvikq9lvi-1920-DedAlMh6.webp",Ko="/escritorio/assets/gemini-9lvikq9lvikq9lvi-2560-Cl62r3ny.webp",qo="/escritorio/assets/gemini-louvkrlouvkrlouv-1920-DBK9_T9Y.webp",Go="/escritorio/assets/gemini-louvkrlouvkrlouv-2560-CKhcAHXA.webp",Uo="/escritorio/assets/gemini-xiejfxiejfxiejfx-1920-CJodUFDt.webp",Yo="/escritorio/assets/gemini-xiejfxiejfxiejfx-2560-rYumsXvf.webp",Xo="/escritorio/assets/gemini-yntaleyntaleynta-1920-BGyMXLie.webp",Qo="/escritorio/assets/gemini-yntaleyntaleynta-2560-KPkUYpwP.webp",Jo=Object.assign({"../assets/backgrounds/fondo01-1920.webp":ao,"../assets/backgrounds/fondo01-2560.webp":lo,"../assets/backgrounds/fondo02-1920.webp":co,"../assets/backgrounds/fondo02-2560.webp":go,"../assets/backgrounds/fondo03-1920.webp":uo,"../assets/backgrounds/fondo03-2560.webp":mo,"../assets/backgrounds/fondo04-1920.webp":ho,"../assets/backgrounds/fondo04-2560.webp":fo,"../assets/backgrounds/fondo05-1920.webp":bo,"../assets/backgrounds/fondo05-2560.webp":po,"../assets/backgrounds/fondo06-1920.webp":xo,"../assets/backgrounds/fondo06-2560.webp":wo,"../assets/backgrounds/fondo07-1920.webp":_o,"../assets/backgrounds/fondo07-2560.webp":yo,"../assets/backgrounds/fondo08-1920.webp":jo,"../assets/backgrounds/fondo08-2560.webp":vo,"../assets/backgrounds/fondo09-1920.webp":ko,"../assets/backgrounds/fondo09-2560.webp":Co,"../assets/backgrounds/fondo10-1920.webp":No,"../assets/backgrounds/fondo10-2560.webp":So,"../assets/backgrounds/fondo11-1920.webp":Io,"../assets/backgrounds/fondo11-2560.webp":zo,"../assets/backgrounds/fondo12-1920.webp":Eo,"../assets/backgrounds/fondo12-2560.webp":Wo,"../assets/backgrounds/fondo13-1920.webp":Mo,"../assets/backgrounds/fondo13-2560.webp":Oo,"../assets/backgrounds/fondo14-1920.webp":Do,"../assets/backgrounds/fondo14-2560.webp":To,"../assets/backgrounds/fondo15-1920.webp":Lo,"../assets/backgrounds/fondo15-2560.webp":Fo,"../assets/backgrounds/fondo16-1920.webp":Po,"../assets/backgrounds/fondo16-2560.webp":$o,"../assets/backgrounds/gemini-16uf0k16uf0k16uf-1920.webp":Ao,"../assets/backgrounds/gemini-16uf0k16uf0k16uf-2560.webp":Ro,"../assets/backgrounds/gemini-2ap5fj2ap5fj2ap5-1920.webp":Bo,"../assets/backgrounds/gemini-2ap5fj2ap5fj2ap5-2560.webp":Vo,"../assets/backgrounds/gemini-9lvikq9lvikq9lvi-1920.webp":Ho,"../assets/backgrounds/gemini-9lvikq9lvikq9lvi-2560.webp":Ko,"../assets/backgrounds/gemini-louvkrlouvkrlouv-1920.webp":qo,"../assets/backgrounds/gemini-louvkrlouvkrlouv-2560.webp":Go,"../assets/backgrounds/gemini-xiejfxiejfxiejfx-1920.webp":Uo,"../assets/backgrounds/gemini-xiejfxiejfxiejfx-2560.webp":Yo,"../assets/backgrounds/gemini-yntaleyntaleynta-1920.webp":Xo,"../assets/backgrounds/gemini-yntaleyntaleynta-2560.webp":Qo}),ot={},Zo=/\/([^/]+?)(?:-(\d+))?\.webp$/;Object.entries(Jo).forEach(([t,s])=>{const i=t.match(Zo);if(!i)return;const c=i[1],b=i[2]?Number(i[2]):0;ot[c]||(ot[c]={}),ot[c][b]=s});const er=["gemini-9lvikq9lvikq9lvi","gemini-16uf0k16uf0k16uf","gemini-louvkrlouvkrlouv","gemini-xiejfxiejfxiejfx","gemini-2ap5fj2ap5fj2ap5","gemini-yntaleyntaleynta"],Ht=new Map(er.map((t,s)=>[t,s])),at=Object.entries(ot).map(([t,s])=>{const i=Object.keys(s).map(Number).sort((b,p)=>b-p),c=i[0];return{id:t,sizes:i,urlsBySize:s,previewUrl:s[c],urls:i.map(b=>s[b])}}).sort((t,s)=>{const i=Ht.get(t.id),c=Ht.get(s.id);return i!=null&&c!=null?i-c:i!=null?-1:c!=null?1:t.id.localeCompare(s.id)}),tr=()=>typeof window>"u"?1920:Math.floor(window.innerWidth*(window.devicePixelRatio||1)),sr=t=>{const s=tr(),c=t.sizes.find(b=>b>=s)??t.sizes[t.sizes.length-1];return t.urlsBySize[c]},us=t=>`url(${sr(t)})`,nr=new Set(at.flatMap(t=>t.urls.map(s=>`url(${s})`))),ir=t=>nr.has(t),or="gemini-9lvikq9lvikq9lvi",Kt=at.find(t=>t.id===or)??at[0],ms=Kt?us(Kt):"none",Ze={"--color-bg":"#FFFFFF","--color-widget-bg":"#00809D","--color-widget-header":"#D3AF37","--color-accent":"#FFD700","--color-text-light":"#FCF8DD","--color-text-dark":"#1a202c","--color-border":"#FFFFFF","--wallpaper":ms,"--font-scale":"1",showDateTime:!0,showSystemStats:!1,showProfileSwitcher:!0,highContrast:!1},hs=r.createContext(void 0),rr=({children:t,value:s})=>e.jsx(hs.Provider,{value:s,children:t}),_t=()=>{const t=r.useContext(hs);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},ar=()=>{const{t}=L(),{theme:s,setTheme:i,defaultTheme:c}=_t(),b=_=>{const{name:o,value:j}=_.target;i({...s,[o]:j})},p=_=>{const{checked:o}=_.target;i(j=>({...j,highContrast:o}))},l=_=>{const{value:o}=_.target;i(j=>({...j,"--font-scale":o}))},u=[{id:"classic",labelKey:"settings.theme.presets.classic",colors:{"--color-bg":c["--color-bg"],"--color-widget-bg":c["--color-widget-bg"],"--color-widget-header":c["--color-widget-header"],"--color-accent":c["--color-accent"],"--color-text-light":c["--color-text-light"],"--color-text-dark":c["--color-text-dark"],"--color-border":c["--color-border"]}},{id:"chalkboard",labelKey:"settings.theme.presets.chalkboard",colors:{"--color-bg":"#122B39","--color-widget-bg":"#1F4E5F","--color-widget-header":"#F4B860","--color-accent":"#F7D07A","--color-text-light":"#F7F4EA","--color-text-dark":"#0B1B21","--color-border":"#122B39"}},{id:"slate",labelKey:"settings.theme.presets.slate",colors:{"--color-bg":"#232136","--color-widget-bg":"#3A355A","--color-widget-header":"#9E7FB2","--color-accent":"#F6C177","--color-text-light":"#F5F2FF","--color-text-dark":"#14111F","--color-border":"#232136"}},{id:"sand",labelKey:"settings.theme.presets.sand",colors:{"--color-bg":"#FFF3D9","--color-widget-bg":"#FF7A5C","--color-widget-header":"#2B7A78","--color-accent":"#F5D547","--color-text-light":"#FFF8EA","--color-text-dark":"#2B1D0E","--color-border":"#F3E2BF"}},{id:"ocean",labelKey:"settings.theme.presets.ocean",colors:{"--color-bg":"#E9F4FF","--color-widget-bg":"#2F80ED","--color-widget-header":"#1B3A57","--color-accent":"#FFB703","--color-text-light":"#F8F9FB","--color-text-dark":"#0E1A24","--color-border":"#D7E8FF"}},{id:"confetti",labelKey:"settings.theme.presets.confetti",colors:{"--color-bg":"#FFF6F9","--color-widget-bg":"#FF6B6B","--color-widget-header":"#6BCB77","--color-accent":"#4D96FF","--color-text-light":"#FFFFFF","--color-text-dark":"#2B2D42","--color-border":"#FDE3EC"}},{id:"sunrise",labelKey:"settings.theme.presets.sunrise",colors:{"--color-bg":"#FFE8D6","--color-widget-bg":"#FF7F50","--color-widget-header":"#6C5B7B","--color-accent":"#F9C74F","--color-text-light":"#FFF7EA","--color-text-dark":"#2D1E1E","--color-border":"#F6D3C1"}},{id:"berry",labelKey:"settings.theme.presets.berry",colors:{"--color-bg":"#F6ECFF","--color-widget-bg":"#7B2CBF","--color-widget-header":"#FAD643","--color-accent":"#FF70A6","--color-text-light":"#FDF7FF","--color-text-dark":"#221133","--color-border":"#EAD9FF"}},{id:"mint",labelKey:"settings.theme.presets.mint",colors:{"--color-bg":"#E8FFF7","--color-widget-bg":"#2A9D8F","--color-widget-header":"#264653","--color-accent":"#E9C46A","--color-text-light":"#F7FFFB","--color-text-dark":"#0E1F20","--color-border":"#D2F3E7"}}],g=_=>{i(o=>({...o,..._.colors}))},z=_=>Object.entries(_.colors).every(([o,j])=>s[o]===j),x=[{id:"--color-bg",labelKey:"desktop_bg"},{id:"--color-widget-bg",labelKey:"widget_bg"},{id:"--color-widget-header",labelKey:"widget_header"},{id:"--color-accent",labelKey:"accent"},{id:"--color-text-light",labelKey:"text_light"},{id:"--color-text-dark",labelKey:"text_dark"}];return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("settings.theme.accessibility_title")}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t("settings.theme.accessibility_help")}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("label",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t("settings.theme.high_contrast")}),e.jsx("input",{type:"checkbox",checked:!!s.highContrast,onChange:p,className:"h-4 w-4 rounded border-gray-300 accent-accent"})]}),e.jsxs("label",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t("settings.theme.font_scale")}),e.jsxs("select",{value:s["--font-scale"],onChange:l,className:"p-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none",children:[e.jsx("option",{value:"0.9",children:t("settings.theme.font_scale_90")}),e.jsx("option",{value:"1",children:t("settings.theme.font_scale_100")}),e.jsx("option",{value:"1.1",children:t("settings.theme.font_scale_110")}),e.jsx("option",{value:"1.25",children:t("settings.theme.font_scale_125")}),e.jsx("option",{value:"1.5",children:t("settings.theme.font_scale_150")})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("settings.theme.presets_title")}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t("settings.theme.presets_help")}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:u.map(_=>{const o=z(_);return e.jsxs("button",{type:"button",onClick:()=>g(_),className:`text-left p-3 rounded-lg border transition-all ${o?"border-accent ring-2 ring-accent":"border-gray-200 hover:border-gray-400"}`,"aria-pressed":o,children:[e.jsxs("div",{className:"h-14 rounded-md overflow-hidden border border-black/10 mb-2",style:{backgroundColor:_.colors["--color-bg"]},children:[e.jsx("div",{style:{backgroundColor:_.colors["--color-widget-header"]},className:"h-4"}),e.jsxs("div",{className:"flex h-10",children:[e.jsx("div",{style:{backgroundColor:_.colors["--color-widget-bg"]},className:"flex-1"}),e.jsx("div",{style:{backgroundColor:_.colors["--color-accent"]},className:"w-6"})]})]}),e.jsx("span",{className:"text-sm font-semibold",children:t(_.labelKey)})]},_.id)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t("settings.theme.theme_colors_title")}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:x.map(({id:_,labelKey:o})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:_,className:"text-sm",children:t(`settings.theme.colors.${o}`)}),e.jsx("input",{type:"color",id:_,name:_,value:s[_],onChange:b,className:"theme-color-input"})]},_))})]})]})},lr=({isOpen:t,onClose:s})=>{const{t:i}=L();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10002] flex items-center justify-center",onClick:c=>{c.stopPropagation(),s()},children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("settings.theme.modal_title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx(Pe,{size:20})})]}),e.jsx("div",{className:"overflow-y-auto",children:e.jsx(ar,{})})]})}):null},cr="escritorio-digital",lt="kv",dr=1;let ut=null;const gr=()=>(ut||(ut=new Promise((t,s)=>{const i=window.indexedDB.open(cr,dr);i.onupgradeneeded=()=>{const c=i.result;c.objectStoreNames.contains(lt)||c.createObjectStore(lt)},i.onsuccess=()=>t(i.result),i.onerror=()=>s(i.error)})),ut),yt=async(t,s)=>{const i=await gr();return new Promise((c,b)=>{const l=i.transaction(lt,t).objectStore(lt),u=s(l);u.onsuccess=()=>c(u.result),u.onerror=()=>b(u.error)})},fs=async t=>await yt("readonly",i=>i.get(t))??null,qt=async(t,s)=>{await yt("readwrite",i=>i.put(s,t))},bs=async t=>{await yt("readwrite",s=>s.delete(t))},wt="__indexed_db__",ur=2e5,mr=1,tt=["work-list-tasks","spinner-options","notepad-content-html","image-carousel-images","tictactoe-players","tictactoe-score","global-clocks-selection","attendance-records","traffic-light-state","scoreboard-players","toolbar-hidden","i18nextLng","profile-order","widgets-view-mode"],hr="escritorio-digital-sites",fr=1,pe="sites",xe="files";let mt=null;const Ue=()=>(mt||(mt=new Promise((t,s)=>{const i=window.indexedDB.open(hr,fr);i.onupgradeneeded=()=>{const c=i.result;c.objectStoreNames.contains(pe)||c.createObjectStore(pe,{keyPath:"id"}),c.objectStoreNames.contains(xe)||c.createObjectStore(xe,{keyPath:"key"}).createIndex("siteId","siteId",{unique:!1})},i.onsuccess=()=>t(i.result),i.onerror=()=>s(i.error)})),mt),br=t=>{const s=atob(t),i=new Uint8Array(s.length);for(let c=0;c<s.length;c+=1)i[c]=s.charCodeAt(c);return i.buffer},pr=async t=>{const s={};for(const i of t){const c=window.localStorage.getItem(i);if(c)if(c===wt){const b=await fs(i);if(b==null)continue;s[i]={storage:"indexedDb",value:b}}else s[i]={storage:"localStorage",value:c}}return s},xr=async t=>{for(const[s,i]of Object.entries(t)){if(i.storage==="indexedDb"){await qt(s,i.value),window.localStorage.setItem(s,wt);continue}if(i.value.length>ur){await qt(s,i.value),window.localStorage.setItem(s,wt);continue}window.localStorage.setItem(s,i.value),await bs(s)}},wr=async(t,s)=>{const i=await Ue();return new Promise((c,b)=>{const p=i.transaction([pe,xe],"readonly"),l=p.objectStore(pe).getAll(),u=p.objectStore(xe).getAll();p.oncomplete=()=>{const g=l.result??[],z=u.result??[],_=(t&&t.length>0?g.filter(a=>!a.profileName||t.includes(a.profileName)):g).map(a=>({...a,profileName:a.profileName??s})),o=new Set(_.map(a=>a.id)),j=z.filter(a=>o.has(a.siteId)).map(a=>({...a,profileName:a.profileName??s}));c({sites:_,files:j})},p.onerror=()=>b(p.error)})},ht=async(t,s)=>{const i=await Ue();return new Promise((c,b)=>{const p=i.transaction([pe,xe],"readonly"),l=p.objectStore(pe).getAll(),u=p.objectStore(xe).getAll();p.oncomplete=()=>{const g=l.result??[],z=u.result??[],x=t&&t.length>0?g.filter(a=>!a.profileName||t.includes(a.profileName)):g,_=new Set(x.map(a=>a.id)),o=x.reduce((a,S)=>a+(S.totalBytes||0),0),j=z.filter(a=>_.has(a.siteId)).reduce((a,S)=>a+(S.size||0),0);c({siteCount:x.length,totalBytes:j>0?j:o})},p.onerror=()=>b(p.error)})},ps=async()=>{const t=await Ue();await new Promise((s,i)=>{const c=t.transaction([pe,xe],"readwrite");c.objectStore(pe).clear(),c.objectStore(xe).clear(),c.oncomplete=()=>s(),c.onerror=()=>i(c.error)})},_r=async(t,s)=>{const i=await Ue();await new Promise((c,b)=>{const p=i.transaction([pe,xe],"readwrite"),l=p.objectStore(pe),u=p.objectStore(xe);t.sites.forEach(g=>{const x=(g.profileName&&s?.profileNameMap?.get(g.profileName))??g.profileName??s?.fallbackProfileName;l.put({...g,profileName:x})}),t.files.forEach(g=>{const x=(g.profileName&&s?.profileNameMap?.get(g.profileName))??g.profileName??s?.fallbackProfileName,_=br(g.dataBase64),o=new Blob([_],{type:g.type});u.put({key:g.key,siteId:g.siteId,path:g.path,blob:o,size:g.size,type:g.type,profileName:x})}),p.oncomplete=()=>c(),p.onerror=()=>b(p.error)})},yr=async(t,s)=>{const i=await Ue();if(s?.signal?.aborted)throw new Error("abort");await new Promise((l,u)=>{const g=i.transaction(pe,"readwrite"),z=g.objectStore(pe);t.sites.forEach(x=>{const o=(x.profileName&&s?.profileNameMap?.get(x.profileName))??x.profileName??s?.fallbackProfileName;z.put({...x,profileName:o})}),g.oncomplete=()=>l(),g.onerror=()=>u(g.error)});const c=t.files.length,b=50;let p=0;for(let l=0;l<t.files.length;l+=b){if(s?.signal?.aborted)throw new Error("abort");const u=t.files.slice(l,l+b);await new Promise((g,z)=>{const x=i.transaction(xe,"readwrite"),_=x.objectStore(xe);u.forEach(o=>{const a=(o.profileName&&s?.profileNameMap?.get(o.profileName))??o.profileName??s?.fallbackProfileName;_.put({key:o.key,siteId:o.siteId,path:o.path,blob:o.blob,size:o.size,type:o.type,profileName:a})}),x.oncomplete=()=>g(),x.onerror=()=>z(x.error)}),p+=u.length,s?.onProgress&&s.onProgress(p,c),s?.yieldControl&&await s.yieldControl()}},xs=t=>({meta:{app:"Escritorio Digital",version:mr,createdAt:new Date().toISOString()},data:t}),ws=t=>{if(!t||typeof t!="object")return!1;const s=t;return!(!s.meta||!s.data||typeof s.meta.app!="string"||typeof s.meta.version!="number"||typeof s.meta.createdAt!="string"||typeof s.data!="object")},jr=t=>{const s=new Uint8Array(t);return s.length>=4&&s[0]===80&&s[1]===75&&s[2]===3&&s[3]===4},vr=async(t,s,i,c,b)=>{const p=xs(t),l=[];await new Promise((x,_)=>{const o=new an((a,S,B)=>{if(a){_(a);return}S&&l.push(S),B&&x()}),j=(a,S)=>{const B=new cn(a,{level:6});o.add(B),B.push(S,!0)};(async()=>{try{if(j("manifest.json",Ft(JSON.stringify(p))),s){const a=s.files.map(W=>({key:W.key,siteId:W.siteId,path:W.path,type:W.type,size:W.size,profileName:W.profileName}));j("localWeb/meta.json",Ft(JSON.stringify({sites:s.sites,files:a})));const S=s.files.length;let B=0;for(const W of s.files){if(b?.aborted){_(new Error("abort"));return}const q=await W.blob.arrayBuffer();j(`localWeb/files/${W.key}`,new Uint8Array(q)),B+=1,i&&i(B,S),c&&await c()}}o.end()}catch(a){_(a)}})()});const u=l.reduce((x,_)=>x+_.length,0),g=new Uint8Array(u);let z=0;return l.forEach(x=>{g.set(x,z),z+=x.length}),g},kr=t=>{const s=ln(new Uint8Array(t)),i=s["manifest.json"];if(!i)throw new Error("missing manifest");const c=JSON.parse(Pt(i));if(!ws(c))throw new Error("invalid payload");const b=s["localWeb/meta.json"];if(!b)return{payload:c};const p=JSON.parse(Pt(b)),l=[];return p.files.forEach(u=>{const g=s[`localWeb/files/${u.key}`];g&&l.push({...u,profileName:u.profileName,blob:new Blob([g],{type:u.type})})}),{payload:c,localWeb:{sites:p.sites??[],files:l}}},Cr=async(t,s)=>{const i=await Ue(),{sites:c,files:b}=await new Promise((x,_)=>{const o=i.transaction([pe,xe],"readonly"),j=o.objectStore(pe).getAll(),a=o.objectStore(xe).getAll();o.oncomplete=()=>{x({sites:j.result??[],files:a.result??[]})},o.onerror=()=>_(o.error)}),p=Date.now(),l=c.filter(x=>x.profileName===t||!x.profileName);if(l.length===0)return;const u=new Map,g=l.map(x=>{const _=crypto.randomUUID();return u.set(x.id,_),{...x,id:_,profileName:s,createdAt:p,updatedAt:p}}),z=b.filter(x=>u.has(x.siteId)).map(x=>{const _=u.get(x.siteId);return{...x,key:`${_}::${x.path}`,siteId:_,profileName:s}});await new Promise((x,_)=>{const o=i.transaction([pe,xe],"readwrite"),j=o.objectStore(pe),a=o.objectStore(xe);l.forEach(S=>{S.profileName||j.put({...S,profileName:t})}),g.forEach(S=>j.put(S)),z.forEach(S=>{a.put({key:S.key,siteId:S.siteId,path:S.path,blob:S.blob,size:S.size,type:S.type,profileName:S.profileName})}),o.oncomplete=()=>x(),o.onerror=()=>_(o.error)})},Nr=({profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,onCloseSettings:b,profileOrder:p,setProfileOrder:l})=>{const{t:u}=L(),[g,z]=r.useState(""),[x,_]=r.useState("empty"),[o,j]=r.useState(null),[a,S]=r.useState(""),{theme:B}=_t(),W=["work-list","timer","file-opener","vce-community"],q="Escritorio Principal",te=p.filter(k=>t[k]);Object.keys(t).forEach(k=>{te.includes(k)||te.push(k)});const se=k=>k===q?u("settings.profiles.default_name"):k,G=async()=>{const k=g.trim();if(k&&!t[k]){const y=t[i],N=x==="clone"?{...y,theme:B}:{theme:Ze,activeWidgets:[],pinnedWidgets:W,vceFavorites:[]};if(s(E=>({...E,[k]:{...N}})),l(E=>[...E,k]),x==="clone")try{await Cr(i,k)}catch(E){console.error(E)}c(k),z("")}else alert(u("settings.profiles.invalid_name_alert"))},ue=k=>{if(Object.keys(t).length<=1){alert(u("settings.profiles.delete_last_alert"));return}const y=se(k);if(window.confirm(u("settings.profiles.delete_confirm",{name:y}))){const N={...t};delete N[k],s(N),l(E=>E.filter(V=>V!==k)),i===k&&c(Object.keys(N)[0])}},Q=()=>{j(null),S("")},O=k=>{const y=a.trim();if(!y){alert(u("settings.profiles.invalid_name_alert"));return}if(y===k){Q();return}if(t[y]){alert(u("settings.profiles.invalid_name_alert"));return}s(N=>{const E={...N},V=E[k];return V?(delete E[k],E[y]=V,E):N}),l(N=>N.map(E=>E===k?y:E)),i===k&&c(y),Q()},ae=(k,y)=>{l(N=>{const E=N.filter(Z=>t[Z]),V=E.indexOf(k);if(V===-1)return N;const U=y==="up"?V-1:V+1;if(U<0||U>=E.length)return N;const ie=[...E],[ne]=ie.splice(V,1);return ie.splice(U,0,ne),ie})};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:u("settings.profiles.save_current_title")}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:u("settings.profiles.create_mode_label")}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"profile-create-mode",value:"empty",checked:x==="empty",onChange:()=>_("empty")}),e.jsx("span",{children:u("settings.profiles.create_mode_empty")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"profile-create-mode",value:"clone",checked:x==="clone",onChange:()=>_("clone")}),e.jsx("span",{children:u("settings.profiles.create_mode_clone")})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:k=>z(k.target.value),placeholder:u("settings.profiles.new_profile_placeholder"),className:"flex-grow bg-white border-2 border-gray-300 rounded p-2 focus:border-accent outline-none text-sm"}),e.jsx("button",{onClick:G,className:"font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark",children:u("settings.profiles.save_button")})]})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>{b(),window.dispatchEvent(new CustomEvent("open-profile-backup",{detail:{tab:"export"}}))},className:"w-full text-left px-3 py-2 rounded-lg bg-white border border-gray-300 text-sm text-text-dark hover:bg-gray-100 transition-colors shadow-sm",children:u("backup.manage_profiles")})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:u("settings.profiles.saved_profiles_title")}),e.jsx("ul",{className:"space-y-2",children:te.map((k,y)=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[o===k?e.jsx("input",{type:"text",value:a,onChange:N=>S(N.target.value),onBlur:()=>O(k),onKeyDown:N=>{N.key==="Enter"&&O(k),N.key==="Escape"&&Q()},placeholder:u("settings.profiles.rename_placeholder"),className:"flex-grow bg-white border-2 border-gray-300 rounded p-2 focus:border-accent outline-none text-sm"}):e.jsx("div",{onDoubleClick:()=>{j(k),S(k)},className:"flex-grow font-semibold cursor-text rounded px-2 py-1 hover:bg-white/60",title:u("settings.profiles.rename_hint"),children:se(k)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ae(k,"up"),disabled:y===0,className:"p-2 rounded-lg bg-white border border-gray-200 text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed",title:u("settings.profiles.move_up"),"aria-label":u("settings.profiles.move_up"),children:e.jsx(Ws,{size:16})}),e.jsx("button",{onClick:()=>ae(k,"down"),disabled:y===te.length-1,className:"p-2 rounded-lg bg-white border border-gray-200 text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed",title:u("settings.profiles.move_down"),"aria-label":u("settings.profiles.move_down"),children:e.jsx(Ms,{size:16})}),e.jsx("button",{onClick:()=>c(k),disabled:k===i,className:"p-2 rounded-lg bg-blue-500 text-white disabled:opacity-50",title:u(k===i?"settings.profiles.active_button":"settings.profiles.load_button"),"aria-label":u(k===i?"settings.profiles.active_button":"settings.profiles.load_button"),children:k===i?e.jsx(Os,{size:16}):e.jsx(Ds,{size:16})}),e.jsx("button",{onClick:()=>ue(k),className:"p-2 rounded-lg bg-red-500 text-white",title:u("settings.profiles.delete_button"),"aria-label":u("settings.profiles.delete_button"),children:e.jsx(Ts,{size:16})})]})]},k))})]})]})},Sr=({isOpen:t,onClose:s,initialTab:i="general",themeModalRequestId:c,pinnedWidgets:b,setPinnedWidgets:p,profiles:l,setProfiles:u,activeProfileName:g,setActiveProfileName:z,profileOrder:x,setProfileOrder:_})=>{const{t:o,i18n:j}=L(),[a,S]=r.useState("general"),[B,W]=r.useState(""),[q,te]=et("widgets-view-mode","theme"),[se,G]=r.useState(!1),ue=r.useRef(null),{theme:Q,setTheme:O,setWallpaper:ae,resetTheme:k}=_t(),y=r.useRef(null),N=r.useRef(null);r.useEffect(()=>{t&&S(i)},[t,i]),r.useEffect(()=>{if(!t||a!=="widgets")return;const w=window.requestAnimationFrame(()=>{N.current?.focus()});return()=>window.cancelAnimationFrame(w)},[t,a]),r.useEffect(()=>{t||G(!1)},[t]),r.useEffect(()=>{!t||c==null||c<=0||ue.current!==c&&(ue.current=c,S("theme"),G(!0))},[t,c]);const E=w=>{const M=w.target.files?.[0];if(M){const X=new FileReader;X.onload=ee=>{const he=ee.target?.result;ae(`url(${he})`)},X.readAsDataURL(M)}},V=w=>{const{checked:M}=w.target;O(X=>({...X,showDateTime:M}))},U=w=>{const{checked:M}=w.target;O(X=>({...X,showSystemStats:M}))},ie=w=>{const{checked:M}=w.target;O(X=>({...X,showProfileSwitcher:M}))},ne=w=>{const{value:M}=w.target;O({...Q,"--color-bg":M,"--wallpaper":"none"})},Z=r.useCallback(w=>w.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),[]),we=r.useMemo(()=>{const w=Z(B.trim());return Object.values(Ie).filter(X=>{if(!B.trim())return!0;const ee=Z(o(X.title)),he=X.startTooltip?Z(o(X.startTooltip)):"",_e=(X.searchKeywords||[]).flatMap(de=>o(de).split(",")).map(de=>Z(de.trim())).filter(Boolean).some(de=>de.includes(w));return ee.includes(w)||he.includes(w)||_e}).sort((X,ee)=>o(X.title).localeCompare(o(ee.title)))},[Z,B,o]),ze=r.useMemo(()=>gs(we,o),[we,o]),ce=20,De=Object.keys(Ie).length,me=w=>{p(M=>M.includes(w)?M.filter(X=>X!==w):M.length<ce?[...M,w]:(alert(o("settings.widgets.max_widgets_alert",{max:ce})),M))},T=w=>{const M=w.target.value;j.changeLanguage(M)},A=async()=>{if(!window.confirm(o("settings.general.reset_confirm")))return;const w=Array.from(new Set(["desktop-profiles","active-profile-name",...tt]));try{w.forEach(M=>window.localStorage.removeItem(M)),await Promise.all(tt.map(M=>bs(M))),await ps()}catch(M){console.warn("No se pudieron limpiar las preferencias locales.",M)}window.location.reload()};return e.jsxs(dn,{children:[t&&e.jsx($t.div,{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:e.jsxs($t.div,{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col",onClick:w=>w.stopPropagation(),initial:{scale:.7,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.7,opacity:0},transition:{type:"spring",stiffness:100,damping:10},children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:o("settings.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx(Pe,{size:20})})]}),e.jsxs("div",{className:"flex border-b",children:[e.jsx("button",{onClick:()=>S("general"),className:`flex-1 p-3 font-semibold ${a==="general"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.general")}),e.jsx("button",{onClick:()=>S("profiles"),className:`flex-1 p-3 font-semibold ${a==="profiles"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.profiles")}),e.jsx("button",{onClick:()=>S("widgets"),className:`flex-1 p-3 font-semibold ${a==="widgets"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.widgets")}),e.jsx("button",{onClick:()=>S("theme"),className:`flex-1 p-3 font-semibold ${a==="theme"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.theme")})]}),e.jsxs("div",{className:"overflow-y-auto px-4 pb-4 pt-0",children:[a==="general"&&e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:o("settings.tabs.general")}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{htmlFor:"language-select",className:"font-medium",children:[o("settings.general.language"),":"]}),e.jsxs("select",{id:"language-select",value:j.language,onChange:T,className:"p-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none",children:[e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"ca",children:"Català"}),e.jsx("option",{value:"eu",children:"Euskara"}),e.jsx("option",{value:"gl",children:"Galego"}),e.jsx("option",{value:"pt",children:"Português"}),e.jsx("option",{value:"fr",children:"Français"}),e.jsx("option",{value:"it",children:"Italiano"}),e.jsx("option",{value:"de",children:"Deutsch"}),e.jsx("option",{value:"en",children:"English"})]})]}),e.jsxs("div",{className:"mt-6 p-4 border border-red-300 rounded-lg bg-red-50",children:[e.jsx("h4",{className:"font-semibold text-red-700 mb-2",children:o("settings.general.reset_title")}),e.jsx("p",{className:"text-sm text-red-700 mb-3",children:o("settings.general.reset_description")}),e.jsx("button",{onClick:A,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:o("settings.general.reset_button")})]})]}),a==="profiles"&&e.jsx("div",{className:"pt-4",children:e.jsx(Nr,{profiles:l,setProfiles:u,activeProfileName:g,setActiveProfileName:z,onCloseSettings:s,profileOrder:x,setProfileOrder:_})}),a==="widgets"&&e.jsxs("div",{children:[e.jsxs("div",{className:"sticky top-0 z-10 -mx-4 px-4 pt-4 pb-4 bg-white/90 backdrop-blur border-b border-black/5 mb-4",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx(Ls,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:o("settings.widgets.search"),value:B,onChange:w=>W(w.target.value),ref:N,className:"w-full pl-10 pr-4 py-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:o("settings.widgets.view_label")}),e.jsxs("div",{className:"flex rounded-lg border border-gray-200 overflow-hidden bg-white/70",children:[e.jsx("button",{type:"button",onClick:()=>te("theme"),className:`px-3 py-1.5 text-sm font-semibold transition-colors ${q==="theme"?"bg-accent text-text-dark":"text-gray-600 hover:bg-gray-100"}`,children:o("settings.widgets.view_by_theme")}),e.jsx("button",{type:"button",onClick:()=>te("alphabetical"),className:`px-3 py-1.5 text-sm font-semibold transition-colors ${q==="alphabetical"?"bg-accent text-text-dark":"text-gray-600 hover:bg-gray-100"}`,children:o("settings.widgets.view_alphabetical")})]})]})]}),e.jsx("p",{className:"mb-4 text-sm text-gray-600",children:o("settings.widgets.pinned_info",{count:b.length,max:ce,total:De})}),q==="alphabetical"?e.jsx("ul",{className:"space-y-2",children:we.map(w=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:w.icon}),e.jsx("span",{className:"font-semibold",children:o(w.title)})]}),e.jsx("button",{onClick:()=>me(w.id),className:`font-semibold py-2 px-4 rounded-lg transition-colors ${b.includes(w.id)?"bg-widget-header text-text-light hover:bg-[#7b69b1]":"bg-accent text-text-dark hover:bg-[#8ec9c9]"}`,children:b.includes(w.id)?o("settings.widgets.remove"):o("settings.widgets.add")})]},w.id))}):e.jsx("div",{className:"space-y-5",children:ze.filter(w=>w.widgets.length>0).map(w=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2 uppercase tracking-wide",children:o(w.titleKey)}),e.jsx("ul",{className:"space-y-2",children:w.widgets.map(M=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:M.icon}),e.jsx("span",{className:"font-semibold",children:o(M.title)})]}),e.jsx("button",{onClick:()=>me(M.id),className:`font-semibold py-2 px-4 rounded-lg transition-colors ${b.includes(M.id)?"bg-widget-header text-text-light hover:bg-[#7b69b1]":"bg-accent text-text-dark hover:bg-[#8ec9c9]"}`,children:b.includes(M.id)?o("settings.widgets.remove"):o("settings.widgets.add")})]},M.id))})]},w.id))})]}),a==="theme"&&e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"p-4 bg-white/70 border border-gray-200 rounded-lg space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:o("settings.theme.open_modal_title")}),e.jsx("p",{className:"text-sm text-gray-600",children:o("settings.theme.open_modal_help")})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Q["--color-bg"]},"aria-hidden":"true"}),e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Q["--color-widget-bg"]},"aria-hidden":"true"}),e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Q["--color-accent"]},"aria-hidden":"true"})]}),e.jsx("button",{type:"button",onClick:()=>G(!0),className:"font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark hover:bg-[#8ec9c9] transition-colors",children:o("settings.theme.open_modal_button")})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o("settings.theme.wallpaper_title")}),e.jsx("div",{className:"mb-4 p-3 bg-white/70 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.solid_color_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.solid_color_help")})]}),e.jsx("input",{type:"color",value:Q["--color-bg"],onChange:ne,className:"theme-color-input","aria-label":o("settings.theme.solid_color_title")})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4 max-h-56 overflow-y-auto pr-1",children:at.map(w=>{const M=us(w),X=w.urls.some(ee=>Q["--wallpaper"]===`url(${ee})`);return e.jsx("button",{type:"button",onClick:()=>ae(M),className:`h-20 rounded-lg border transition-all ${X?"border-accent ring-2 ring-accent":"border-gray-200 hover:border-gray-400"}`,style:{backgroundImage:`url(${w.previewUrl})`,backgroundSize:"cover",backgroundPosition:"center"},"aria-label":o("settings.theme.wallpaper_title")},w.id)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y.current?.click(),className:"flex-1 font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark hover:bg-[#8ec9c9] transition-colors",children:o("settings.theme.upload_image_button")}),e.jsx("button",{onClick:()=>ae("none"),className:"flex-1 font-semibold py-2 px-4 rounded-lg bg-gray-300 text-text-dark hover:bg-gray-400 transition-colors",children:o("settings.theme.remove_wallpaper_button")})]}),e.jsx("input",{type:"file",ref:y,onChange:E,accept:"image/*",className:"hidden"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o("settings.theme.screen_items_title")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.show_datetime_label")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.show_datetime_help")})]}),e.jsx("input",{type:"checkbox",checked:!!(Q.showDateTime??!0),onChange:V,className:"h-5 w-5"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.show_system_stats_label")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.show_system_stats_help")})]}),e.jsx("input",{type:"checkbox",checked:!!(Q.showSystemStats??!1),onChange:U,className:"h-5 w-5"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.show_profile_switcher_label")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.show_profile_switcher_help")})]}),e.jsx("input",{type:"checkbox",checked:!!(Q.showProfileSwitcher??!0),onChange:ie,className:"h-5 w-5"})]})]})]}),e.jsx("button",{onClick:k,className:"w-full font-bold py-2 px-4 rounded-lg bg-red-500 text-white hover:bg-red-600 transition-colors mt-6",children:o("settings.theme.reset_theme_button")})]})]})]})},"settings-modal"),e.jsx(lr,{isOpen:se,onClose:()=>G(!1)},"theme-settings-modal")]})},Ir=({isOpen:t,onClose:s})=>{const{t:i}=L();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("credits.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx(Pe,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-sm space-y-4",children:[e.jsx("p",{dangerouslySetInnerHTML:{__html:i("credits.original_project")}}),e.jsxs("p",{children:[i("credits.original_link")," ",e.jsx("a",{href:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/"})]}),e.jsx("p",{children:e.jsxs(Ns,{i18nKey:"credits.new_version",children:["Esta nueva versión fue desarrollada en colaboración por ",e.jsx("strong",{children:"María Teresa González"}),", ",e.jsx("strong",{children:"Juan José de Haro"})," y ",e.jsx("strong",{children:"Pablo G. Guízar"}),". El repositorio de este proyecto se encuentra en:",e.jsx("a",{href:"https://github.com/escritorio-digital/escritorio",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:i("credits.repository_link_text")})]})}),e.jsx("hr",{}),e.jsx("p",{dangerouslySetInnerHTML:{__html:i("credits.vibe_community")}}),e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[i("credits.vibe_apps_link_text")," ",e.jsx("a",{href:"https://vibe-coding-educativo.github.io/app_edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:i("credits.vibe_apps_repo_text")})]}),e.jsxs("li",{children:[i("credits.vibe_telegram_link_text")," ",e.jsx("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"t.me/vceduca"})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"text-center p-4 bg-gray-100 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("credits.open_knowledge_adherence")}),e.jsx("a",{href:"https://conocimiento-abierto.github.io/",target:"_blank",rel:"noopener noreferrer",className:"text-lg font-bold text-blue-600 hover:underline",children:i("credits.open_knowledge_decalogue")}),e.jsx("p",{className:"mt-4",children:e.jsx("a",{href:"https://creativecommons.org/licenses/by-sa/4.0/deed.es",target:"_blank",rel:"noopener noreferrer",className:"inline-block",title:"Creative Commons Attribution-ShareAlike 4.0 International License",children:e.jsx("img",{src:"https://i.creativecommons.org/l/by-sa/4.0/88x31.png",alt:"Licencia Creative Commons BY-SA 4.0"})})})]})]})]})}):null},zr=({isOpen:t,onClose:s})=>{const{t:i}=L();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("about.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx(Pe,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-sm space-y-5",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:i("about.app_name_label")}),e.jsx("p",{className:"font-semibold",children:i("about.app_name_value")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:i("about.version_label")}),e.jsx("p",{className:"font-semibold",children:i("about.version_value")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold mb-2",children:i("about.history_title")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.initial_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.initial_text")}),e.jsxs("p",{className:"text-sm mt-2",children:[i("about.original_app_label")," ",e.jsxs("a",{href:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["mtgonzalezm.github.io/escritorio-interactivo-aula ",e.jsx(gt,{size:14})]})]})]}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.development_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.development_text")})]}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.continuity_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.continuity_text")})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold mb-2",children:i("about.community_title")}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-700",children:i("about.community_text")}),e.jsxs("p",{className:"text-sm",children:[i("about.community_repo_label")," ",e.jsxs("a",{href:"https://vibe-coding-educativo.github.io/app_edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["vibe-coding-educativo.github.io/app_edu ",e.jsx(gt,{size:14})]})]}),e.jsxs("p",{className:"text-sm",children:[i("about.community_telegram_label")," ",e.jsxs("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["t.me/vceduca ",e.jsx(gt,{size:14})]})]})]})]})]})]})}):null},Gt={organization:{Icon:Us,className:"bg-emerald-100 text-emerald-700"},time:{Icon:Gs,className:"bg-blue-100 text-blue-700"},math_science:{Icon:qs,className:"bg-teal-100 text-teal-700"},board_writing:{Icon:Ks,className:"bg-amber-100 text-amber-700"},resources:{Icon:Hs,className:"bg-amber-100 text-amber-700"},interaction:{Icon:ct,className:"bg-rose-100 text-rose-700"},participation:{Icon:Vs,className:"bg-indigo-100 text-indigo-700"},logic_games:{Icon:Bs,className:"bg-purple-100 text-purple-700"},gestures:{Icon:Rs,className:"bg-orange-100 text-orange-700"},community:{Icon:As,className:"bg-sky-100 text-sky-700"},other:{Icon:$s,className:"bg-gray-100 text-gray-700"}},Ut=20,Er=({isOpen:t,onClose:s,onAddWidget:i,onOpenSettingsTab:c,onOpenThemeModal:b,onOpenAbout:p,onOpenCredits:l,onRemoveFavorite:u,onReorderFavorites:g,onClearFavorites:z,onAddFavorite:x,pinnedWidgets:_,anchorRect:o,anchorRef:j})=>{const{t:a,i18n:S}=L(),B=m=>m.startTooltip?a(m.startTooltip):a(m.title),W=r.useRef(null),q=r.useRef(null),te=r.useRef(null),se=r.useRef(null),G=r.useRef(null),[ue,Q]=r.useState(""),[O,ae]=r.useState(null),[k,y]=r.useState("widgets"),[N,E]=r.useState(null),[V,U]=r.useState({isOpen:!1,x:0,y:0,widgetId:null}),[ie,ne]=r.useState(!1),[Z,we]=r.useState(null),[ze,ce]=r.useState(null),De=r.useRef(null),me=r.useCallback(m=>m.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),[]),T=r.useMemo(()=>Object.values(Ie),[]),A=me(ue.trim()),w=A.length>0,M=r.useMemo(()=>A?T.filter(m=>{const D=me(a(m.title)),P=m.startTooltip?me(a(m.startTooltip)):"",J=(m.searchKeywords||[]).flatMap(K=>a(K).split(",")).map(K=>me(K.trim())).filter(Boolean).some(K=>K.includes(A));return D.includes(A)||P.includes(A)||J}):T,[me,A,a,T]),X=r.useMemo(()=>gs(M,a),[M,a]),ee=r.useMemo(()=>_.filter(m=>Ie[m]),[_]),he=r.useMemo(()=>ee.map(m=>Ie[m]).filter(Boolean),[ee]),_e=r.useMemo(()=>new Set(ee),[ee]),de=r.useMemo(()=>X.filter(m=>m.widgets.length>0),[X]);r.useEffect(()=>{if(!t)return;Q(""),y("widgets");const m=o?{left:Math.round(o.left),bottom:Math.round(window.innerHeight-o.top+4)}:{left:16,bottom:96};ae(m);const D=requestAnimationFrame(()=>{te.current?.focus()});return()=>cancelAnimationFrame(D)},[o,t]),r.useEffect(()=>{if(!t)return;const m=window.setTimeout(()=>{te.current?.focus(),te.current?.select()},0);return()=>window.clearTimeout(m)},[t]),r.useEffect(()=>{t||(U({isOpen:!1,x:0,y:0,widgetId:null}),ne(!1))},[t]),r.useEffect(()=>{if(de.length===0){E(null);return}(!N||!de.some(m=>m.id===N))&&E(de[0].id)},[N,de]),r.useEffect(()=>{if(!t)return;const m=P=>{W.current&&W.current.contains(P.target)||j?.current&&j.current.contains(P.target)||s()},D=P=>{P.key==="Escape"&&s()};return window.addEventListener("mousedown",m),window.addEventListener("keydown",D),()=>{window.removeEventListener("mousedown",m),window.removeEventListener("keydown",D)}},[j,t,s]),r.useEffect(()=>{if(!V.isOpen)return;const m=()=>{const K=W.current,oe=se.current;if(!K||!oe)return;const h=8,C=Math.max(h,K.clientWidth-oe.offsetWidth-h),I=Math.max(h,K.clientHeight-oe.offsetHeight-h);let R=Math.min(Math.max(V.x,h),C),H=Math.min(Math.max(V.y,h),I);(R!==V.x||H!==V.y)&&U(re=>({...re,x:R,y:H}))},D=K=>{W.current&&W.current.contains(K.target)&&K.target.closest('[data-favorite-menu="true"]')||U({isOpen:!1,x:0,y:0,widgetId:null})},P=K=>{K.key==="Escape"&&U({isOpen:!1,x:0,y:0,widgetId:null})},J=requestAnimationFrame(m);return window.addEventListener("mousedown",D),window.addEventListener("keydown",P),()=>{cancelAnimationFrame(J),window.removeEventListener("mousedown",D),window.removeEventListener("keydown",P)}},[V.isOpen]),r.useEffect(()=>{if(!ie)return;const m=P=>{G.current&&G.current.contains(P.target)||ne(!1)},D=P=>{P.key==="Escape"&&ne(!1)};return window.addEventListener("mousedown",m),window.addEventListener("keydown",D),()=>{window.removeEventListener("mousedown",m),window.removeEventListener("keydown",D)}},[ie]),r.useEffect(()=>{if(!t||!O)return;const m=W.current;if(!m)return;const D=m.getBoundingClientRect(),P=8;let J=O.left,K=O.bottom;D.left<P&&(J+=P-D.left),D.right>window.innerWidth-P&&(J-=D.right-(window.innerWidth-P)),D.top<P&&(K-=P-D.top),D.bottom>window.innerHeight-P&&(K+=D.bottom-(window.innerHeight-P)),(J!==O.left||K!==O.bottom)&&ae({left:J,bottom:K})},[t,O]);const ye=r.useCallback(()=>{if(!t||!O)return;const m=W.current?.querySelector('[data-start-menu-header="true"]'),D=W.current?.querySelector('[data-start-menu-search="true"]'),P=q.current;if(!m||!D||!P)return;const J=24,K=m.getBoundingClientRect().height,oe=D.getBoundingClientRect().height,h=Math.floor(window.innerHeight*.72),C=Math.max(0,h-K-oe-J),I=P.scrollHeight,R=Math.min(C,220),H=Math.min(C,Math.max(I,R));let re=H;w?re=De.current??H:De.current=H,we(re),ce(K+oe+J+re)},[t,O,w]);r.useLayoutEffect(()=>{if(!(!t||!O))return ye(),window.addEventListener("resize",ye),()=>{window.removeEventListener("resize",ye)}},[t,O,ye]),r.useEffect(()=>{if(!t)return;const m=requestAnimationFrame(ye);return()=>{cancelAnimationFrame(m)}},[t,ye]),r.useEffect(()=>{t&&ye()},[t,w,ye]);const Ve=es(rt(is,{activationConstraint:{distance:6}}),rt(ns,{coordinateGetter:as})),$e=m=>{const{active:D,over:P}=m;if(!P||D.id===P.id)return;const J=ee.indexOf(String(D.id)),K=ee.indexOf(String(P.id));if(J===-1||K===-1)return;const oe=rs(ee,J,K),h=_.filter(C=>!Ie[C]);g([...oe,...h])},Ae=({widgetId:m})=>{const D=Ie[m],{attributes:P,listeners:J,setNodeRef:K,transform:oe,transition:h,isDragging:C}=ls({id:m});if(!D)return null;const I={transform:cs.Transform.toString(oe),transition:h};return e.jsxs("button",{ref:K,style:I,onClick:()=>Oe(D.id),onContextMenu:R=>{R.preventDefault(),R.stopPropagation();const H=W.current?.getBoundingClientRect(),re=H?R.clientX-H.left:R.clientX,je=H?R.clientY-H.top:R.clientY;U({isOpen:!0,x:re,y:je,widgetId:D.id})},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm min-w-0 ${C?"opacity-70":""}`,title:B(D),children:[e.jsx("span",{className:"text-2xl",children:D.icon}),e.jsx("span",{className:"flex-1 min-w-0 text-sm font-semibold text-text-dark leading-tight truncate",children:a(D.title)}),e.jsx("span",{...P,...J,onClick:R=>R.stopPropagation(),className:"text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",title:a("start_menu.reorder_favorites"),children:e.jsx(Js,{size:16})})]})};if(!t||!O)return null;const Oe=m=>{i(m),s()},Ce=m=>{c(m),s()},Ye=m=>{if(m.key!=="Enter")return;const D=M[0];D&&Oe(D.id)},Re=N&&de.find(m=>m.id===N)||null,He=(m,D=!0)=>e.jsx("div",{className:"space-y-1",children:m.map(P=>e.jsxs("button",{onClick:()=>Oe(P.id),onContextMenu:J=>{J.preventDefault(),J.stopPropagation();const K=W.current?.getBoundingClientRect(),oe=K?J.clientX-K.left:J.clientX,h=K?J.clientY-K.top:J.clientY;U({isOpen:!0,x:oe,y:h,widgetId:P.id})},className:`w-full flex items-center gap-3 px-3 py-[0.45rem] rounded-lg border transition text-left shadow-sm min-w-0 ${D&&_e.has(P.id)?"bg-amber-50 border-amber-300":"bg-white/90 hover:bg-amber-50 border-gray-200"}`,title:B(P),children:[e.jsx("span",{className:"text-2xl",children:P.icon}),e.jsx("span",{className:"flex-1 min-w-0 text-sm font-semibold text-text-dark leading-tight truncate",children:a(P.title)}),D&&_e.has(P.id)&&e.jsx(Dt,{size:14,className:"text-amber-500"})]},P.id))});return e.jsxs("div",{ref:W,className:"fixed z-[10001] w-[min(34rem,calc(100vw-1rem))] max-h-[72vh] bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200 flex flex-col overflow-hidden",style:{left:O.left,bottom:O.bottom,height:ze?`${ze}px`:void 0},onContextMenu:m=>{m.preventDefault(),m.stopPropagation()},children:[e.jsxs("div",{"data-start-menu-header":"true",className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-white to-amber-50/70 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:$("escritorio-digital.png"),alt:a("toolbar.start"),width:"22",height:"22"}),e.jsx("h3",{className:"text-base font-semibold text-text-dark",children:a("start_menu.title")})]}),e.jsxs("div",{className:"relative flex items-center gap-2 text-gray-600",children:[e.jsx("button",{type:"button",onClick:()=>{y("favorites")},className:`p-2 rounded-full border transition ${k==="favorites"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("start_menu.favorites"),"aria-label":a("start_menu.favorites"),children:e.jsx(Dt,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{y("shortcuts")},className:`p-2 rounded-full border transition ${k==="shortcuts"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("context_menu.settings"),"aria-label":a("context_menu.settings"),children:e.jsx(xt,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{ne(m=>!m)},className:"p-2 rounded-full border bg-white/80 border-gray-200 hover:bg-amber-50 transition",title:a("start_menu.language_label"),"aria-label":a("start_menu.language_label"),children:e.jsx(Fs,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{y("help")},className:`p-2 rounded-full border transition ${k==="help"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("start_menu.help"),"aria-label":a("start_menu.help"),children:e.jsx(Ps,{size:16})}),ie&&e.jsx("div",{ref:G,className:"absolute right-0 top-10 z-[10003] min-w-[160px] rounded-lg border border-gray-200 bg-white/95 shadow-xl p-1 text-sm text-text-dark",children:[{id:"es",label:"Español"},{id:"ca",label:"Català"},{id:"eu",label:"Euskara"},{id:"gl",label:"Galego"},{id:"pt",label:"Português"},{id:"fr",label:"Français"},{id:"it",label:"Italiano"},{id:"de",label:"Deutsch"},{id:"en",label:"English"}].map(m=>e.jsx("button",{onClick:()=>{S.changeLanguage(m.id),ne(!1)},className:`w-full text-left px-3 py-2 rounded-md hover:bg-gray-100 transition ${S.language===m.id?"bg-amber-50 text-amber-800":""}`,children:m.label},m.id))})]})]}),e.jsx("div",{"data-start-menu-search":"true",className:"px-4 py-3 border-b border-gray-200 bg-white/70",children:e.jsx("div",{className:"relative",children:e.jsx("input",{ref:te,autoFocus:!0,type:"text",placeholder:a("settings.widgets.search"),value:ue,onChange:m=>Q(m.target.value),onKeyDown:Ye,className:"w-full pl-3 pr-4 py-2 border rounded-lg bg-white/90 focus:ring-2 focus:ring-accent focus:outline-none"})})}),e.jsx("div",{className:"flex-1 overflow-hidden px-4 py-3 bg-gradient-to-b from-white to-gray-50",children:e.jsxs("div",{className:"flex items-start gap-4 h-full",children:[e.jsx("div",{ref:q,className:"w-52 shrink-0 flex flex-col gap-4 min-h-0",children:e.jsx("div",{className:"pr-1",style:{maxHeight:Z?`${Z}px`:void 0,overflowY:"auto"},children:e.jsx("div",{className:"space-y-1",children:de.map(m=>{const D=Gt[m.id]??Gt.other;return e.jsxs("button",{onClick:()=>{y("widgets"),E(m.id)},className:`w-full text-left px-3 py-2 rounded-lg text-[0.8125rem] font-semibold border transition flex items-center gap-2 ${N===m.id&&k==="widgets"?"bg-accent text-text-dark border-transparent":"bg-white/90 hover:bg-amber-50 border-gray-200"}`,children:[e.jsx("span",{className:`h-5 w-5 rounded-md flex items-center justify-center ${D.className}`,children:e.jsx(D.Icon,{size:12})}),e.jsx("span",{className:"leading-tight",children:a(m.titleKey)}),e.jsx("span",{className:"ml-auto text-[0.625rem] font-semibold text-gray-600",children:m.widgets.length})]},m.id)})})})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1 h-full",style:Z?{maxHeight:`${Z}px`}:void 0,children:[k==="favorites"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("start_menu.favorites")}),he.length>0&&e.jsx("button",{className:"text-xs font-semibold text-red-600 hover:text-red-700",onClick:()=>{window.confirm(a("start_menu.clear_favorites_confirm"))&&z()},children:a("start_menu.clear_favorites")})]}),he.length>0?e.jsx(ts,{sensors:Ve,collisionDetection:ss,onDragStart:()=>{U({isOpen:!1,x:0,y:0,widgetId:null})},onDragEnd:$e,children:e.jsx(os,{items:ee,strategy:rn,children:e.jsx("div",{className:"space-y-1",children:ee.map(m=>e.jsx(Ae,{widgetId:m},m))})})}):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")})]}),k==="shortcuts"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("context_menu.settings")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>Ce("general"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Ys,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.settings")})]}),e.jsxs("button",{onClick:()=>Ce("profiles"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.manage_profiles")})]}),e.jsxs("button",{onClick:()=>{b(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(xt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("start_menu.theme_accessibility")})]}),e.jsxs("button",{onClick:()=>Ce("theme"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Zt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.change_background")})]}),e.jsxs("button",{onClick:()=>Ce("widgets"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Jt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("toolbar.widgetLibrary")})]})]})]}),k==="help"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("start_menu.help")}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>{Oe("program-guide")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Qt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.guide")})]}),e.jsxs("button",{onClick:()=>{p(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Xs,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.about")})]}),e.jsxs("button",{onClick:()=>{l(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Qs,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.licenses")})]})]})]}),k==="widgets"&&e.jsx("div",{className:"space-y-3",children:w?M.length>0?He(M,!0):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")}):Re?.widgets.length?He(Re.widgets,!0):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")})})]})]})}),V.isOpen&&V.widgetId&&e.jsx("div",{"data-favorite-menu":"true",ref:se,className:"absolute z-[10002] min-w-[180px] bg-white/95 backdrop-blur-md rounded-lg shadow-xl border border-gray-200 py-2 text-sm text-text-dark",style:{left:V.x,top:V.y},children:e.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{const m=V.widgetId;_e.has(m)?u(m):ee.length<Ut?x(m):alert(a("settings.widgets.max_widgets_alert",{max:Ut})),U({isOpen:!1,x:0,y:0,widgetId:null})},children:_e.has(V.widgetId)?a("start_menu.remove_favorite"):a("start_menu.add_favorite")})})]})},Wr=({profiles:t,activeProfileName:s,setActiveProfileName:i,onManageProfiles:c,onOpenContextMenu:b,setProfiles:p,profileOrder:l})=>{const[u,g]=r.useState(!1),[z,x]=r.useState(!1),[_,o]=r.useState("export"),[j]=r.useState(!0),[a,S]=r.useState(!0),[B,W]=r.useState(!0),[q,te]=r.useState(!1),[se,G]=r.useState(!1),[ue,Q]=r.useState(!1),[O,ae]=r.useState([]),[k,y]=r.useState("replace"),[N,E]=r.useState(""),[V,U]=r.useState(""),[ie,ne]=r.useState(!1),[Z,we]=r.useState(!1),[ze,ce]=r.useState(""),[De,me]=r.useState(""),{t:T}=L(),A=r.useMemo(()=>{const h=Object.keys(t),C=l.filter(I=>h.includes(I));return h.forEach(I=>{C.includes(I)||C.push(I)}),C},[t,l]),w=j&&O.length>0&&O.length<A.length,M=(se||ue)&&O.length>0,X=r.useRef(null),ee=r.useRef(null),he=r.useRef(0),_e=r.useRef(null),de="Escritorio Principal";r.useEffect(()=>{const h=C=>{const I=C.detail;o(I?.tab??"export"),x(!0),g(!1)};return window.addEventListener("open-profile-backup",h),()=>window.removeEventListener("open-profile-backup",h)},[]);const ye=h=>h===de?T("settings.profiles.default_name"):h,Ve=h=>{i(h),g(!1)},$e=()=>{c(),g(!1)};r.useEffect(()=>{if(!u&&!z)return;const h=C=>{X.current&&(X.current.contains(C.target)||(g(!1),x(!1)))};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[u,z]),r.useEffect(()=>{if(!z)return;ae(C=>C.length===A.length&&C.every(I=>A.includes(I))?C:A),E(""),U(""),o("export"),y("replace");const h=tt.some(C=>!!window.localStorage.getItem(C));te(h),S(h),ht().then(C=>{const I=C.siteCount>0;G(I),I||W(!1)}).catch(()=>{G(!1),W(!1)})},[z,A,s]),r.useEffect(()=>{z&&O.length!==0&&ht(O).then(h=>{const C=h.siteCount>0;Q(C),C||W(!1)}).catch(()=>{Q(!1),W(!1)})},[z,O,s]),r.useEffect(()=>{w&&a&&S(!1)},[w,a]),r.useEffect(()=>{M||B&&W(!1)},[M,B]);const Ae=h=>{ae(C=>C.includes(h)?C.filter(I=>I!==h):[...C,h])},Oe=h=>{const C=new Blob([h],{type:"application/zip"}),I=URL.createObjectURL(C),R=document.createElement("a");R.href=I,R.download=`escritorio-digital-backup-${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(R),R.click(),R.remove(),URL.revokeObjectURL(I)},Ce=()=>{we(!1),ce(""),me("")},Ye=h=>{if(!Number.isFinite(h))return"0 B";if(h<1024)return`${h} B`;const C=h/1024;if(C<1024)return`${C.toFixed(1)} KB`;const I=C/1024;return I<1024?`${I.toFixed(1)} MB`:`${(I/1024).toFixed(2)} GB`},Re=async()=>{const h={};if(j&&O.length>0){const C={};O.forEach(I=>{t[I]&&(C[I]=t[I])}),h.profiles=C,h.activeProfileName=C[s]?s:O[0]}return a&&q&&!w&&(h.widgetData=await pr(tt)),xs(h)},He=(h,C)=>{const I={...h},R=new Map;return Object.entries(C).forEach(([H,re])=>{let je=H;if(I[je]){let fe=2;for(;I[`${H} (${fe})`];)fe+=1;je=`${H} (${fe})`}I[je]=re,R.set(H,je)}),{updated:I,nameMap:R}},m=async()=>{let h=0;for(const C of tt){const I=window.localStorage.getItem(C);if(I)if(I==="__indexed_db__"){const R=await fs(C);R&&(h+=new Blob([R]).size)}else h+=new Blob([I]).size}return h},D=async()=>{let h=0;if(j&&O.length>0){const C={};O.forEach(R=>{t[R]&&(C[R]=t[R])});const I={profiles:C,activeProfileName:C[s]?s:O[0]};h+=new Blob([JSON.stringify(I)]).size}if(a&&q&&!w&&(h+=await m()),B){const C=await ht(O);C.siteCount>0&&(h+=Math.ceil(C.totalBytes*1.1))}return h};r.useEffect(()=>{if(!z)return;he.current+=1;const h=he.current;(async()=>{if(j&&O.length===0){U(T("backup.size_unknown")),ne(!1);return}ne(!0);try{const I=await D();if(he.current!==h)return;U(T("backup.size_label",{size:Ye(I)}))}catch{he.current===h&&U(T("backup.size_unknown"))}finally{he.current===h&&ne(!1)}})()},[z,j,a,B,O,q,se,t,s,T]);const P=async()=>{if(j&&O.length===0){E(T("backup.no_profiles"));return}E(T("backup.exporting")),x(!1),we(!0),ce(T("backup.progress_export_title")),me(T("backup.progress_preparing")),_e.current?.abort();const h=new AbortController;_e.current=h;try{const C=await Re(),I=O.includes(s)?s:O[0],R=B?await wr(O,I):void 0;let H=0,re=0;const je=await vr(C.data,R,(fe,ge)=>{const be=performance.now();be-H>200&&(me(`${fe}/${ge}`),H=be)},async()=>{re+=1,re%5===0&&await new Promise(fe=>requestAnimationFrame(()=>fe()))},h.signal);if(h.signal.aborted)return;Oe(je),E(T("backup.export_ready"))}catch(C){h.signal.aborted||(console.error(C),E(T("backup.invalid_file")))}finally{h.signal.aborted||Ce()}},J=()=>{x(!1),ee.current?.click()},K=async h=>{const C=h.target.files?.[0];if(C)try{E(T("backup.importing")),we(!0),ce(T("backup.progress_import_title")),me(T("backup.progress_preparing")),_e.current?.abort();const I=new AbortController;_e.current=I;const R=await C.arrayBuffer();let H,re;if(jr(R)||C.name.toLowerCase().endsWith(".zip")){const ge=kr(R);H=ge.payload,re=ge.localWeb}else{const ge=new TextDecoder().decode(R);if(H=JSON.parse(ge),!ws(H)){E(T("backup.invalid_file")),Ce();return}}if(!H?.data){E(T("backup.invalid_file")),Ce();return}if(I.signal.aborted)return;let je,fe=H.data.activeProfileName||s;if(H.data.profiles)if(k==="replace"){const ge=H.data.profiles,be=Object.keys(ge);if(be.length>0){p(ge);const ve=H.data.activeProfileName,Ee=ve&&ge[ve]?ve:be[0];i(Ee),fe=Ee}}else p(ge=>{const be=He(ge,H.data.profiles||{});je=be.nameMap;const ve=H.data.activeProfileName;if(ve){const Ee=be.nameMap.get(ve);Ee?(i(Ee),fe=Ee):be.updated[ve]&&(i(ve),fe=ve)}return be.updated});if(H.data.widgetData&&await xr(H.data.widgetData),H.data.localWeb||re){if(k==="replace"&&await ps(),re){let ge=0,be=0;await yr(re,{signal:I.signal,onProgress:(ve,Ee)=>{const Xe=performance.now();Xe-ge>200&&(me(`${ve}/${Ee}`),ge=Xe)},yieldControl:async()=>{be+=1,be%5===0&&await new Promise(ve=>requestAnimationFrame(()=>ve()))},profileNameMap:je,fallbackProfileName:fe})}else H.data.localWeb&&await _r(H.data.localWeb,{profileNameMap:je,fallbackProfileName:fe});window.dispatchEvent(new Event("local-web-data-changed"))}E(T("backup.import_done")),I.signal.aborted||Ce(),window.location.reload()}catch(I){_e.current?.signal.aborted?E(""):(console.error(I),E(T("backup.invalid_file"))),Ce()}finally{h.target.value=""}},oe=()=>{_e.current?.abort(),Ce(),E("")};return e.jsx("div",{className:"fixed bottom-4 right-4 z-[9999] max-[700px]:hidden",ref:X,onContextMenu:b,children:e.jsxs("div",{className:"relative",children:[u&&e.jsxs("div",{className:"absolute bottom-full mb-2 w-56 bg-white/80 backdrop-blur-md rounded-lg shadow-lg border border-black/10 text-sm",children:[e.jsx("ul",{className:"p-1",children:A.map(h=>e.jsx("li",{children:e.jsx("button",{onClick:()=>Ve(h),className:`w-full text-left px-3 py-2 rounded-md transition-colors ${h===s?"font-semibold bg-accent/30 text-text-dark":"hover:bg-accent hover:text-text-dark"}`,children:ye(h)})},h))}),e.jsxs("div",{className:"border-t border-black/10 p-1 space-y-1",children:[e.jsxs("button",{onClick:$e,className:"w-full text-left px-3 py-2 rounded-md hover:bg-accent hover:text-text-dark transition-colors flex items-center gap-2",children:[e.jsx(ct,{size:16}),T("settings.profiles.manage_button")]}),e.jsxs("button",{onClick:()=>{x(!0),g(!1)},className:"w-full text-left px-3 py-2 rounded-md hover:bg-accent hover:text-text-dark transition-colors flex items-center gap-2",children:[e.jsx(Tt,{size:16}),T("backup.manage_profiles")]})]})]}),e.jsxs("button",{onClick:()=>g(!u),onContextMenu:b,className:"w-56 h-12 px-4 bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40 transition-colors flex items-center justify-between",title:T("settings.profiles.switcher_title"),children:[e.jsx("span",{className:"font-semibold",children:ye(s)}),u?e.jsx(Zs,{size:20}):e.jsx(en,{size:20})]}),z&&e.jsx("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"w-full max-w-xl bg-white/90 backdrop-blur-md rounded-xl shadow-2xl border border-black/10 p-5 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"font-semibold text-lg",children:T("backup.manage_profiles")}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-600 hover:text-gray-800",children:"✕"})]}),e.jsxs("div",{className:"flex border-b border-gray-300 mb-5",children:[e.jsx("button",{onClick:()=>o("export"),className:`-mb-px px-4 py-2 text-sm font-semibold rounded-t-md border transition-colors ${_==="export"?"bg-accent text-text-dark border-accent border-b-white shadow-sm":"bg-gray-100 text-gray-600 border-transparent hover:text-text-dark"}`,children:T("backup.tab_export")}),e.jsx("button",{onClick:()=>o("import"),className:`-mb-px ml-1 px-4 py-2 text-sm font-semibold rounded-t-md border transition-colors ${_==="import"?"bg-accent text-text-dark border-accent border-b-white shadow-sm":"bg-gray-100 text-gray-600 border-transparent hover:text-text-dark"}`,children:T("backup.tab_import")})]}),_==="export"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:T("backup.choose_profiles")}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-auto border border-gray-200 rounded-lg p-2 bg-white/60",children:A.map(h=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:O.includes(h),onChange:()=>Ae(h)}),e.jsx("span",{children:ye(h)})]},h))}),e.jsx("div",{className:"text-xs text-gray-500",children:T("backup.include_profiles")}),q&&e.jsxs("label",{className:`flex items-center gap-2 ${w?"opacity-50":""}`,children:[e.jsx("input",{type:"checkbox",checked:a,onChange:h=>S(h.target.checked),disabled:w}),e.jsx("span",{children:T("backup.include_widgets")})]}),e.jsxs("label",{className:`flex items-center gap-2 ${M?"":"opacity-50"}`,children:[e.jsx("input",{type:"checkbox",checked:B,onChange:h=>W(h.target.checked),disabled:!M}),e.jsx("span",{children:T("backup.include_local_web")})]})]}),e.jsx("div",{className:"mt-3 text-sm text-gray-700 font-semibold",children:ie?T("backup.size_estimating"):V||T("backup.size_unknown")}),N&&e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:N}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:P,className:"w-full py-2 rounded-md bg-accent text-text-dark font-semibold hover:bg-[#8ec9c9] transition-colors flex items-center justify-center gap-2",children:[e.jsx(Tt,{size:16}),T("backup.export_button")]})})]}),_==="import"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:T("backup.import_mode_label")}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"import-mode",value:"replace",checked:k==="replace",onChange:()=>y("replace")}),e.jsx("span",{children:T("backup.import_mode_replace")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"import-mode",value:"merge",checked:k==="merge",onChange:()=>y("merge")}),e.jsx("span",{children:T("backup.import_mode_merge")})]})]}),N&&e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:N}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:J,className:"w-full py-2 rounded-md border border-gray-200 bg-white hover:bg-gray-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(tn,{size:16}),T("backup.import_button")]})}),e.jsx("p",{className:"mt-3 text-[11px] text-gray-500",children:T("backup.import_note")})]})]})}),Z&&e.jsx("div",{className:"fixed inset-0 z-[10002] flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"w-full max-w-sm bg-white/95 backdrop-blur-md rounded-xl shadow-2xl border border-black/10 p-5 text-sm",children:[e.jsx("div",{className:"font-semibold text-lg mb-2",children:ze}),e.jsx("div",{className:"text-sm text-gray-700 mb-4",children:De}),e.jsx("button",{onClick:oe,className:"w-full py-2 rounded-md border border-gray-200 bg-white hover:bg-gray-100 transition-colors font-semibold",children:T("backup.progress_cancel")})]})}),e.jsx("input",{ref:ee,type:"file",accept:"application/json,application/zip,.zip",className:"hidden",onChange:K})]})})},Mr=({profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,profileOrder:b,setProfileOrder:p})=>{const{t:l,i18n:u}=L(),g=t[i]||Object.values(t)[0],z=g.theme?.showDateTime??!0,x=g.theme?.showSystemStats??!1,_=g.theme?.showProfileSwitcher??!0,o=r.useCallback(n=>{s(d=>{const f=d[i]||g;if(!f)return d;const v=typeof n=="function"?n(f.activeWidgets):n;return v===f.activeWidgets?d:{...d,[i]:{...f,activeWidgets:v}}})},[g,i,s]),j=r.useCallback(n=>{s(d=>{const f=d[i]||g;if(!f)return d;const v=typeof n=="function"?n(f.pinnedWidgets):n;return v===f.pinnedWidgets?d:{...d,[i]:{...f,pinnedWidgets:v}}})},[g,i,s]),a=r.useCallback(()=>{const n=!z,d={...g,theme:{...g.theme,showDateTime:n}};s(f=>({...f,[i]:d}))},[g,i,s,z]),S=r.useCallback(()=>{const n=!x,d={...g,theme:{...g.theme,showSystemStats:n}};s(f=>({...f,[i]:d}))},[g,i,s,x]),B=r.useCallback(()=>{const n=!_,d={...g,theme:{...g.theme,showProfileSwitcher:n}};s(f=>({...f,[i]:d}))},[g,i,s,_]),[W,q]=r.useState(100),te=r.useRef(100);r.useEffect(()=>{const n=g.activeWidgets.reduce((d,f)=>f.zIndex>d?f.zIndex:d,100);q(d=>d<n?n:d)},[g.activeWidgets]),r.useEffect(()=>{te.current=W},[W]);const[se,G]=r.useState(null),[ue,Q]=r.useState(!1),[O,ae]=r.useState(!1),[k,y]=r.useState(!1),[N,E]=r.useState(0),V=r.useRef(null),[U,ie]=r.useState(!1),[ne,Z]=r.useState(null),[we,ze]=r.useState("general"),[ce,De]=et("toolbar-hidden",!1),[me,T]=r.useState(!1),[A,w]=r.useState({isOpen:!1,x:0,y:0,widgetId:null,windowInstanceId:null}),M=r.useRef(null),[X,ee]=r.useState(!1),[he,_e]=r.useState(!!document.fullscreenElement);r.useEffect(()=>{if(g.activeWidgets.length===0){G(null);return}if(!se||!g.activeWidgets.some(n=>n.instanceId===se)){const n=g.activeWidgets.reduce((d,f)=>d?f.zIndex>d.zIndex?f:d:f,null);G(n?n.instanceId:null)}},[g.activeWidgets,se]),r.useEffect(()=>{const n=Object.keys(t);p(d=>{const f=d.filter(v=>n.includes(v));return n.forEach(v=>{f.includes(v)||f.push(v)}),f.length===d.length&&f.every((v,Y)=>v===d[Y])?d:f})},[t,p]);const de=()=>{const d=Math.max(200,window.innerWidth-32),f=Math.max(150,window.innerHeight-32);return{margin:16,maxWidth:d,maxHeight:f}},ye=n=>{if(n.isMaximized)return n;const{margin:d,maxWidth:f,maxHeight:v}=de(),Y=(Le,Fe)=>{if(typeof Le=="number")return Le;const Se=Le.trim();if(Se.endsWith("vw")){const Je=Number.parseFloat(Se);return Number.isFinite(Je)?window.innerWidth*Je/100:Fe}if(Se.endsWith("vh")){const Je=Number.parseFloat(Se);return Number.isFinite(Je)?window.innerHeight*Je/100:Fe}const Ot=Number.parseFloat(Se);return Number.isFinite(Ot)?Ot:Fe},le=Math.min(Y(n.size.width,f),f),ke=Math.min(Y(n.size.height,v),v),Ne=Math.max(d,window.innerWidth-le-d),Me=Math.max(d,window.innerHeight-ke-d),Be=Math.min(Math.max(n.position.x,d),Ne),Ge=Math.min(Math.max(n.position.y,d),Me);return{...n,size:{width:le,height:ke},position:{x:Be,y:Ge}}},Ve=n=>{const d=Ie[n];if(!d)return;const f=W+1;q(f);const{margin:v,maxWidth:Y,maxHeight:le}=de(),ke=typeof d.defaultSize.width=="number"?Math.min(d.defaultSize.width,Y):d.defaultSize.width,Ne=typeof d.defaultSize.height=="number"?Math.min(d.defaultSize.height,le):d.defaultSize.height,Me=typeof ke=="number"?ke:Y,Be=typeof Ne=="number"?Ne:le,Ge=Math.max(v,window.innerWidth-Me-v),Le=Math.max(v,window.innerHeight-Be-v),Fe={instanceId:`${n}-${Date.now()}`,widgetId:n,position:{x:Math.max(v,Math.random()*Ge),y:Math.max(v,Math.random()*Le)},size:{width:ke,height:Ne},zIndex:f};o(Se=>[...Se,Fe]),G(Fe.instanceId)},$e=n=>o(d=>{const f=d.filter(v=>v.instanceId!==n);if(se===n){const v=f.reduce((Y,le)=>Y?le.zIndex>Y.zIndex?le:Y:le,null);G(v?v.instanceId:null)}return f}),Ae=r.useCallback(n=>{const d=te.current+1;te.current=d,q(d),o(f=>f.map(v=>v.instanceId===n?{...v,zIndex:d}:v)),G(n)},[o]),Oe=n=>o(d=>d.map(f=>f.instanceId===n?{...f,isMinimized:!f.isMinimized}:f)),Ce=r.useCallback(n=>{const d=g.activeWidgets.find(f=>f.instanceId===n);if(d){if(d.isMinimized){const f=W+1;q(f),o(v=>v.map(Y=>Y.instanceId===n?{...Y,isMinimized:!1,zIndex:f}:Y)),G(n);return}if(se!==n){Ae(n);return}o(f=>f.map(v=>v.instanceId===n?{...v,isMinimized:!0}:v))}},[g.activeWidgets,se,Ae,W,o,q]),Ye=r.useCallback(()=>{o(n=>n.map(d=>({...d,isMinimized:!0})))},[o]),Re=n=>{const d=W+1;q(d),o(f=>f.map(v=>v.instanceId===n?v.isMaximized?{...v,isMaximized:!1,position:v.previousPosition||{x:100,y:100},size:v.previousSize||{width:500,height:400},zIndex:d}:{...v,isMaximized:!0,isMinimized:!1,previousPosition:v.position,previousSize:v.size,position:{x:0,y:0},size:{width:"100vw",height:"100vh"},zIndex:d}:v))};r.useEffect(()=>{if(!A.isOpen)return;const n=v=>{M.current&&M.current.contains(v.target)||w(Y=>({...Y,isOpen:!1}))},d=()=>{w(v=>({...v,isOpen:!1}))},f=v=>{v.key==="Escape"&&w(Y=>({...Y,isOpen:!1}))};return window.addEventListener("mousedown",n),window.addEventListener("keydown",f),window.addEventListener("resize",d),()=>{window.removeEventListener("mousedown",n),window.removeEventListener("keydown",f),window.removeEventListener("resize",d)}},[A.isOpen]),r.useEffect(()=>{if(!A.isOpen)return;const d=requestAnimationFrame(()=>{const f=M.current;if(!f)return;const v=f.getBoundingClientRect(),Y=8,le=Math.max(Y,window.innerWidth-v.width-Y),ke=Math.max(Y,window.innerHeight-v.height-Y),Ne=Math.min(Math.max(A.x,Y),le),Me=Math.min(Math.max(A.y,Y),ke);(Ne!==A.x||Me!==A.y)&&w(Be=>({...Be,x:Ne,y:Me}))});return()=>cancelAnimationFrame(d)},[A.isOpen,A.x,A.y]),r.useEffect(()=>{const n=()=>{ee(!0)};return window.addEventListener("storage-quota-exceeded",n),()=>window.removeEventListener("storage-quota-exceeded",n)},[]),r.useEffect(()=>{const n=()=>{o(d=>d.map(ye))};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[o]),r.useEffect(()=>{o(n=>n.map(ye))},[i]),r.useEffect(()=>{const n=()=>{_e(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",n),()=>document.removeEventListener("fullscreenchange",n)},[]);const He=async()=>{try{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()}catch(n){console.warn("No se pudo cambiar a pantalla completa.",n)}},m=n=>{ze(n),Q(!0),w(d=>({...d,isOpen:!1}))},D=()=>{ze("theme"),Q(!0),E(n=>n+1)},P=n=>{Z(n),ie(d=>!d)},J=n=>n instanceof HTMLElement?n.isContentEditable?!0:!!n.closest('input, textarea, select, [contenteditable="true"]'):!1,K=()=>{const n=window.getSelection?.();return!!(n&&!n.isCollapsed&&n.toString().trim())},oe=(n,d,f=!1)=>{!f&&J(n.target)||!f&&K()||(n.preventDefault(),w({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:d??null,windowInstanceId:null}))},h=(n,d)=>{n.preventDefault();const f=g.activeWidgets.find(v=>v.instanceId===d)?.widgetId??null;w({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:f,windowInstanceId:d})},C=(n,d,f)=>{n.preventDefault(),n.stopPropagation(),w({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:d,windowInstanceId:f})},I=()=>{o([]),w(n=>({...n,isOpen:!1}))},[R,H]=r.useState(new Date),[re,je]=r.useState({usage:null,quota:null}),[fe,ge]=r.useState({width:window.screen.width,height:window.screen.height}),[be,ve]=r.useState({width:window.innerWidth,height:window.innerHeight}),Ee=r.useRef(null),[Xe,jt]=r.useState(null),vt=new Intl.DateTimeFormat(u.language,{year:"numeric",month:"short",day:"numeric"}).format(R),kt=new Intl.DateTimeFormat(u.language,{hour:"2-digit",minute:"2-digit"}).format(R);r.useEffect(()=>{const n=window.setInterval(()=>H(new Date),1e3);return()=>window.clearInterval(n)},[]),r.useEffect(()=>{if(!z){jt(null);return}const n=()=>{const f=Ee.current;if(!f)return;const v=f.getBoundingClientRect();jt(v.bottom)},d=window.requestAnimationFrame(n);return window.addEventListener("resize",n),()=>{window.cancelAnimationFrame(d),window.removeEventListener("resize",n)}},[z,vt,kt,u.language]),r.useEffect(()=>{const n=async()=>{if(!navigator.storage?.estimate){je({usage:null,quota:null});return}const v=await navigator.storage.estimate();je({usage:typeof v.usage=="number"?v.usage:null,quota:typeof v.quota=="number"?v.quota:null})};n();const d=window.setInterval(n,3e4),f=()=>n();return window.addEventListener("storage-usage-changed",f),()=>{window.clearInterval(d),window.removeEventListener("storage-usage-changed",f)}},[]),r.useEffect(()=>{const n=()=>{ge({width:window.screen.width,height:window.screen.height}),ve({width:window.innerWidth,height:window.innerHeight})};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const dt=(n,d=2)=>{if(n==null||!Number.isFinite(n))return l("system_stats.not_available");if(n<1024)return`${n} B`;const f=n/1024;if(f<1024)return`${f.toFixed(1)} KB`;const v=f/1024;return v<1024?`${v.toFixed(1)} MB`:`${(v/1024).toFixed(d)} GB`},Ct=n=>n==null||!Number.isFinite(n)?null:(n/1024**3).toFixed(2),Nt=g.activeWidgets.length>0,st=re.usage,Qe=re.quota,St=st!=null&&Qe!=null?Math.max(0,Qe-st):null,It=navigator,zt=typeof It.deviceMemory=="number"?It.deviceMemory:null,Et=typeof navigator.hardwareConcurrency=="number"?navigator.hardwareConcurrency:null,_s=Ct(Qe),ys=Ct(St),Wt=st!=null&&Qe!=null,js=Wt&&_s!==ys,Te=[],We=A.widgetId??(A.windowInstanceId?g.activeWidgets.find(n=>n.instanceId===A.windowInstanceId)?.widgetId:null),Ke=We?g.pinnedWidgets.includes(We):!1,qe=A.windowInstanceId?g.activeWidgets.find(n=>n.instanceId===A.windowInstanceId)??null:null,Mt=!!We,vs=!!A.windowInstanceId||Nt;return Wt&&(Te.push({label:l("system_stats.storage_used"),value:`${dt(st,2)} / ${dt(Qe,2)}`}),js&&Te.push({label:l("system_stats.storage_free"),value:dt(St,2)})),zt!=null&&Te.push({label:l("system_stats.memory"),value:l("system_stats.memory_value",{value:zt})}),Et!=null&&Te.push({label:l("system_stats.cpu"),value:l("system_stats.cpu_value",{value:Et})}),Te.push({label:l("system_stats.screen"),value:l("system_stats.screen_value",{width:fe.width,height:fe.height})}),Te.push({label:l("system_stats.window"),value:l("system_stats.window_value",{width:be.width,height:be.height})}),e.jsxs("div",{className:"w-screen h-screen overflow-hidden",onContextMenu:n=>oe(n),children:[e.jsx("button",{onClick:He,onContextMenu:n=>oe(n,void 0,!0),className:"fixed top-4 left-4 z-[2] p-2 rounded-full text-white/80 bg-black/15 backdrop-blur-sm hover:bg-black/30 hover:text-white transition-colors",title:l(he?"desktop.fullscreen_exit":"desktop.fullscreen_enter"),"aria-label":l(he?"desktop.fullscreen_exit":"desktop.fullscreen_enter"),children:he?e.jsx(nt,{size:18}):e.jsx(Lt,{size:18})}),z&&e.jsxs("div",{ref:Ee,className:"fixed top-4 right-4 z-[1] pointer-events-none select-none text-white bg-black/45 backdrop-blur-md rounded-2xl px-6 py-5 shadow-lg",children:[e.jsx("div",{className:"text-lg opacity-90",children:vt}),e.jsx("div",{className:"text-4xl font-semibold leading-tight",children:kt})]}),x&&Te.length>0&&e.jsx("div",{className:"fixed right-4 z-[1] pointer-events-none select-none text-white bg-black/45 backdrop-blur-md rounded-2xl px-5 py-4 shadow-lg min-w-[220px]",style:{top:z&&Xe!=null?`${Math.round(Xe+5)}px`:"1rem"},children:e.jsx("div",{className:"space-y-1 text-sm",children:Te.map(n=>e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-white/70",children:n.label}),e.jsx("span",{className:"text-white",children:n.value})]},n.label))})}),g.activeWidgets.map(n=>{const d=Ie[n.widgetId];if(!d)return null;const f=d.component,v=g.pinnedWidgets.includes(n.widgetId),Y=n.instanceId===se;return e.jsx(oo,{id:n.instanceId,title:l(d.title),icon:d.icon,position:n.position,size:n.size,zIndex:n.zIndex,isMinimized:n.isMinimized,isMaximized:n.isMaximized,onToggleMinimize:()=>Oe(n.instanceId),onToggleMaximize:()=>Re(n.instanceId),onClose:()=>$e(n.instanceId),onFocus:()=>Ae(n.instanceId),onDragStop:(le,ke)=>{o(Ne=>Ne.map(Me=>Me.instanceId===n.instanceId?{...Me,position:{x:ke.x,y:ke.y}}:Me))},onResizeStop:(le,ke,Ne,Me,Be)=>{const Ge=Number.parseFloat(Ne.style.width),Le=Number.parseFloat(Ne.style.height);o(Fe=>Fe.map(Se=>Se.instanceId===n.instanceId?{...Se,size:{width:Number.isFinite(Ge)?Ge:Se.size.width,height:Number.isFinite(Le)?Le:Se.size.height},position:Be}:Se))},onOpenContextMenu:le=>C(le,n.widgetId,n.instanceId),isPinned:v,isActive:Y,onTogglePin:()=>{j(le=>le.includes(n.widgetId)?le.filter(ke=>ke!==n.widgetId):[...le,n.widgetId])},pinLabel:l("toolbar.add_widget"),unpinLabel:l("toolbar.remove_widget"),children:e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:l("loading")}),children:e.jsx(f,{})})},n.instanceId)}),ce&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 h-2 z-[10000]",onMouseEnter:()=>T(!0)}),e.jsx(ro,{pinnedWidgets:g.pinnedWidgets,onWidgetClick:Ve,onWidgetsClick:()=>m("widgets"),onOpenContextMenu:(n,d,f)=>oe(n,d,f),onReorderPinned:n=>j(n),openWidgets:g.activeWidgets,onTaskClick:Ce,onTaskContextMenu:h,isHidden:ce,isPeeking:me,onMouseLeave:()=>{ce&&T(!1)},startButtonRef:V}),e.jsxs("button",{ref:V,onClick:n=>P(n.currentTarget.getBoundingClientRect()),onContextMenu:n=>oe(n,void 0,!0),className:`fixed bottom-4 left-4 z-[10001] flex items-center gap-2 px-5 py-2.5 rounded-full shadow-lg border border-black/10 backdrop-blur-md transition ${U?"bg-accent text-text-dark":"bg-white/90 text-text-dark hover:bg-white"}`,title:l("toolbar.start"),"aria-label":l("toolbar.start"),children:[e.jsx("img",{src:$("escritorio-digital.png"),alt:l("toolbar.start"),width:"24",height:"24"}),e.jsx("span",{className:"text-sm font-semibold",children:l("toolbar.start")})]}),e.jsx(Er,{isOpen:U,onClose:()=>ie(!1),onAddWidget:Ve,onOpenSettingsTab:m,onOpenThemeModal:D,onOpenAbout:()=>y(!0),onOpenCredits:()=>ae(!0),onRemoveFavorite:n=>j(d=>d.filter(f=>f!==n)),onReorderFavorites:n=>j(n),onClearFavorites:()=>j([]),onAddFavorite:n=>j(d=>d.includes(n)?d:[...d,n]),pinnedWidgets:g.pinnedWidgets,anchorRect:ne,anchorRef:V}),e.jsx(zr,{isOpen:k,onClose:()=>y(!1)}),e.jsx(Sr,{isOpen:ue,onClose:()=>Q(!1),initialTab:we,themeModalRequestId:N,pinnedWidgets:g.pinnedWidgets,setPinnedWidgets:j,profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,profileOrder:b,setProfileOrder:p}),e.jsx(Ir,{isOpen:O,onClose:()=>ae(!1)}),_&&e.jsx(Wr,{profiles:t,activeProfileName:i,setActiveProfileName:c,setProfiles:s,onManageProfiles:()=>m("profiles"),onOpenContextMenu:n=>oe(n,void 0,!0),profileOrder:b}),X&&e.jsxs("div",{className:"fixed top-4 right-4 z-[10002] max-w-sm bg-white/95 backdrop-blur-md border border-amber-200 shadow-xl rounded-lg p-4 text-sm text-text-dark",children:[e.jsx("p",{className:"font-semibold text-amber-700",children:l("storage_warning.title")}),e.jsx("p",{className:"mt-1 text-gray-700",children:l("storage_warning.body")}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 rounded-md bg-amber-500 text-white hover:bg-amber-600 transition",onClick:()=>m("general"),children:l("storage_warning.open_settings")}),e.jsx("button",{className:"px-3 py-1.5 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition",onClick:()=>ee(!1),children:l("storage_warning.dismiss")})]})]}),A.isOpen&&e.jsx("div",{ref:M,className:"fixed z-[10000] min-w-[220px] bg-white/95 backdrop-blur-md rounded-lg shadow-xl border border-gray-200 py-2 text-sm text-text-dark",style:{left:A.x,top:A.y},children:A.windowInstanceId&&qe?e.jsxs(e.Fragment,{children:[Mt&&e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{We&&(j(Ke?n=>n.filter(d=>d!==We):n=>n.includes(We)?n:[...n,We]),w(n=>({...n,isOpen:!1,widgetId:null,windowInstanceId:null})))},children:[Ke?e.jsx(bt,{size:16}):e.jsx(pt,{size:16}),l(Ke?"toolbar.remove_widget":"toolbar.add_widget")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Oe(qe.instanceId),w(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx(nt,{size:16}),l("context_menu.minimize_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Re(qe.instanceId),w(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[qe.isMaximized?e.jsx(nt,{size:16}):e.jsx(Lt,{size:16}),qe.isMaximized?l("context_menu.restore_window"):l("context_menu.maximize_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{$e(qe.instanceId),w(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx(Pe,{size:16}),l("context_menu.close_window")]})]}):e.jsxs(e.Fragment,{children:[Mt&&e.jsx(e.Fragment,{children:e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{We&&(j(Ke?n=>n.filter(d=>d!==We):n=>n.includes(We)?n:[...n,We]),w(n=>({...n,isOpen:!1,widgetId:null,windowInstanceId:null})))},children:[Ke?e.jsx(bt,{size:16}):e.jsx(pt,{size:16}),l(Ke?"toolbar.remove_widget":"toolbar.add_widget")]})}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>m("widgets"),children:[e.jsx(sn,{size:16}),l("context_menu.new_widget")]}),vs&&e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>m("profiles"),children:[e.jsx(ct,{size:16}),l("context_menu.manage_profiles")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>m("general"),children:[e.jsx(xt,{size:16}),l("context_menu.settings")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>m("theme"),children:[e.jsx(Zt,{size:16}),l("context_menu.change_background")]}),e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{De(!ce),w(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_toolbar")}),e.jsx("span",{className:`h-4 w-4 rounded border ${ce?"border-gray-400":"bg-accent border-accent"}`})]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{B(),w(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_profile_switcher")}),e.jsx("span",{className:`h-4 w-4 rounded border ${_?"bg-accent border-accent":"border-gray-400"}`})]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{a(),w(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_datetime")}),e.jsx("span",{className:`h-4 w-4 rounded border ${z?"bg-accent border-accent":"border-gray-400"}`})]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{S(),w(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_system_stats")}),e.jsx("span",{className:`h-4 w-4 rounded border ${x?"bg-accent border-accent":"border-gray-400"}`})]}),Nt&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Ye(),w(n=>({...n,isOpen:!1}))},children:[e.jsx(nt,{size:16}),l("context_menu.minimize_windows")]}),A.windowInstanceId&&e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{$e(A.windowInstanceId),w(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx(Pe,{size:16}),l("context_menu.close_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:I,children:[e.jsx(Pe,{size:16}),l("context_menu.reset_layout")]})]})]})})]})};function Yt(){const[t,s]=et("desktop-profiles",{"Escritorio Principal":{theme:Ze,activeWidgets:[],pinnedWidgets:["work-list","timer","file-opener","vce-community"],vceFavorites:[]}}),[i,c]=et("profile-order",[]),[b,p]=et("active-profile-name","Escritorio Principal");r.useEffect(()=>{const o=j=>{const a=j.detail;if(!a||!a.profileName||!a.favorites)return;const S=a.profileName,B=a.favorites;s(W=>{const q=W[S];return q?{...W,[S]:{...q,vceFavorites:B}}:W})};return window.addEventListener("vce-favorites-update",o),()=>window.removeEventListener("vce-favorites-update",o)},[s]);const l=t[b]||Object.values(t)[0],u=l.theme||Ze,g=o=>{const j=l.theme,a=typeof o=="function"?o(j):o,S={...l,theme:a};s(B=>({...B,[b]:S}))},z=o=>{g(j=>({...j,"--wallpaper":o}))},x=()=>{g(Ze)};r.useEffect(()=>{document.body.style.backgroundImage=u["--wallpaper"],document.body.classList.toggle("high-contrast",!!u.highContrast);const o=document.documentElement;for(const[j,a]of Object.entries(u))j.startsWith("--")&&j!=="--wallpaper"&&o.style.setProperty(j,a)},[u]),r.useEffect(()=>{const o=u["--wallpaper"];if(!o)return;const j=o.toLowerCase(),a=j.startsWith("url(data:")||j.startsWith("url(http");j==="none"||a||ir(o)||g(B=>({...B,"--wallpaper":ms}))},[u["--wallpaper"],g]),r.useEffect(()=>{window.dispatchEvent(new CustomEvent("active-profile-change",{detail:{name:b}}))},[b]),r.useEffect(()=>{window.dispatchEvent(new Event("profiles-updated"))},[t]);const _={theme:u,setTheme:g,setWallpaper:z,resetTheme:x,defaultTheme:Ze};return e.jsx(rr,{value:_,children:e.jsx(Mr,{profiles:t,setProfiles:s,activeProfileName:b,setActiveProfileName:p,profileOrder:i,setProfileOrder:c})})}const Or="/escritorio/";it.use(Cs).use(gn).use(Ss).init({fallbackLng:"es",supportedLngs:["es","ca","eu","gl","pt","fr","it","de","en"],debug:!1,initImmediate:!1,ns:"translation",defaultNS:"translation",backend:{loadPath:`${Or}locales/{{lng}}/{{ns}}.json`,requestOptions:{cache:"no-cache"}},interpolation:{escapeValue:!1},detection:{order:["querystring","cookie","localStorage","navigator","htmlTag"],caches:["localStorage","cookie"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t.startsWith("ca")?"ca":t.startsWith("gl")?"gl":t.startsWith("eu")?"eu":t.startsWith("es")?"es":t.startsWith("pt")?"pt":t.startsWith("it")?"it":t.startsWith("de")?"de":t.startsWith("en")?"en":t.startsWith("fr")?"fr":t},react:{useSuspense:!1}});const Dr=new Promise(t=>{const s=()=>{it.loadNamespaces(["translation"]).then(()=>t())};it.isInitialized?s():it.on("initialized",s)}),Tr=()=>{const{t}=L();return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:t("loading")})},Xt=ks.createRoot(document.getElementById("root"));Dr.then(()=>{Xt.render(e.jsx(ft.StrictMode,{children:e.jsx(r.Suspense,{fallback:e.jsx(Tr,{}),children:e.jsx(Yt,{})})}))}).catch(t=>{console.error("i18n init error:",t),Xt.render(e.jsx(ft.StrictMode,{children:e.jsx(Yt,{})}))});export{fi as A,$ as B,pi as C,wi as D,ji as E,Ci as F,Si as G,Ei as H,Oi as I,Ti as J,Pi as K,Ai as L,Bi as M,Ki as N,Ui as O,Xi as P,Ji as Q,to as R,no as S,hn as a,bn as b,xn as c,_n as d,jn as e,kn as f,Nn as g,In as h,En as i,On as j,Tn as k,Fn as l,An as m,Bn as n,Hn as o,qn as p,Un as q,Qn as r,ei as s,ni as t,et as u,oi as v,un as w,ai as x,di as y,ui as z};
