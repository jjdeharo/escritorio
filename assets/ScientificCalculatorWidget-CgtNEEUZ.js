import{r as a,j as i}from"./vendor-react-CvxLrFbY.js";import{G as ye}from"./index-BRUjA2Tl.js";import{u as T}from"./vendor-react-i18next-CV9wn5jO.js";import"./vendor-clsx-DMbM62ou.js";import"./vendor-react-dom-ovwEKgq_.js";import"./vendor-scheduler-SPyfQU6S.js";import"./vendor-i18next-http-backend-BlWUewvL.js";import"./vendor-lucide-react-CYRm5Z9O.js";import"./vendor-react-rnd-CJIym3is.js";import"./vendor-react-draggable-CHzIUO8G.js";import"./vendor-prop-types-Chjiymov.js";import"./vendor-re-resizable-Bd8fNV1d.js";import"./vendor-dnd-kit-core-C4pUYSBz.js";import"./vendor-dnd-kit-utilities-CZrAEsTl.js";import"./vendor-dnd-kit-accessibility-DKV5GxcV.js";import"./vendor-dnd-kit-sortable-BobZZm17.js";import"./vendor-fflate-PjZAcS34.js";import"./vendor-framer-motion-FfyGqyL8.js";import"./vendor-motion-dom-DtvSSoo0.js";import"./vendor-motion-utils-CjIqCkNq.js";import"./vendor-i18next-Bvlggjj8.js";import"./vendor-i18next-browser-languagedetector-OJKzRF51.js";import"./vendor-html-parse-stringify-C3VvPRF8.js";import"./vendor-void-elements-SshaXqDN.js";const H=["7","8","9","÷","4","5","6","×","1","2","3","−","0",".","+","Ans","="],X=["(",")","√","÷","7","8","9","×","4","5","6","−","1","2","3","+","0",".","empty_slot","^","Ans","="],q=["rad/deg","x!","(",")","÷","sin","cos","tan","π","×","log","ln","EE","Ans","−","7","8","9","√","+","4","5","6","^","1","2","3","%","0",".","="],y=["=","+","−","×","÷","^","%"],G=["0","1","2","3","4","5","6","7","8","9","."],he=()=>{const{t:f,ready:A}=T(),[d,o]=a.useState("0"),[u,l]=a.useState(""),[N,M]=a.useState(!0),[n,S]=a.useState("Scientific"),[w,k]=a.useState([]),[g,R]=a.useState(!1),[z,I]=a.useState("0"),$=a.useRef(null),x=a.useRef(null),_=64,L=16,j=1,E=()=>{const e=$.current;if(!e)return;let s=_;for(e.style.fontSize=`${s}px`;e.scrollWidth>e.clientWidth&&s>L;)s-=j,e.style.fontSize=`${s}px`;for(;e.scrollWidth<=e.clientWidth&&s+j<=_;){const t=s+j;if(e.style.fontSize=`${t}px`,e.scrollWidth>e.clientWidth){e.style.fontSize=`${s}px`;break}s=t}};a.useLayoutEffect(()=>{E()},[d,n,g]),a.useEffect(()=>{const e=$.current;if(!e)return;x.current?.disconnect(),x.current=new ResizeObserver(()=>E()),x.current.observe(e);const s=()=>E();return window.addEventListener("resize",s),()=>{x.current?.disconnect(),window.removeEventListener("resize",s)}},[]);const m=e=>{try{let s=e.replace(/×/g,"*").replace(/÷/g,"/").replace(/−/g,"-").replace(/\^/g,"**").replace(/%/g,"*0.01").replace(/π/g,"Math.PI").replace(/Ans/g,z);s=s.replace(/(sin|cos|tan)\(([^)]+)\)/g,(p,r,c)=>{const h=m(c);return N?`Math.${r}(${h})`:`Math.${r}(${h} * Math.PI / 180)`}),s=s.replace(/√\(([^)]+)\)/g,(p,r)=>`Math.sqrt(${m(r)})`),s=s.replace(/log\(([^)]+)\)/g,(p,r)=>`Math.log10(${m(r)})`),s=s.replace(/ln\(([^)]+)\)/g,(p,r)=>`Math.log(${m(r)})`),s=s.replace(/(\d+(?:\.\d+)?)!/g,(p,r)=>{if(r.includes("."))return"Error";let c=parseInt(r);if(c>20)return"Infinity";if(c<0)return"Error";if(c===0)return"1";let h=1;for(let v=2;v<=c;v++)h*=v;return h.toString()});const t=new Function("return "+s)();return t===0?"0":Math.abs(t)>1e12||Math.abs(t)<1e-9&&t!==0?t.toExponential(9):String(parseFloat(t.toFixed(10)))}catch{return"Error"}},W=()=>{d.length>1?(o(d.slice(0,-1)),l(u.slice(0,-1))):(o("0"),l(""))},B=()=>{o("0"),l("")},F=e=>{if(e==="rad/deg"){M(!N);return}if(e==="="){const s=u||d,t=m(s);o(t),l(s+"="),I(t);const p=`${s} = ${t}`;k(r=>[p,...r].slice(0,20))}else["Ans","EE","π"].includes(e)?C(e):["sin","cos","tan","log","ln","√"].includes(e)?O(e):e==="x!"?(l(s=>s+"!"),o(s=>s+"!")):C(e)},C=e=>{if(d==="Error"||u.includes("=")&&!y.includes(e)){o(e),l(e);return}const s=y.includes(u.slice(-1));y.includes(e)&&s||(d==="0"&&e!=="."||s||u.endsWith("(")?o(e):o(t=>t+e),u.includes("=")?l(e):l(t=>t+e))},O=e=>{const s=e+"(";d==="Error"||u.includes("=")||d==="0"?(o(s),l(s)):(o(t=>t+s),l(t=>t+s))},P=n==="Basic"?H:n==="Standard"?X:q,D=n==="Scientific"?"grid-cols-5":"grid-cols-4";return A?i.jsxs("div",{className:"scientific-calculator",children:[i.jsxs("div",{className:"top-bar",children:[i.jsxs("div",{className:"mode-selector",children:[i.jsx("button",{className:`mode-button ${n==="Basic"?"mode-active":""}`,onClick:()=>S("Basic"),children:f("widgets.scientific_calculator.basic")}),i.jsx("button",{className:`mode-button ${n==="Standard"?"mode-active":""}`,onClick:()=>S("Standard"),children:f("widgets.scientific_calculator.standard")}),i.jsx("button",{className:`mode-button ${n==="Scientific"?"mode-active":""}`,onClick:()=>S("Scientific"),children:f("widgets.scientific_calculator.scientific")})]}),n==="Scientific"&&i.jsx("span",{className:"angle-mode-indicator",children:N?"RAD":"DEG"}),i.jsx("button",{className:`mode-button history-toggle ${g?"mode-active":""}`,onClick:()=>R(!g),children:f("widgets.scientific_calculator.history")})]}),g&&i.jsx("div",{className:"history-panel",children:w.length===0?i.jsx("p",{className:"history-empty",children:f("widgets.scientific_calculator.no_history")}):w.map((e,s)=>i.jsx("p",{className:"history-entry",children:e},s))}),i.jsxs("div",{className:"display-area",children:[i.jsx("div",{className:"expression",children:u.replace(/\*/g,"×").replace(/-/g,"−")}),i.jsx("div",{ref:$,className:"main-display",children:d})]}),i.jsxs("div",{className:"top-controls",children:[i.jsx("button",{onClick:W,className:"calc-button control",children:"←"}),i.jsx("button",{onClick:B,className:"calc-button ac",children:"AC"})]}),i.jsx("div",{className:`buttons-grid ${D}`,children:P.map((e,s)=>{if(e==="empty_slot")return i.jsx("div",{className:"calc-button number"},`${n}-empty-${s}`);const t=y.includes(e),p=G.includes(e);let r="function";e==="="?r="equals":t?r="operator":p&&(r="number");let c="";return n==="Basic"?(e==="."&&(c="col-span-2"),e==="Ans"&&(c="col-span-3")):n==="Standard"?e==="Ans"&&(c="col-span-3"):n==="Scientific"&&((e==="6"||e==="3")&&(c="col-span-2"),e==="."&&(c="col-span-2"),e==="="&&(c="col-span-2")),i.jsx("button",{onClick:()=>F(e),className:`calc-button ${r} ${c}`,children:e},`${n}-${e}-${s}`)})})]}):i.jsx("div",{className:"flex items-center justify-center h-full",children:f("loading")})};export{he as ScientificCalculatorWidget,ye as widgetConfig};
