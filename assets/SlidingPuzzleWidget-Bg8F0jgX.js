import{u as b,r as u,j as t,W as _,aH as N}from"./react-vendor-C9LHBUkp.js";import{I as R}from"./index-1oeigWlx.js";import"./vendor-BnVc6iZf.js";import"./editor-vendor-Dlj3R3R2.js";import"./i18n-vendor-BnzbNFM1.js";const P=(a,i)=>{let f=0;const e=a.filter(r=>r!==i*i-1);for(let r=0;r<e.length-1;r++)for(let c=r+1;c<e.length;c++)e[r]>e[c]&&f++;if(i%2===1)return f%2===0;{const r=i-Math.floor(a.indexOf(i*i-1)/i);return(f+r)%2!==0}},k=()=>{const{t:a}=b(),[i,f]=u.useState(null),[e,r]=u.useState(3),[c,p]=u.useState([]),[g,h]=u.useState(!1),m=()=>{const s=e*e,l=Array.from({length:s},(o,d)=>d);let n;do n=[...l].sort(()=>Math.random()-.5);while(!P(n,e)||n.every((o,d)=>o===d));p(n),h(!1)};u.useEffect(()=>{i&&m()},[i,e]),u.useEffect(()=>{if(c.length===0)return;const s=c.every((l,n)=>l===n);h(s)},[c]);const y=s=>{if(s.target.files&&s.target.files[0]){const l=new FileReader;l.onload=n=>{f(n.target?.result)},l.readAsDataURL(s.target.files[0])}},w=s=>{if(g)return;const l=c.indexOf(e*e-1);if(((o,d)=>{const z=Math.floor(o/e),v=o%e,x=Math.floor(d/e),j=d%e;return z===x&&Math.abs(v-j)===1||v===j&&Math.abs(z-x)===1})(s,l)){const o=[...c];[o[s],o[l]]=[o[l],o[s]],p(o)}};return i?t.jsxs("div",{className:"sliding-puzzle-widget",children:[t.jsxs("div",{className:"puzzle-board",style:{gridTemplateColumns:`repeat(${e}, 1fr)`},children:[c.map((s,l)=>{const n=s===e*e-1,o=s%e,d=Math.floor(s/e);return t.jsx("div",{className:`puzzle-piece ${n?"empty":""}`,onClick:()=>w(l),children:!n&&t.jsx("div",{className:"piece-image",style:{backgroundImage:`url(${i})`,backgroundSize:`${e*100}% ${e*100}%`,backgroundPosition:`${o*100/(e-1)}% ${d*100/(e-1)}%`}})},l)}),g&&t.jsx("div",{className:"solved-overlay",children:a("widgets.sliding_puzzle.solved_overlay")})]}),t.jsxs("div",{className:"puzzle-controls",children:[t.jsxs("label",{children:[a("widgets.sliding_puzzle.complexity_label"),t.jsxs("select",{value:e,onChange:s=>r(Number(s.target.value)),children:[t.jsx("option",{value:3,children:a("widgets.sliding_puzzle.difficulty.easy")}),t.jsx("option",{value:4,children:a("widgets.sliding_puzzle.difficulty.normal")}),t.jsx("option",{value:5,children:a("widgets.sliding_puzzle.difficulty.hard")})]})]}),t.jsxs("button",{onClick:m,children:[t.jsx(N,{size:16})," ",a("widgets.sliding_puzzle.shuffle_button")]})]})]}):t.jsxs("div",{className:"puzzle-placeholder",children:[t.jsx(_,{size:48}),t.jsx("p",{children:a("widgets.sliding_puzzle.upload_prompt")}),t.jsx("input",{type:"file",accept:"image/*",onChange:y})]})};export{k as SlidingPuzzleWidget,R as widgetConfig};
