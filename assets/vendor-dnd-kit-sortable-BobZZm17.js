import{r as v,R as U}from"./vendor-react-CvxLrFbY.js";import{K as R,u as fe,c as ge,g as pe,a as be,b as ve,d as he,e as xe}from"./vendor-dnd-kit-core-C4pUYSBz.js";import{a as me,d as j,s as Ie,v as Re,C as q,i as we}from"./vendor-dnd-kit-utilities-CZrAEsTl.js";function B(e,t,o){const r=e.slice();return r.splice(o<0?r.length+o:o,0,r.splice(t,1)[0]),r}function ye(e,t){return e.reduce((o,r,n)=>{const i=t.get(r);return i&&(o[n]=i),o},Array(e.length))}function O(e){return e!==null&&e>=0}function Ce(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}function Se(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const L={scaleX:1,scaleY:1},Pe=e=>{var t;let{rects:o,activeNodeRect:r,activeIndex:n,overIndex:i,index:s}=e;const a=(t=o[n])!=null?t:r;if(!a)return null;const u=De(o,s,n);if(s===n){const c=o[i];return c?{x:n<i?c.left+c.width-(a.left+a.width):c.left-a.left,y:0,...L}:null}return s>n&&s<=i?{x:-a.width-u,y:0,...L}:s<n&&s>=i?{x:a.width+u,y:0,...L}:{x:0,y:0,...L}};function De(e,t,o){const r=e[t],n=e[t-1],i=e[t+1];return!r||!n&&!i?0:o<t?n?r.left-(n.left+n.width):i.left-(r.left+r.width):i?i.left-(r.left+r.width):r.left-(n.left+n.width)}const H=e=>{let{rects:t,activeIndex:o,overIndex:r,index:n}=e;const i=B(t,r,o),s=t[n],a=i[n];return!a||!s?null:{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}},k={scaleX:1,scaleY:1},Ye=e=>{var t;let{activeIndex:o,activeNodeRect:r,index:n,rects:i,overIndex:s}=e;const a=(t=i[o])!=null?t:r;if(!a)return null;if(n===o){const c=i[s];return c?{x:0,y:o<s?c.top+c.height-(a.top+a.height):c.top-a.top,...k}:null}const u=Ae(i,n,o);return n>o&&n<=s?{x:0,y:-a.height-u,...k}:n<o&&n>=s?{x:0,y:a.height+u,...k}:{x:0,y:0,...k}};function Ae(e,t,o){const r=e[t],n=e[t-1],i=e[t+1];return r?o<t?n?r.top-(n.top+n.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):n?r.top-(n.top+n.height):0:0}const V="Sortable",J=U.createContext({activeIndex:-1,containerId:V,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:H,disabled:{draggable:!1,droppable:!1}});function Fe(e){let{children:t,id:o,items:r,strategy:n=H,disabled:i=!1}=e;const{active:s,dragOverlay:a,droppableRects:u,over:c,measureDroppableContainers:l}=fe(),d=me(V,o),f=a.rect!==null,g=v.useMemo(()=>r.map(I=>typeof I=="object"&&"id"in I?I.id:I),[r]),w=s!=null,y=s?g.indexOf(s.id):-1,h=c?g.indexOf(c.id):-1,C=v.useRef(g),m=!Ce(g,C.current),x=h!==-1&&y===-1||m,b=Se(i);j(()=>{m&&w&&l(g)},[m,g,w,l]),v.useEffect(()=>{C.current=g},[g]);const S=v.useMemo(()=>({activeIndex:y,containerId:d,disabled:b,disableTransforms:x,items:g,overIndex:h,useDragOverlay:f,sortedRects:ye(g,u),strategy:n}),[y,d,b.draggable,b.droppable,x,g,h,u,f,n]);return U.createElement(J.Provider,{value:S},t)}const Te=e=>{let{id:t,items:o,activeIndex:r,overIndex:n}=e;return B(o,r,n).indexOf(t)},Ne=e=>{let{containerId:t,isSorting:o,wasDragging:r,index:n,items:i,newIndex:s,previousItems:a,previousContainerId:u,transition:c}=e;return!c||!r||a!==i&&n===s?!1:o?!0:s!==n&&t===u},Ee={duration:200,easing:"ease"},Q="transform",Oe=q.Transition.toString({property:Q,duration:0,easing:"linear"}),Le={roleDescription:"sortable"};function ke(e){let{disabled:t,index:o,node:r,rect:n}=e;const[i,s]=v.useState(null),a=v.useRef(o);return j(()=>{if(!t&&o!==a.current&&r.current){const u=n.current;if(u){const c=xe(r.current,{ignoreTransform:!0}),l={x:u.left-c.left,y:u.top-c.top,scaleX:u.width/c.width,scaleY:u.height/c.height};(l.x||l.y)&&s(l)}}o!==a.current&&(a.current=o)},[t,o,r,n]),v.useEffect(()=>{i&&s(null)},[i]),i}function Ue(e){let{animateLayoutChanges:t=Ne,attributes:o,disabled:r,data:n,getNewIndex:i=Te,id:s,strategy:a,resizeObserverConfig:u,transition:c=Ee}=e;const{items:l,containerId:d,activeIndex:f,disabled:g,disableTransforms:w,sortedRects:y,overIndex:h,useDragOverlay:C,strategy:m}=v.useContext(J),x=Me(r,g),b=l.indexOf(s),S=v.useMemo(()=>({sortable:{containerId:d,index:b,items:l},...n}),[d,n,b,l]),I=v.useMemo(()=>l.slice(l.indexOf(s)),[l,s]),{rect:E,node:G,isOver:Z,setNodeRef:X}=ve({id:s,data:S,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...u}}),{active:T,activatorEvent:ee,activeNodeRect:te,attributes:re,setNodeRef:_,listeners:ne,isDragging:$,over:oe,setActivatorNodeRef:se,transform:ie}=he({id:s,data:S,attributes:{...Le,...o},disabled:x.draggable}),ae=Re(X,_),D=!!T,K=D&&!w&&O(f)&&O(h),P=!C&&$,Y=P&&K?ie:null,ce=K?Y??(a??m)({rects:y,activeNodeRect:te,activeIndex:f,overIndex:h,index:b}):null,N=O(f)&&O(h)?i({id:s,items:l,activeIndex:f,overIndex:h}):b,A=T?.id,p=v.useRef({activeId:A,items:l,newIndex:N,containerId:d}),le=l!==p.current.items,F=t({active:T,containerId:d,isDragging:$,isSorting:D,id:s,index:b,items:l,newIndex:p.current.newIndex,previousItems:p.current.items,previousContainerId:p.current.containerId,transition:c,wasDragging:p.current.activeId!=null}),z=ke({disabled:!F,index:b,node:G,rect:E});return v.useEffect(()=>{D&&p.current.newIndex!==N&&(p.current.newIndex=N),d!==p.current.containerId&&(p.current.containerId=d),l!==p.current.items&&(p.current.items=l)},[D,N,d,l]),v.useEffect(()=>{if(A===p.current.activeId)return;if(A!=null&&p.current.activeId==null){p.current.activeId=A;return}const de=setTimeout(()=>{p.current.activeId=A},50);return()=>clearTimeout(de)},[A]),{active:T,activeIndex:f,attributes:re,data:S,rect:E,index:b,newIndex:N,items:l,isOver:Z,isSorting:D,isDragging:$,listeners:ne,node:G,overIndex:h,over:oe,setNodeRef:ae,setActivatorNodeRef:se,setDroppableNodeRef:X,setDraggableNodeRef:_,transform:z??ce,transition:ue()};function ue(){if(z||le&&p.current.newIndex===b)return Oe;if(!(P&&!we(ee)||!c)&&(D||F))return q.Transition.toString({...c,property:Q})}}function Me(e,t){var o,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(o=e?.draggable)!=null?o:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}function M(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const $e=[R.Down,R.Right,R.Up,R.Left],je=(e,t)=>{let{context:{active:o,collisionRect:r,droppableRects:n,droppableContainers:i,over:s,scrollableAncestors:a}}=t;if($e.includes(e.code)){if(e.preventDefault(),!o||!r)return;const u=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const f=n.get(d.id);if(f)switch(e.code){case R.Down:r.top<f.top&&u.push(d);break;case R.Up:r.top>f.top&&u.push(d);break;case R.Left:r.left>f.left&&u.push(d);break;case R.Right:r.left<f.left&&u.push(d);break}});const c=ge({collisionRect:r,droppableRects:n,droppableContainers:u});let l=pe(c,"id");if(l===s?.id&&c.length>1&&(l=c[1].id),l!=null){const d=i.get(o.id),f=i.get(l),g=f?n.get(f.id):null,w=f?.node.current;if(w&&g&&d&&f){const h=be(w).some((I,E)=>a[E]!==I),C=W(d,f),m=ze(d,f),x=h||!C?{x:0,y:0}:{x:m?r.width-g.width:0,y:m?r.height-g.height:0},b={x:g.left,y:g.top};return x.x&&x.y?b:Ie(b,x)}}}};function W(e,t){return!M(e)||!M(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function ze(e,t){return!M(e)||!M(t)||!W(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}export{Fe as S,B as a,Pe as h,je as s,Ue as u,Ye as v};
